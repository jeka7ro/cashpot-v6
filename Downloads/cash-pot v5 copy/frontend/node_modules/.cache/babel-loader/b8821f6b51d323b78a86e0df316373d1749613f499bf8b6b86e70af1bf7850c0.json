{"ast":null,"code":"import _objectSpread from\"/Users/eugeniucazmal/Downloads/cash-pot v5 copy/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useEffect,useMemo,useState,useCallback}from'react';import*as XLSX from'xlsx';import'./app.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const BACKEND_URL=process.env.REACT_APP_BACKEND_URL||'https://cashpot-v5.onrender.com';const API=\"\".concat(BACKEND_URL,\"/api\");// Module-level cache to survive component remounts\nlet __historyDataCache__=null;let __historyFiltersCache__=null;// Helper function to format dates as dd.mm.yyyy\nconst formatDateDDMMYYYY=date=>{if(!date)return'';const d=new Date(date);const day=String(d.getDate()).padStart(2,'0');const month=String(d.getMonth()+1).padStart(2,'0');const year=d.getFullYear();return\"\".concat(day,\".\").concat(month,\".\").concat(year);};// Calendar Component\nconst Calendar=_ref=>{let{value,onChange,placeholder=\"Select date\",allowManualInput=false}=_ref;const[showCalendar,setShowCalendar]=useState(false);const[currentDate,setCurrentDate]=useState(new Date());// Fix: Use local date formatting to avoid timezone issues\nconst formatDate=date=>{if(!date)return'';const year=date.getFullYear();const month=String(date.getMonth()+1).padStart(2,'0');const day=String(date.getDate()).padStart(2,'0');return\"\".concat(year,\"-\").concat(month,\"-\").concat(day);};const formatDisplayDate=date=>{if(!date)return placeholder;if(typeof date==='string'){// If already dd.mm.yyyy, return as is\nif(/^\\d{2}\\.\\d{2}\\.\\d{4}$/.test(date))return date;// If yyyy-mm-dd, convert to dd.mm.yyyy\nif(/^\\d{4}-\\d{2}-\\d{2}$/.test(date)){const[y,m,d]=date.split('-');return\"\".concat(d,\".\").concat(m,\".\").concat(y);}}const d=new Date(date);if(Number.isNaN(d.getTime()))return placeholder;const day=String(d.getDate()).padStart(2,'0');const month=String(d.getMonth()+1).padStart(2,'0');const year=d.getFullYear();return\"\".concat(day,\".\").concat(month,\".\").concat(year);};const parseManual=text=>{const m=text.match(/^(\\d{1,2})\\.(\\d{1,2})\\.(\\d{4})$/);if(!m)return null;const day=parseInt(m[1],10);const monthIndex=parseInt(m[2],10)-1;const year=parseInt(m[3],10);const dt=new Date(year,monthIndex,day);return Number.isNaN(dt.getTime())?null:dt;};const getDaysInMonth=date=>{const year=date.getFullYear();const month=date.getMonth();const firstDay=new Date(year,month,1);const lastDay=new Date(year,month+1,0);const startDate=new Date(firstDay);startDate.setDate(startDate.getDate()-firstDay.getDay());const days=[];const current=new Date(startDate);for(let i=0;i<42;i++){days.push(new Date(current));current.setDate(current.getDate()+1);}return days;};const handleDateClick=date=>{const formattedDate=formatDate(date);onChange(formattedDate);setShowCalendar(false);};// English month names\nconst monthNames=['January','February','March','April','May','June','July','August','September','October','November','December'];// English day names\nconst dayNames=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];const days=getDaysInMonth(currentDate);const selectedDateObj=value?new Date(value):null;return/*#__PURE__*/_jsxs(\"div\",{className:\"calendar-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"calendar-input\",onClick:e=>{// Toggle only when clicking the icon area; let input focus without toggling\nconst target=e.target;if(target&&target.classList&&target.classList.contains('calendar-icon')){setShowCalendar(s=>!s);}},children:[allowManualInput?/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:placeholder,value:value?formatDisplayDate(value):'',onChange:e=>{const dt=parseManual(e.target.value);if(dt){onChange(formatDate(dt));setCurrentDate(dt);}else if(e.target.value.trim()===''){onChange('');}},onClick:e=>e.stopPropagation(),onFocus:e=>e.stopPropagation(),style:{background:'transparent',border:'none',color:'var(--text-primary)'},inputMode:\"numeric\",pattern:\"\\\\\\\\d{2}\\\\\\\\.\\\\\\\\d{2}\\\\\\\\.\\\\\\\\d{4}\"}):/*#__PURE__*/_jsx(\"span\",{className:\"calendar-value\",children:formatDisplayDate(value)}),/*#__PURE__*/_jsx(\"span\",{className:\"calendar-icon\",onClick:()=>setShowCalendar(s=>!s),children:\"\\uD83D\\uDCC5\"})]}),showCalendar&&/*#__PURE__*/_jsxs(\"div\",{className:\"calendar-popup\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"calendar-header\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setCurrentDate(new Date(currentDate.getFullYear(),currentDate.getMonth()-1)),className:\"calendar-nav\",children:\"\\u2039\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"calendar-month\",children:[monthNames[currentDate.getMonth()],\" \",currentDate.getFullYear()]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setCurrentDate(new Date(currentDate.getFullYear(),currentDate.getMonth()+1)),className:\"calendar-nav\",children:\"\\u203A\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"calendar-grid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"calendar-weekdays\",children:dayNames.map(day=>/*#__PURE__*/_jsx(\"div\",{className:\"calendar-weekday\",children:day},day))}),/*#__PURE__*/_jsx(\"div\",{className:\"calendar-days\",children:days.map((day,index)=>{const isCurrentMonth=day.getMonth()===currentDate.getMonth();const isSelected=selectedDateObj&&day.getDate()===selectedDateObj.getDate()&&day.getMonth()===selectedDateObj.getMonth()&&day.getFullYear()===selectedDateObj.getFullYear();const isToday=day.toDateString()===new Date().toDateString();return/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"calendar-day \".concat(!isCurrentMonth?'other-month':'',\" \").concat(isSelected?'selected':'',\" \").concat(isToday?'today':''),onClick:()=>handleDateClick(day),children:day.getDate()},index);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"calendar-footer\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleDateClick(new Date()),className:\"calendar-today-btn\",children:\"Today\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{onChange('');setShowCalendar(false);},className:\"calendar-clear-btn\",style:{backgroundColor:'var(--danger-color)',color:'white',border:'none',padding:'8px 12px',borderRadius:'4px',cursor:'pointer',fontSize:'12px'},children:\"Clear\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowCalendar(false),className:\"calendar-close-btn\",children:\"Close\"})]})]})]});};// Auth Context\nconst AuthContext=/*#__PURE__*/createContext();// Avatar Upload Component\nconst AvatarUpload=_ref2=>{let{entityType,entityId,currentAvatar,onAvatarChange,showCustomNotification}=_ref2;const[uploading,setUploading]=useState(false);const[dragOver,setDragOver]=useState(false);const{user}=useAuth();const handleFileUpload=async file=>{if(!file||!file.type.startsWith('image/')){showCustomNotification('Please select a valid image file','error');return;}if(file.size>5*1024*1024){// 5MB limit\nshowCustomNotification('File size must be less than 5MB','error');return;}setUploading(true);try{console.log('Starting avatar upload for:',{entityType,entityId,file:file.name});// Convert file to base64\nconst base64=await new Promise(resolve=>{const reader=new FileReader();reader.onload=()=>{let base64Data=reader.result.split(',')[1];// Add padding if needed\nwhile(base64Data.length%4){base64Data+='=';}resolve(base64Data);};reader.readAsDataURL(file);});const uploadData={filename:\"avatar_\".concat(Date.now(),\".\").concat(file.name.split('.').pop()),original_filename:file.name,file_size:file.size,mime_type:file.type,file_data:base64,entity_type:entityType,entity_id:entityId};console.log('Uploading to:',\"\".concat(API,\"/attachments\"));console.log('Upload data:',_objectSpread(_objectSpread({},uploadData),{},{file_data:'base64_data'}));// Upload to backend\nconst response=await fetch(\"\".concat(API,\"/attachments\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify(uploadData)});console.log('Response status:',response.status);console.log('Response headers:',response.headers);if(response.ok){const attachment=await response.json();console.log('Upload successful:',attachment);onAvatarChange(attachment);showCustomNotification('Avatar uploaded successfully','success');}else{const errorText=await response.text();console.error('Upload failed with status:',response.status);console.error('Error response:',errorText);throw new Error(\"Upload failed: \".concat(response.status,\" - \").concat(errorText));}}catch(error){console.error('Upload error:',error);showCustomNotification(\"Failed to upload avatar: \".concat(error.message),'error');}finally{setUploading(false);}};const handleDrop=e=>{e.preventDefault();setDragOver(false);const file=e.dataTransfer.files[0];if(file)handleFileUpload(file);};const handleFileSelect=e=>{const file=e.target.files[0];if(file)handleFileUpload(file);};useEffect(()=>{if(entityType==='game_mixes'){console.log('AVATAR UPLOAD GAME MIX:',{entityType,entityId,currentAvatar});}},[entityType,entityId,currentAvatar]);return/*#__PURE__*/_jsxs(\"div\",{className:\"avatar-upload-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"avatar-upload \".concat(dragOver?'drag-over':''),onDrop:handleDrop,onDragOver:e=>{e.preventDefault();setDragOver(true);},onDragLeave:()=>setDragOver(false),onClick:()=>{var _document$getElementB;return(_document$getElementB=document.getElementById(\"avatar-input-\".concat(entityId)))===null||_document$getElementB===void 0?void 0:_document$getElementB.click();},children:[currentAvatar?/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(currentAvatar.mime_type,\";base64,\").concat(currentAvatar.file_data),alt:\"Avatar\",className:\"avatar-preview\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"avatar-placeholder\",children:[/*#__PURE__*/_jsx(\"svg\",{width:\"40\",height:\"40\",viewBox:\"0 0 24 24\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Click or drag to upload avatar\"})]}),uploading&&/*#__PURE__*/_jsx(\"div\",{className:\"upload-overlay\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"avatar-input-\".concat(entityId),accept:\"image/*\",style:{display:'none'},onChange:handleFileSelect})]});};// Breadcrumb Navigation Component\nconst Breadcrumb=_ref3=>{let{breadcrumbPath,onNavigate,theme}=_ref3;if(!breadcrumbPath||breadcrumbPath.length===0){return null;}return/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'8px',padding:'12px 16px',marginBottom:'16px',border:'1px solid var(--border-color)',display:'flex',alignItems:'center',gap:'8px',flexWrap:'wrap',minHeight:'60px',// Aceeași înălțime cu sidebar-ul\nwidth:'100%',// Se adaptează la lățimea containerului\nboxSizing:'border-box'// Include padding-ul în lățime\n},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>onNavigate(-1),style:{background:'var(--accent-color)',color:'white',border:'none',borderRadius:'6px',padding:'6px 10px',cursor:'pointer',fontSize:'14px',fontWeight:'500',display:'flex',alignItems:'center',gap:'6px',transition:'all 0.2s ease'},onMouseEnter:e=>{e.target.style.background='var(--accent-hover)';e.target.style.transform='translateY(-1px)';},onMouseLeave:e=>{e.target.style.background='var(--accent-color)';e.target.style.transform='translateY(0)';},children:\"\\uD83C\\uDFE0 Home\"}),breadcrumbPath.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--text-secondary)',fontSize:'14px'},children:\"\\u203A\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onNavigate(index+1),style:{background:index===breadcrumbPath.length-1?'var(--bg-primary)':'transparent',color:index===breadcrumbPath.length-1?'var(--text-primary)':'var(--accent-color)',border:index===breadcrumbPath.length-1?'1px solid var(--border-color)':'none',borderRadius:'6px',padding:'6px 12px',cursor:'pointer',fontSize:'14px',fontWeight:index===breadcrumbPath.length-1?'600':'500',display:'flex',alignItems:'center',gap:'6px',transition:'all 0.2s ease'},onMouseEnter:e=>{if(index!==breadcrumbPath.length-1){e.target.style.background='var(--bg-primary)';e.target.style.transform='translateY(-1px)';}},onMouseLeave:e=>{if(index!==breadcrumbPath.length-1){e.target.style.background='transparent';e.target.style.transform='translateY(0)';}},children:[item.icon&&/*#__PURE__*/_jsx(\"span\",{children:item.icon}),item.label]})]},index))]});};// File Upload Component for PDF and other documents\nconst FileUpload=_ref4=>{let{entityType,entityId,onFileUpload,acceptedTypes=['application/pdf','application/vnd.ms-excel','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','image/png','image/jpeg'],maxSizeMB=50,showCustomNotification}=_ref4;const[uploading,setUploading]=useState(false);const[dragOver,setDragOver]=useState(false);const{user}=useAuth();const handleFileUpload=async file=>{// Validate file type\nif(!acceptedTypes.includes(file.type)){showCustomNotification(\"Please select a valid file type. Accepted types: \".concat(acceptedTypes.join(', ')),'error');return;}// Validate file size\nif(file.size>maxSizeMB*1024*1024){showCustomNotification(\"File size must be less than \".concat(maxSizeMB,\"MB\"),'error');return;}setUploading(true);try{// Convert file to base64\nconst base64=await new Promise((resolve,reject)=>{const reader=new FileReader();reader.onload=()=>{const result=reader.result;// Extract base64 data from data URL\nconst base64Data=result.split(',')[1];if(!base64Data){reject(new Error('Failed to convert file to base64'));return;}resolve(base64Data);};reader.onerror=()=>reject(new Error('Failed to read file'));reader.readAsDataURL(file);});// Upload to backend\nconst response=await fetch(\"\".concat(API,\"/attachments\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify({filename:\"document_\".concat(Date.now(),\".\").concat(file.name.split('.').pop()),original_filename:file.name,file_size:file.size,mime_type:file.type,file_data:base64,entity_type:entityType,entity_id:entityId})});if(response.ok){const attachment=await response.json();onFileUpload(attachment);showCustomNotification('File uploaded successfully!','success');}else{throw new Error('Upload failed');}}catch(error){console.error('Upload error:',error);showCustomNotification('Failed to upload file','error');}finally{setUploading(false);}};const handleDrop=e=>{e.preventDefault();setDragOver(false);const file=e.dataTransfer.files[0];if(file)handleFileUpload(file);};const handleFileSelect=e=>{const file=e.target.files[0];if(file)handleFileUpload(file);};return/*#__PURE__*/_jsxs(\"div\",{style:{display:'inline-block',position:'relative'},children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _document$getElementB2;return(_document$getElementB2=document.getElementById(\"file-input-\".concat(entityId)))===null||_document$getElementB2===void 0?void 0:_document$getElementB2.click();},onDrop:handleDrop,onDragOver:e=>{e.preventDefault();setDragOver(true);},onDragLeave:()=>setDragOver(false),style:{display:'flex',alignItems:'center',gap:'4px',padding:'4px 8px',backgroundColor:dragOver?'var(--accent-color)':'var(--background-secondary)',color:dragOver?'white':'var(--text-primary)',border:\"1px dashed \".concat(dragOver?'var(--accent-color)':'#ddd'),borderRadius:'4px',cursor:'pointer',fontSize:'11px',fontWeight:'500',transition:'all 0.2s ease',minWidth:'60px',justifyContent:'center'},title:\"Click to upload or drag files here\",children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'12px'},children:\"\\uD83D\\uDCCE\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Upload\"}),uploading&&/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'10px',marginLeft:'2px',animation:'pulse 1s infinite'},children:\"...\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"file-input-\".concat(entityId),type:\"file\",accept:acceptedTypes.join(','),onChange:handleFileSelect,style:{display:'none'}})]});};// Custom hook for fetching files\nconst useFiles=(entityType,entityId)=>{const[files,setFiles]=useState([]);const[loading,setLoading]=useState(false);const fetchFiles=async()=>{if(!entityType||!entityId)return;setLoading(true);try{const url=\"\".concat(API,\"/attachments/\").concat(entityType,\"/\").concat(entityId);const response=await fetch(url,{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const attachments=await response.json();// Filter out avatar files, keep only documents\nconst documentAttachments=attachments.filter(att=>!att.mime_type.startsWith('image/')||!att.filename.includes('avatar')&&!att.filename.includes('custom_avatar'));setFiles(documentAttachments);}}catch(error){console.error('Error fetching files:',error);}finally{setLoading(false);}};useEffect(()=>{fetchFiles();},[entityType,entityId]);return{files,setFiles,loading,refetch:fetchFiles};};// File Display Component\nconst FileDisplay=_ref5=>{let{entityType,entityId,onFileDelete,showCustomNotification}=_ref5;const{files,loading,refetch}=useFiles(entityType,entityId);const[showDeleteConfirm,setShowDeleteConfirm]=useState(false);const[fileToDelete,setFileToDelete]=useState(null);const handleDownload=async attachment=>{try{const response=await fetch(\"\".concat(API,\"/attachments/\").concat(attachment.id),{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const data=await response.json();// Convert base64 to blob\nconst byteCharacters=atob(data.file_data);const byteNumbers=new Array(byteCharacters.length);for(let i=0;i<byteCharacters.length;i++){byteNumbers[i]=byteCharacters.charCodeAt(i);}const byteArray=new Uint8Array(byteNumbers);const blob=new Blob([byteArray],{type:data.mime_type});// Create download link\nconst url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=data.filename||attachment.original_filename;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);}else{throw new Error(\"HTTP \".concat(response.status,\": \").concat(response.statusText));}}catch(error){console.error('Download error:',error);showCustomNotification('Failed to download file: '+error.message,'error');}};const handlePreview=async attachment=>{try{const response=await fetch(\"\".concat(API,\"/attachments/\").concat(attachment.id),{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const data=await response.json();// Convert base64 to blob with error handling\ntry{// Clean the base64 data (remove any whitespace or invalid characters)\nconst cleanBase64=data.file_data.replace(/[\\n\\r\\s]/g,'');const byteCharacters=atob(cleanBase64);const byteNumbers=new Array(byteCharacters.length);for(let i=0;i<byteCharacters.length;i++){byteNumbers[i]=byteCharacters.charCodeAt(i);}const byteArray=new Uint8Array(byteNumbers);const blob=new Blob([byteArray],{type:data.mime_type});// Create preview URL\nconst url=window.URL.createObjectURL(blob);// For PDFs, try to open in new tab\nif(data.mime_type==='application/pdf'){const newWindow=window.open(url,'_blank');if(!newWindow){// If popup blocked, try to download instead\nconst link=document.createElement('a');link.href=url;link.download=data.original_filename||'document.pdf';link.click();}}else{// For other files, open in new tab\nwindow.open(url,'_blank');}// Clean up URL after a delay\nsetTimeout(()=>window.URL.revokeObjectURL(url),5000);}catch(base64Error){console.error('Base64 conversion error:',base64Error);throw new Error('Failed to convert file data for preview');}}else{throw new Error(\"HTTP \".concat(response.status,\": \").concat(response.statusText));}}catch(error){console.error('Preview error:',error);showCustomNotification('Failed to preview file: '+error.message,'error');}};const handleDelete=async attachment=>{setFileToDelete(attachment);setShowDeleteConfirm(true);};const confirmDelete=async()=>{if(!fileToDelete)return;try{const response=await fetch(\"\".concat(API,\"/attachments/\").concat(fileToDelete.id),{method:'DELETE',headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){refetch();if(onFileDelete)onFileDelete(attachment);}else{throw new Error('Delete failed');}// Clean up and close modal\nsetShowDeleteConfirm(false);setFileToDelete(null);refetch();if(onFileDelete){onFileDelete();}}catch(error){console.error('Delete error:',error);showCustomNotification('Failed to delete file','error');setShowDeleteConfirm(false);setFileToDelete(null);}};const cancelDelete=()=>{setShowDeleteConfirm(false);setFileToDelete(null);};const getFileIcon=mimeType=>{if(mimeType==='application/pdf')return'📄';if(mimeType.includes('excel')||mimeType.includes('spreadsheet'))return'📊';if(mimeType.startsWith('image/'))return'🖼️';return'📎';};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"file-display-loading\",children:\"Loading files...\"});}if(files.length===0){return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'8px',color:'var(--text-primary)',fontSize:'13px'},children:[/*#__PURE__*/_jsx(\"p\",{style:{marginBottom:'8px'},children:\"No files attached\"}),/*#__PURE__*/_jsx(FileUpload,{entityType:entityType,entityId:entityId,onFileUpload:()=>refetch(),showCustomNotification:showCustomNotification})]});}return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'8px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'8px',fontSize:'13px',fontWeight:'500',color:'var(--text-primary)'},children:/*#__PURE__*/_jsxs(\"span\",{children:[\"Files (\",files.length,\")\"]})}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'4px',maxHeight:'150px',overflowY:'auto'},children:files.map(file=>/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',padding:'6px 8px',backgroundColor:'var(--background-secondary)',borderRadius:'4px',fontSize:'12px',border:'1px solid #eee'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'6px',flex:1},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'14px'},children:getFileIcon(file.mime_type)}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:'500',color:'var(--text-primary)',overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap',maxWidth:'180px'},children:file.original_filename}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'var(--text-secondary)',fontSize:'10px',whiteSpace:'nowrap'},children:[\"(\",(file.file_size/1024/1024).toFixed(1),\" MB)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'2px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePreview(file),title:\"Preview\",style:{padding:'2px 4px',border:'none',background:'transparent',cursor:'pointer',borderRadius:'3px',fontSize:'11px'},children:\"\\uD83D\\uDC41\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDownload(file),title:\"Download\",style:{padding:'2px 4px',border:'none',background:'transparent',cursor:'pointer',borderRadius:'3px',fontSize:'11px'},children:\"\\u2B07\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(file),title:\"Delete\",style:{padding:'2px 4px',border:'none',background:'transparent',cursor:'pointer',borderRadius:'3px',fontSize:'11px',color:'#e74c3c'},children:\"\\uD83D\\uDDD1\\uFE0F\"})]})]},file.id))}),showDeleteConfirm&&fileToDelete&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.6)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:9999,fontFamily:'var(--font-family)'},children:/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',maxWidth:'450px',width:'90%',boxShadow:'var(--glass-shadow)',border:'1px solid var(--border-color)',position:'relative',backdropFilter:'var(--glass-blur)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'28px',color:'#ff4757'},children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',fontFamily:'var(--font-family)'},children:\"Delete Confirmation\"})]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0 0 24px 0',color:'var(--text-secondary)',fontSize:'15px',lineHeight:'1.6',fontFamily:'var(--font-family)'},children:[\"Are you sure you want to delete the file \",/*#__PURE__*/_jsxs(\"strong\",{style:{color:'var(--text-primary)'},children:[\"\\\"\",fileToDelete.original_filename,\"\\\"\"]}),\"?\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{style:{color:'#ff4757',fontSize:'13px'},children:\"This action cannot be undone.\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',justifyContent:'flex-end'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:cancelDelete,style:{padding:'10px 20px',border:'2px solid var(--border-color)',borderRadius:'8px',backgroundColor:'transparent',color:'var(--text-secondary)',cursor:'pointer',fontSize:'14px',fontWeight:'500',transition:'all 0.2s ease',fontFamily:'var(--font-family)'},onMouseOver:e=>{e.target.style.backgroundColor='var(--bg-tertiary)';e.target.style.borderColor='var(--accent-color)';},onMouseOut:e=>{e.target.style.backgroundColor='transparent';e.target.style.borderColor='var(--border-color)';},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:confirmDelete,style:{padding:'10px 20px',border:'none',borderRadius:'8px',background:'var(--gradient-danger)',color:'white',cursor:'pointer',fontSize:'14px',fontWeight:'500',transition:'all 0.2s ease',fontFamily:'var(--font-family)'},onMouseOver:e=>{e.target.style.transform='translateY(-1px)';e.target.style.boxShadow='0 4px 12px rgba(255, 71, 87, 0.4)';},onMouseOut:e=>{e.target.style.transform='translateY(0)';e.target.style.boxShadow='none';},children:\"Delete\"})]})]})})]});};// Component for displaying slot attachments count\nconst AttachmentIndicator=_ref6=>{let{slotId,onClick}=_ref6;const[attachmentCount,setAttachmentCount]=useState(0);const[loading,setLoading]=useState(false);const fetchAttachmentCount=async()=>{if(!slotId)return;setLoading(true);try{const response=await fetch(\"\".concat(API,\"/attachments/slots/\").concat(slotId),{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const data=await response.json();console.log('Fetched attachments for slot',slotId,':',data);// Filtrează doar documentele (nu avatarurile)\nconst documentAttachments=data.filter(att=>!att.mime_type.startsWith('image/')||!att.filename.includes('avatar')&&!att.filename.includes('custom_avatar'));console.log('Document attachments for slot',slotId,':',documentAttachments);setAttachmentCount(documentAttachments.length);}else{console.error('Failed to fetch attachments for slot',slotId,':',response.status);}}catch(error){console.error('Error fetching slot attachments:',error);}finally{setLoading(false);}};useEffect(()=>{fetchAttachmentCount();},[slotId]);return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'0px'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-attachment\",title:\"View Slot Attachments\",onClick:onClick,style:{fontSize:'14px',padding:'2px 4px',display:'inline-flex',alignItems:'center',justifyContent:'center',width:'32px',height:'32px',cursor:'pointer',border:'none',backgroundColor:'#d1e7ff',borderRadius:'50%',color:'#1e3a8a',marginRight:'0px'},children:\"\\uD83D\\uDCCE\"}),attachmentCount>0&&/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#3182ce',color:'white',borderRadius:'50%',width:'18px',height:'18px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'11px',fontWeight:'bold',minWidth:'18px',marginLeft:'-2px'},children:attachmentCount})]});};// Component for displaying generic entity attachments count\nconst GenericAttachmentIndicator=_ref7=>{let{entityType,entityId,onClick}=_ref7;const[attachmentCount,setAttachmentCount]=useState(0);const[loading,setLoading]=useState(false);const fetchAttachmentCount=async()=>{if(!entityId||!entityType)return;setLoading(true);try{const response=await fetch(\"\".concat(API,\"/attachments/\").concat(entityType,\"/\").concat(entityId),{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const data=await response.json();console.log('Fetched attachments for',entityType,entityId,':',data);// Filtrează doar documentele (nu avatarurile)\nconst documentAttachments=data.filter(att=>!att.mime_type.startsWith('image/')||!att.filename.includes('avatar')&&!att.filename.includes('custom_avatar'));console.log('Document attachments for',entityType,entityId,':',documentAttachments);setAttachmentCount(documentAttachments.length);}else{console.error('Failed to fetch attachments for',entityType,entityId,':',response.status);}}catch(error){console.error('Error fetching attachments:',error);}finally{setLoading(false);}};useEffect(()=>{fetchAttachmentCount();},[entityId,entityType]);return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'0px'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-attachment\",title:\"View \".concat(entityType,\" Attachments\"),onClick:e=>{console.log('🔗 GenericAttachmentIndicator clicked:',{entityType,entityId});e.preventDefault();e.stopPropagation();onClick();},style:{fontSize:'14px',padding:'2px 4px',display:'inline-flex',alignItems:'center',justifyContent:'center',width:'32px',height:'32px',cursor:'pointer',border:'none',backgroundColor:'#d1e7ff',borderRadius:'50%',color:'#1e3a8a',marginRight:'0px'},children:\"\\uD83D\\uDCCE\"}),attachmentCount>0&&/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#3182ce',color:'white',borderRadius:'50%',width:'18px',height:'18px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'11px',fontWeight:'bold',minWidth:'18px',marginLeft:'-2px'},children:attachmentCount})]});};// Component for displaying CVT attachments count\nconst CvtAttachmentIndicator=_ref8=>{let{cvtId,onClick}=_ref8;const[attachmentCount,setAttachmentCount]=useState(0);const[loading,setLoading]=useState(false);const fetchAttachmentCount=async()=>{if(!cvtId)return;setLoading(true);try{const response=await fetch(\"\".concat(API,\"/attachments/metrology/\").concat(cvtId),{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const data=await response.json();console.log('Fetched attachments for CVT',cvtId,':',data);// Filtrează doar documentele (nu avatarurile)\nconst documentAttachments=data.filter(att=>!att.mime_type.startsWith('image/')||!att.filename.includes('avatar')&&!att.filename.includes('custom_avatar'));console.log('Document attachments for CVT',cvtId,':',documentAttachments);setAttachmentCount(documentAttachments.length);}else{console.error('Failed to fetch attachments for CVT',cvtId,':',response.status);}}catch(error){console.error('Error fetching CVT attachments:',error);}finally{setLoading(false);}};useEffect(()=>{fetchAttachmentCount();},[cvtId]);return/*#__PURE__*/_jsx(\"button\",{className:\"btn-attachment\",title:\"View CVT Attachments\",onClick:onClick,style:{fontSize:'14px',padding:'2px 4px',display:'inline-flex',alignItems:'center',justifyContent:'center',width:'32px',height:'32px',cursor:'pointer',border:'none',backgroundColor:'#d1e7ff',borderRadius:'50%',color:'#1e3a8a'},children:\"\\uD83D\\uDCCE\"});};// Custom hook for fetching avatars\nconst useAvatar=(entityType,entityId)=>{const[avatar,setAvatar]=useState(null);const[loading,setLoading]=useState(false);const[fetched,setFetched]=useState(false);const fetchAvatar=async()=>{if(!entityType||!entityId||fetched)return;// Skip avatar fetch for entity types that don't exist in backend\nconst skipAvatarTypes=['jackpots','metrology','metrology2','commission_dates'];if(skipAvatarTypes.includes(entityType)){setAvatar(null);setLoading(false);setFetched(true);return;}setLoading(true);try{let url;if(entityType==='game_mixes'){url=\"\".concat(API,\"/attachments/game_mixes/\").concat(entityId);}else{url=\"\".concat(API,\"/attachments/\").concat(entityType,\"/\").concat(entityId);}const response=await fetch(url,{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const attachments=await response.json();const avatarAttachment=attachments.find(att=>att.mime_type.startsWith('image/')&&(att.filename.includes('avatar')||att.filename.includes('custom_avatar')));setAvatar(avatarAttachment||null);}}catch(error){console.error('Error fetching avatar:',error);}finally{setLoading(false);setFetched(true);}};useEffect(()=>{if(!fetched){fetchAvatar();}},[]);return{avatar,setAvatar,loading,refetch:fetchAvatar};};// Helper function to generate initials from entity name\nconst generateInitials=(name,entityType)=>{if(!name||typeof name!=='string'){return'?';}// Extrage doar litere și cifre, ignoră simboluri\nconst words=name.trim().split(/\\s+|-/).filter(Boolean);// Pentru Cabinets: 4 caractere (prima literă din primul cuvânt + primele 3 din al doilea)\nif(entityType==='cabinets'&&words.length>=2){const first=words[0].match(/[A-Za-z]/);const second=words[1].match(/[A-Za-z0-9]{1,3}/);const result=\"\".concat(first?first[0].toUpperCase():'').concat(second?second[0].toUpperCase():'')||'?';return result;}// Pentru Slots: primele 2 caractere din serial number\nif(entityType==='slots'){const result=name.substring(0,2).toUpperCase()||'?';return result;}// Pentru restul: 1 + 2 (prima literă din primul cuvânt + primele 2 din al doilea)\nif(words.length>=2){const first=words[0].match(/[A-Za-z]/);const second=words[1].match(/[A-Za-z0-9]{1,2}/);const result=\"\".concat(first?first[0].toUpperCase():'').concat(second?second[0].toUpperCase():'')||'?';return result;}else if(words.length===1){const match=words[0].match(/[A-Za-z0-9]{1,2}/);const result=match?match[0].toUpperCase():'?';return result;}return'?';};// Custom Avatar Editor Component\nconst CustomAvatarEditor=_ref9=>{let{entityType,entityId,currentAvatar,onAvatarChange,entityName,showCustomNotification}=_ref9;const[customText,setCustomText]=useState('');const[isEditing,setIsEditing]=useState(false);const[showEditor,setShowEditor]=useState(false);useEffect(()=>{if(entityName){setCustomText(generateInitials(entityName,entityType));}else{setCustomText(generateInitials('Unknown',entityType));}},[entityName,entityType]);const handleSaveCustomAvatar=async()=>{if(customText.trim()){try{// Creează un canvas pentru a genera avatar-ul personalizat\nconst canvas=document.createElement('canvas');const ctx=canvas.getContext('2d');canvas.width=200;canvas.height=200;// Fundal albastru\nctx.fillStyle='#1976d2';ctx.fillRect(0,0,200,200);// Text alb bold, font adaptiv, shadow pentru contrast\nctx.font='bold 90px Arial, sans-serif';ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillStyle='#fff';ctx.shadowColor='#000';ctx.shadowBlur=8;const text=customText.substring(0,8).toUpperCase();ctx.fillText(text,100,100);ctx.shadowBlur=0;// Convertește la base64\nconst dataURL=canvas.toDataURL('image/png');// Creează obiectul avatar pentru upload\nconst avatarData={filename:\"custom_avatar_\".concat(entityType,\"_\").concat(entityId,\"_\").concat(Date.now(),\".png\"),original_filename:\"custom_avatar_\".concat(entityType,\"_\").concat(entityId,\".png\"),file_size:Math.round(dataURL.length*3/4),// Aproximare dimensiune\nmime_type:'image/png',file_data:dataURL.split(',')[1],// Elimină prefixul data:image/png;base64,\nentity_type:entityType,entity_id:entityId};// Upload la backend\nconst response=await fetch(\"\".concat(API,\"/attachments\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify(avatarData)});if(response.ok){const uploadedAvatar=await response.json();onAvatarChange(uploadedAvatar);showCustomNotification('Custom avatar saved successfully!','success');}else{throw new Error('Failed to save avatar');}}catch(error){console.error('Error saving custom avatar:',error);showCustomNotification('Failed to save custom avatar. Please try again.','error');}setIsEditing(false);setShowEditor(false);}};const handleCancel=()=>{setCustomText(generateInitials(entityName||'Unknown',entityType));setIsEditing(false);setShowEditor(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"custom-avatar-editor\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"avatar-preview-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"avatar-preview\",children:/*#__PURE__*/_jsx(\"div\",{className:\"custom-avatar-display\",style:{width:'68px',height:'68px',background:'#1976d2',color:'#ffffff',fontWeight:'bold',display:'flex',alignItems:'center',justifyContent:'center',borderRadius:'50%',fontSize:entityType==='cabinets'?'16px':'20px',// Font mai mic pentru cabinete\ncursor:'pointer',border:'2px solid #ddd',boxShadow:'0 4px 8px rgba(0, 0, 0, 0.3)'},onClick:()=>setShowEditor(!showEditor),title:\"Click to edit custom avatar\",children:customText.substring(0,8).toUpperCase()})}),/*#__PURE__*/_jsx(\"div\",{className:\"avatar-actions\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-edit-avatar\",onClick:()=>setShowEditor(!showEditor),style:{padding:'4px 8px',fontSize:'12px',background:'#1976d2',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',marginTop:'8px'},children:\"\\u270F\\uFE0F Edit Custom Avatar\"})})]}),showEditor&&/*#__PURE__*/_jsx(\"div\",{className:\"avatar-editor-modal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"editor-content\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Custom Avatar Editor\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"editor-input\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Custom Text (max 8 characters):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:customText,onChange:e=>setCustomText(e.target.value.substring(0,8)),maxLength:8,placeholder:\"Enter custom text\",style:{padding:'8px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px',width:'200px'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"editor-preview\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Preview:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"preview-avatar\",style:{width:'120px',height:'120px',background:'#1976d2',color:'#ffffff',fontWeight:'bold',display:'flex',alignItems:'center',justifyContent:'center',borderRadius:'50%',fontSize:'36px',// Font proporțional pentru 120px\nmargin:'10px auto',boxShadow:'0 4px 12px rgba(0, 0, 0, 0.3)'},children:customText.substring(0,8).toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"editor-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleSaveCustomAvatar,style:{padding:'8px 16px',background:'#4caf50',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',marginRight:'8px'},children:\"Save Avatar\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleCancel,style:{padding:'8px 16px',background:'#f44336',color:'white',border:'none',borderRadius:'4px',cursor:'pointer'},children:\"Cancel\"})]})]})})]});};// Avatar Display Component (for tables)\nconst AvatarDisplay=_ref0=>{let{entityType,entityId,size=50,entityName,rectangular,blueBgIfNoAvatar}=_ref0;const{avatar,loading}=useAvatar(entityType,entityId||'temp');// Game Mixes: avatar dreptunghiular 20x95 sau text pe fundal albastru\nif(entityType==='game_mixes'){const width=20,height=95;if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"avatar-display loading rectangular\",style:{width,height},children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-small\"})});}if(avatar){return/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(avatar.mime_type,\";base64,\").concat(avatar.file_data),alt:\"Avatar\",className:\"avatar-display rectangular\",style:{width,height,objectFit:'cover'}});}return/*#__PURE__*/_jsx(\"div\",{className:\"avatar-display rectangular blue-bg-avatar\",style:{width,height,background:'#1976d2',color:'#fff',fontWeight:'bold',display:'flex',alignItems:'center',justifyContent:'center',borderRadius:4,fontSize:12,whiteSpace:'normal',wordBreak:'break-word',textAlign:'center',padding:'0 4px',lineHeight:'1.1',overflow:'visible'},title:entityName,children:/*#__PURE__*/_jsx(\"span\",{style:{width:'100%',wordBreak:'break-word',whiteSpace:'normal'},children:entityName})});}// Restul modulelor: avatar rotund/pătrat 50x50, cu inițiale dacă nu există poză, fundal transparent\nlet width=50,height=50;if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"avatar-display loading\",style:{width,height},children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-small\"})});}if(avatar){return/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(avatar.mime_type,\";base64,\").concat(avatar.file_data),alt:\"Avatar\",className:\"avatar-display\",style:{width,height,objectFit:'cover',borderRadius:'50%'}});}// Inițiale cu fundal albastru pentru toate avatarele editabile\nconst initials=generateInitials(entityName||'Unknown',entityType)||'?';// Calculează dimensiunea fontului proporțională cu dimensiunea avatar-ului\n// Pentru cabinete, font mai mic pentru a încăpea 4 caractere\nconst fontSize=entityType==='cabinets'?Math.max(8,Math.min(width*0.25,16))// Pentru cabinete: între 8px și 16px\n:Math.max(12,Math.min(width*0.4,24));// Pentru restul: între 12px și 24px\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"avatar-display\",style:{width,height,borderRadius:'50%',display:'flex',alignItems:'center',justifyContent:'center',fontWeight:700,fontSize:\"\".concat(fontSize,\"px\"),// Font proporțional cu dimensiunea avatar-ului\ncolor:'#ffffff',// Text alb pentru toate\nbackground:'#1976d2',// Background albastru pentru toate\nboxShadow:'0 4px 8px rgba(0,0,0,0.3)'// Umbră pentru toate\n},title:entityName,children:initials});};const AuthProvider=_ref1=>{let{children}=_ref1;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);// Auto-logout after 15 minutes of inactivity\nuseEffect(()=>{let inactivityTimer;const resetTimer=()=>{clearTimeout(inactivityTimer);inactivityTimer=setTimeout(()=>{if(user){localStorage.removeItem('token');setUser(null);showCustomNotification('You have been logged out due to inactivity.','warning');}},15*60*1000);// 15 minutes\n};const events=['mousedown','mousemove','keypress','scroll','touchstart','click'];if(user){// Start timer\nresetTimer();// Add event listeners for user activity\nevents.forEach(event=>{document.addEventListener(event,resetTimer,true);});}return()=>{clearTimeout(inactivityTimer);events.forEach(event=>{document.removeEventListener(event,resetTimer,true);});};},[user]);useEffect(()=>{const token=localStorage.getItem('token');if(token){fetch(\"\".concat(API,\"/auth/me\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>res.json()).then(data=>{if(data.id){setUser(data);}else{localStorage.removeItem('token');}}).catch(()=>localStorage.removeItem('token')).finally(()=>setLoading(false));}else{setLoading(false);}},[]);const login=async(username,password)=>{const response=await fetch(\"\".concat(API,\"/auth/login\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,password})});const data=await response.json();if(response.ok){localStorage.setItem('token',data.access_token);// Încarcă permisiunile imediat după login\nconst meResponse=await fetch(\"\".concat(API,\"/auth/me\"),{headers:{'Authorization':\"Bearer \".concat(data.access_token)}});if(meResponse.ok){const userData=await meResponse.json();setUser(userData);}else{setUser(data.user);}return true;}throw new Error(data.detail||'Login failed');};const logout=()=>{localStorage.removeItem('token');setUser(null);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,login,logout,loading},children:children});};const useAuth=()=>useContext(AuthContext);// Helper function for entity display names\nconst getEntityDisplayName=type=>{const names={companies:'Company',locations:'Location',providers:'Provider',cabinets:'Cabinet',slots:'Slot Machine',gamemixes:'Game Mix',invoices:'Invoice',onjn:'ONJN Report',legal:'Legal Document',users:'User',jackpots:'Jackpot',metrology:'Metrology',metrology2:'Metrology',comision_date:'Comision Date'};return names[type]||type;};// Bulk Edit Form Component\nconst BulkEditForm=_ref10=>{let{entityType,selectedItems,onSave,onClose,companies,locations,providers,cabinets,gameMixes,slotMachines}=_ref10;const[formData,setFormData]=useState({});const handleChange=(field,value)=>{// If setting status to inactive for slots, show confirmation\nif(field==='status'&&value==='inactive'&&entityType==='slots'){setShowBulkStatusConfirm(true);setBulkStatusData({field,value,entityType});return;// Wait for confirmation\n}setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));};const handleSubmit=e=>{e.preventDefault();onSave(formData);};const getCommonFields=type=>{const commonFields={companies:['name','email','phone','status'],locations:['name','address','status'],providers:['email','phone','status'],cabinets:['status'],slots:['cabinet_id','game_mix_id','provider_id','model','serial_number','denomination','max_bet','rtp','gaming_places','commission_date','invoice_number','status','location_id','production_year','ownership_type','owner_company_id','lease_provider_id','lease_contract_number'],gamemixes:['status'],invoices:['status'],onjn:['status'],legal:['status'],users:['role','is_active'],metrology:['certificate_number','issue_date','issuing_authority','description'],metrology2:['certificate_number','issue_date','issuing_authority','cvt_type','cvt_expiry_date','description'],comision_date:['event_name','commission_date','serial_numbers'],jackpots:['jackpot_type']};return commonFields[type]||['status'];};const renderField=field=>{switch(field){case'status':// Handle different status options based on entity type\nconst getStatusOptions=()=>{if(entityType==='invoices'){return[{value:'pending',label:'Pending'},{value:'paid',label:'Paid'},{value:'overdue',label:'Overdue'}];}// Default status options for other entities\nreturn[{value:'active',label:'Active'},{value:'inactive',label:'Inactive'}];};return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.status||'',onChange:e=>handleChange('status',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Keep unchanged\"}),getStatusOptions().map(option=>/*#__PURE__*/_jsx(\"option\",{value:option.value,children:option.label},option.value))]})]},field);case'role':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Role\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.role||'',onChange:e=>handleChange('role',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Keep unchanged\"}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Admin\"}),/*#__PURE__*/_jsx(\"option\",{value:\"manager\",children:\"Manager\"}),/*#__PURE__*/_jsx(\"option\",{value:\"operator\",children:\"Operator\"})]})]},field);case'is_active':return/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.is_active||false,onChange:e=>handleChange('is_active',e.target.checked)}),\"Is Active\"]})},field);default:// Handle slots specific fields\nif(entityType==='slots'){switch(field){case'cabinet_id':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Cabinet\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Keep unchanged\"}),cabinets&&cabinets.map(cabinet=>/*#__PURE__*/_jsxs(\"option\",{value:cabinet.id,children:[cabinet.name,\" - \",cabinet.model||'No Model']},cabinet.id))]})]},field);case'game_mix_id':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Game Mix\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Keep unchanged\"}),gameMixes&&gameMixes.map(gameMix=>/*#__PURE__*/_jsxs(\"option\",{value:gameMix.id,children:[gameMix.name,\" (\",gameMix.game_count,\" games)\"]},gameMix.id))]})]},field);case'provider_id':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Provider\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Keep unchanged\"}),providers&&providers.map(provider=>/*#__PURE__*/_jsx(\"option\",{value:provider.id,children:provider.company_name},provider.id))]})]},field);case'location_id':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Location\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Keep unchanged\"}),locations&&locations.map(location=>/*#__PURE__*/_jsxs(\"option\",{value:location.id,children:[location.name,\" - \",location.city]},location.id))]})]},field);case'ownership_type':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Ownership Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Keep unchanged\"}),/*#__PURE__*/_jsx(\"option\",{value:\"property\",children:\"Property\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rent\",children:\"Rent\"})]})]},field);case'owner_company_id':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Owner Company\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Keep unchanged\"}),companies&&companies.map(company=>/*#__PURE__*/_jsx(\"option\",{value:company.id,children:company.name},company.id))]})]},field);case'lease_provider_id':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Lease Provider\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Keep unchanged\"}),providers&&providers.map(provider=>/*#__PURE__*/_jsx(\"option\",{value:provider.id,children:provider.company_name},provider.id))]})]},field);case'denomination':case'max_bet':case'rtp':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:field.split('_').map(word=>word.charAt(0).toUpperCase()+word.slice(1)).join(' ')}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",min:\"0\",value:formData[field]||'',onChange:e=>handleChange(field,parseFloat(e.target.value)),placeholder:\"Enter new \".concat(field.replace('_',' '),\" (leave empty to keep unchanged)\")})]},field);case'gaming_places':case'production_year':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:field.split('_').map(word=>word.charAt(0).toUpperCase()+word.slice(1)).join(' ')}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",value:formData[field]||'',onChange:e=>handleChange(field,parseInt(e.target.value)),placeholder:\"Enter new \".concat(field.replace('_',' '),\" (leave empty to keep unchanged)\")})]},field);case'commission_date':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Commission Date\"}),/*#__PURE__*/_jsx(Calendar,{value:formData[field]||'',onChange:date=>handleChange(field,date),placeholder:\"Select new commission date (leave empty to keep unchanged)\"})]},field);case'model':case'serial_number':case'invoice_number':case'lease_contract_number':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:field.split('_').map(word=>word.charAt(0).toUpperCase()+word.slice(1)).join(' ')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),placeholder:\"Enter new \".concat(field.replace('_',' '),\" (leave empty to keep unchanged)\")})]},field);default:return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:field.split('_').map(word=>word.charAt(0).toUpperCase()+word.slice(1)).join(' ')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),placeholder:\"Enter new \".concat(field.replace('_',' '),\" (leave empty to keep unchanged)\")})]},field);}}// Handle comision_date specific fields\nif(entityType==='comision_date'){switch(field){case'event_name':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Event Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),placeholder:\"Enter new event name (leave empty to keep unchanged)\"})]},field);case'commission_date':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Commission Date\"}),/*#__PURE__*/_jsx(Calendar,{value:formData[field]||'',onChange:date=>handleChange(field,date),placeholder:\"Select new commission date (leave empty to keep unchanged)\"})]},field);case'serial_numbers':return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Serial Numbers\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),rows:\"3\",placeholder:\"Enter new serial numbers separated by spaces (leave empty to keep unchanged)\"})]},field);default:return/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:field.split('_').map(word=>word.charAt(0).toUpperCase()+word.slice(1)).join(' ')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),placeholder:\"Enter new \".concat(field.replace('_',' '),\" (leave empty to keep unchanged)\")})]},field);}}// Handle other entity types\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:field.charAt(0).toUpperCase()+field.slice(1)}),/*#__PURE__*/_jsx(\"input\",{type:field.includes('email')?'email':'text',value:formData[field]||'',onChange:e=>handleChange(field,e.target.value),placeholder:\"Enter new \".concat(field,\" (leave empty to keep unchanged)\")})]},field);}};return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content bulk-edit-modal\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Bulk Edit \",getEntityDisplayName(entityType)]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Editing \",selectedItems.length,\" items. Only filled fields will be updated.\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"bulk-edit-form\",children:[getCommonFields(entityType).map(field=>renderField(field)),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"btn-primary\",children:[\"Update \",selectedItems.length,\" Items\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:onClose,children:\"Cancel\"})]})]})]})});};const Login=()=>{const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[error,setError]=useState('');const[loading,setLoading]=useState(false);const[rememberMe,setRememberMe]=useState(false);const{login}=useAuth();// Load saved credentials on component mount\nuseEffect(()=>{const savedCredentials=localStorage.getItem('savedCredentials');if(savedCredentials){const{username:savedUsername,password:savedPassword}=JSON.parse(savedCredentials);setUsername(savedUsername||'');setPassword(savedPassword||'');setRememberMe(true);}},[]);const handleSubmit=async e=>{e.preventDefault();setError('');setLoading(true);try{await login(username,password);// Save credentials if remember me is checked\nif(rememberMe){localStorage.setItem('savedCredentials',JSON.stringify({username:username,password:password}));}else{// Remove saved credentials if remember me is unchecked\nlocalStorage.removeItem('savedCredentials');}// User state will trigger useEffect to load dashboard data\n}catch(err){setError(err.message);}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"login-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"login-background\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://images.unsplash.com/photo-1563753159011-f1d8b8272c8c?crop=entropy&cs=srgb&fm=jpg&ixid=M3w3NTY2Njd8MHwxfHNlYXJjaHwzfHxwcm9mZXNzaW9uYWwlMjBkYXNoYm9hcmR8ZW58MHx8fGJsYWNrfDE3NTIxNDI5NTZ8MA&ixlib=rb-4.1.0&q=85\",alt:\"Professional dashboard\",className:\"login-bg-image\"}),/*#__PURE__*/_jsx(\"div\",{className:\"login-overlay\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"login-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"login-header\",style:{textAlign:'center'},children:/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"CASHPOT Logo\",style:{width:'300px',height:'auto',maxWidth:'100%',marginBottom:'20px',display:'block',margin:'0 auto 20px auto'}})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"login-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",style:{color:'white'},children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",value:username,onChange:e=>setUsername(e.target.value),required:true,className:\"form-input\",placeholder:\"Enter your username\",style:{color:'white'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",style:{color:'white'},children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true,className:\"form-input\",placeholder:\"Enter your password\",style:{color:'white'}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"remember-me-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:rememberMe,onChange:e=>setRememberMe(e.target.checked),className:\"remember-me-checkbox\"}),/*#__PURE__*/_jsx(\"span\",{className:\"remember-me-text\",style:{color:'white'},children:\"Remember my password\"})]})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"login-button\",children:loading?'Signing in...':'Sign In'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"login-footer\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Demo Admin: admin / password\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Contact your administrator for access\"})]})]})]});};// Generic Entity Form Component\nconst EntityForm=_ref11=>{let{entityType,entity,onSave,onClose,companies,locations,providers,cabinets,gameMixes,invoices,users,slotMachines,metrology,jackpots,showCustomNotification}=_ref11;const[formData,setFormData]=useState({});// Avatar state\nconst{avatar,setAvatar}=useAvatar(entityType,entity===null||entity===void 0?void 0:entity.id);const handleAvatarChange=newAvatar=>{setAvatar(newAvatar);};useEffect(()=>{// Initialize form data based on entity type\nif(entity){setFormData(entity);}else{setFormData(getDefaultFormData(entityType));}},[entity,entityType]);const getDefaultFormData=type=>{const defaults={companies:{name:'',registration_number:'',tax_id:'',address:'',phone:'',email:'',website:'',contact_person:''},locations:{name:'',address:'',city:'',county:'',country:'Romania',postal_code:'',company_id:'',manager_id:'',manager_phone:'',manager_email:'',contact_person_type:'manual',contact_person_id:'',contact_person:'',contact_email:'',contact_phone:''},providers:{name:'',company_name:'',contact_person:'',email:'',phone:'',address:'',website:''},cabinets:{name:'',model:'',provider_id:''},slots:{cabinet_id:'',game_mix_id:'',provider_id:'',model:'',production_year:new Date().getFullYear(),location_id:'',ownership_type:'',owner_company_id:'',lease_provider_id:'',serial_number:'',denomination:0.10,max_bet:100.00,rtp:95.00,gaming_places:1,commission_date:'',invoice_number:'',cvt_end_date:'',jackpot_name:''},gamemixes:{name:'',description:'',provider_id:'',games:[]},invoices:{invoice_number:'',company_id:'',location_id:'',serial_numbers:'',issue_date:new Date().toISOString().split('T')[0],due_date:new Date(Date.now()+30*24*60*60*1000).toISOString().split('T')[0],amount:0,currency:'EUR',status:'pending',description:'',transaction_type:'',buyer_id:'',seller_id:''},onjn:{report_number:'',report_type:'monthly',company_id:'',location_id:'',report_date:'',equipment_data:{}},legal:{title:'',document_type:'license',company_id:'',location_id:'',issue_date:'',issuing_authority:'',description:''},metrology:{serial_number:'',certificate_number:'',certificate_type:'calibration',issue_date:new Date().toISOString().split('T')[0],expiry_date:new Date(Date.now()+365*24*60*60*1000).toISOString().split('T')[0],// Default 1 year expiry\nissuing_authority:'',status:'active',description:''},metrology2:{serial_number:'',certificate_number:'',issue_date:new Date().toISOString().split('T')[0],issuing_authority:'',status:'active',description:''},jackpots:{serial_number:'',jackpot_name:'',jackpot_type:'progressive',increment_rate:0.1,level_1:'',level_2:'',level_3:'',level_4:'',level_5:'',description:''},comision_date:{event_name:'',commission_date:new Date().toISOString().split('T')[0],serial_numbers:''}};return defaults[type]||{};};const handleSubmit=e=>{e.preventDefault();onSave(formData);};const handleChange=(field,value)=>{setFormData(prev=>{const newData=_objectSpread(_objectSpread({},prev),{},{[field]:value});// Debug: Log transaction_type changes\nif(entityType==='invoices'&&field==='transaction_type'){console.log('🔄 Transaction Type changed:',value);console.log('🔄 Previous formData:',prev);console.log('🔄 New formData:',newData);}// If provider changes in slots form, reset cabinet and game mix selection\nif(entityType==='slots'&&field==='provider_id'){newData.cabinet_id='';newData.game_mix_id='';newData.model='';// Reset model when provider changes\n}// If cabinet changes in slots form, auto-fill model from selected cabinet\nif(entityType==='slots'&&field==='cabinet_id'&&value){const selectedCabinet=cabinets.find(cabinet=>cabinet.id===value);if(selectedCabinet){newData.model=selectedCabinet.model||\"\".concat(selectedCabinet.name,\" Model\");}else{newData.model='';}}// If serial number changes in slots form, auto-fill ownership details based on invoice\nif(entityType==='slots'&&field==='serial_number'&&value){console.log('🔍 Serial number changed to:',value);console.log('📋 Available invoices:',invoices.length);console.log('📋 Available companies:',companies.length);console.log('📋 Available providers:',providers.length);// Find existing slot machine with this serial number\nconst existingSlot=slotMachines.find(slot=>slot.serial_number===value);if(existingSlot){newData.commission_date=existingSlot.commission_date||'';newData.invoice_number=existingSlot.invoice_number||'';console.log('🎰 Found existing slot:',existingSlot);}// Find invoice with this serial number and auto-fill ownership details\nconsole.log('🔍 Searching for serial number in invoices...');invoices.forEach((invoice,index)=>{console.log(\"\\uD83D\\uDCC4 Invoice \".concat(index+1,\":\"),{invoice_number:invoice.invoice_number,serial_numbers:invoice.serial_numbers,transaction_type:invoice.transaction_type,buyer_id:invoice.buyer_id,seller_id:invoice.seller_id});});const invoiceWithSerial=invoices.find(invoice=>invoice.serial_numbers&&invoice.serial_numbers.split(/\\s+/).includes(value));if(invoiceWithSerial){console.log('🔍 Found invoice for serial number:',value);console.log('📄 Invoice transaction type:',invoiceWithSerial.transaction_type);console.log('🏢 Buyer ID:',invoiceWithSerial.buyer_id);console.log('🏪 Seller ID:',invoiceWithSerial.seller_id);console.log('📄 Invoice number:',invoiceWithSerial.invoice_number);console.log('📅 Issue date:',invoiceWithSerial.issue_date);console.log('🔄 Current formData before changes:',prev);if(invoiceWithSerial.transaction_type==='buy'){// For buy transactions: Property (Owned) + Buyer Company\nconst buyerCompany=companies.find(c=>c.id===invoiceWithSerial.buyer_id);newData.ownership_type='property';newData.owner_company_id=invoiceWithSerial.buyer_id||'';newData.invoice_number=invoiceWithSerial.invoice_number||'';// Convert date to ISO string format for Calendar component\n// Use commission_date if available, otherwise use issue_date\nconst dateToUse=invoiceWithSerial.commission_date||invoiceWithSerial.issue_date;if(dateToUse){const date=new Date(dateToUse);newData.commission_date=date.toISOString().split('T')[0];console.log('📅 Date to use:',dateToUse);console.log('📅 Converted date:',newData.commission_date);}else{newData.commission_date='';}// Set CVT End Date and Jackpot Name from invoice\nif(invoiceWithSerial.cvt_end_date){const cvtDate=new Date(invoiceWithSerial.cvt_end_date);newData.cvt_end_date=cvtDate.toISOString().split('T')[0];console.log('📅 Set cvt_end_date to:',invoiceWithSerial.cvt_end_date);}if(invoiceWithSerial.jackpots&&invoiceWithSerial.jackpots.length>0){if(invoiceWithSerial.jackpots.length===1){newData.jackpot_name=invoiceWithSerial.jackpots[0];}else{newData.jackpot_name='Multiple Jackpots';newData.jackpot_type='Multiple Types';}}// Set CVT End Date from Metrology table\nconst metrologyData=metrology.find(m=>m.serial_number===value);if(metrologyData&&metrologyData.cvt_end_date){const cvtDate=new Date(metrologyData.cvt_end_date);newData.cvt_end_date=cvtDate.toISOString().split('T')[0];console.log('📅 Set cvt_end_date from Metrology to:',metrologyData.cvt_end_date);}// Set Jackpot Name from Jackpots table\nconst jackpotsData=jackpots.filter(j=>j.serial_number===value);if(jackpotsData&&jackpotsData.length>0){if(jackpotsData.length===1){newData.jackpot_name=jackpotsData[0].jackpot_name;newData.jackpot_type=jackpotsData[0].jackpot_type;}else{newData.jackpot_name='Multiple Jackpots';newData.jackpot_type='Multiple Types';}}console.log('🟢 Buy transaction - Property Owned by:',buyerCompany===null||buyerCompany===void 0?void 0:buyerCompany.name);console.log('🏢 Set owner_company_id to:',invoiceWithSerial.buyer_id);console.log('📄 Set invoice_number to:',invoiceWithSerial.invoice_number);console.log('📅 Set commission_date to:',invoiceWithSerial.issue_date);console.log('🏠 Set ownership_type to: property');}else if(invoiceWithSerial.transaction_type==='rent'){// For rent transactions: Rent (Leased) + Seller Provider\nconst sellerProvider=providers.find(p=>p.id===invoiceWithSerial.seller_id);newData.ownership_type='rent';newData.lease_provider_id=invoiceWithSerial.seller_id||'';newData.invoice_number=invoiceWithSerial.invoice_number||'';// Convert date to ISO string format for Calendar component\n// Use commission_date if available, otherwise use issue_date\nconst dateToUse=invoiceWithSerial.commission_date||invoiceWithSerial.issue_date;if(dateToUse){const date=new Date(dateToUse);newData.commission_date=date.toISOString().split('T')[0];console.log('📅 Date to use:',dateToUse);console.log('📅 Converted date:',newData.commission_date);}else{newData.commission_date='';}// Set CVT End Date and Jackpot Name from invoice\nif(invoiceWithSerial.cvt_end_date){const cvtDate=new Date(invoiceWithSerial.cvt_end_date);newData.cvt_end_date=cvtDate.toISOString().split('T')[0];console.log('📅 Set cvt_end_date to:',invoiceWithSerial.cvt_end_date);}if(invoiceWithSerial.jackpots&&invoiceWithSerial.jackpots.length>0){if(invoiceWithSerial.jackpots.length===1){newData.jackpot_name=invoiceWithSerial.jackpots[0];}else{newData.jackpot_name='Multiple Jackpots';newData.jackpot_type='Multiple Types';}}// Set CVT End Date from Metrology table\nconst metrologyData=metrology.find(m=>m.serial_number===value);if(metrologyData&&metrologyData.cvt_end_date){const cvtDate=new Date(metrologyData.cvt_end_date);newData.cvt_end_date=cvtDate.toISOString().split('T')[0];console.log('📅 Set cvt_end_date from Metrology to:',metrologyData.cvt_end_date);}// Set Jackpot Name from Jackpots table\nconst jackpotsData=jackpots.filter(j=>j.serial_number===value);if(jackpotsData&&jackpotsData.length>0){if(jackpotsData.length===1){newData.jackpot_name=jackpotsData[0].jackpot_name||jackpotsData[0].name;newData.jackpot_type=jackpotsData[0].jackpot_type;}else{newData.jackpot_name='Multiple Jackpots';newData.jackpot_type='Multiple Types';}}console.log('🔵 Rent transaction - Leased from:',sellerProvider===null||sellerProvider===void 0?void 0:sellerProvider.name);console.log('🏪 Set lease_provider_id to:',invoiceWithSerial.seller_id);console.log('📄 Set invoice_number to:',invoiceWithSerial.invoice_number);console.log('📅 Set commission_date to:',invoiceWithSerial.issue_date);console.log('🏠 Set ownership_type to: rent');}else if(invoiceWithSerial.transaction_type==='sell'){// For sell transactions: Property (Owned) + Buyer Company\nconst buyerCompany=companies.find(c=>c.id===invoiceWithSerial.buyer_id);newData.ownership_type='property';newData.owner_company_id=invoiceWithSerial.buyer_id||'';newData.invoice_number=invoiceWithSerial.invoice_number||'';// Convert date to ISO string format for Calendar component\n// Use commission_date if available, otherwise use issue_date\nconst dateToUse=invoiceWithSerial.commission_date||invoiceWithSerial.issue_date;if(dateToUse){const date=new Date(dateToUse);newData.commission_date=date.toISOString().split('T')[0];console.log('📅 Date to use:',dateToUse);console.log('📅 Converted date:',newData.commission_date);}else{newData.commission_date='';}// Set CVT End Date and Jackpot Name from invoice\nif(invoiceWithSerial.cvt_end_date){const cvtDate=new Date(invoiceWithSerial.cvt_end_date);newData.cvt_end_date=cvtDate.toISOString().split('T')[0];console.log('📅 Set cvt_end_date to:',invoiceWithSerial.cvt_end_date);}if(invoiceWithSerial.jackpots&&invoiceWithSerial.jackpots.length>0){if(invoiceWithSerial.jackpots.length===1){newData.jackpot_name=invoiceWithSerial.jackpots[0];}else{newData.jackpot_name='Multiple Jackpots';newData.jackpot_type='Multiple Types';}}// Set CVT End Date from Metrology table\nconst metrologyData=metrology.find(m=>m.serial_number===value);if(metrologyData&&metrologyData.cvt_end_date){const cvtDate=new Date(metrologyData.cvt_end_date);newData.cvt_end_date=cvtDate.toISOString().split('T')[0];console.log('📅 Set cvt_end_date from Metrology to:',metrologyData.cvt_end_date);}// Set Jackpot Name from Jackpots table\nconst jackpotsData=jackpots.filter(j=>j.serial_number===value);if(jackpotsData&&jackpotsData.length>0){if(jackpotsData.length===1){newData.jackpot_name=jackpotsData[0].jackpot_name||jackpotsData[0].name;newData.jackpot_type=jackpotsData[0].jackpot_type;}else{newData.jackpot_name='Multiple Jackpots';newData.jackpot_type='Multiple Types';}}console.log('🟡 Sell transaction - Property Owned by:',buyerCompany===null||buyerCompany===void 0?void 0:buyerCompany.name);console.log('🏢 Set owner_company_id to:',invoiceWithSerial.buyer_id);console.log('📄 Set invoice_number to:',invoiceWithSerial.invoice_number);console.log('📅 Set commission_date to:',invoiceWithSerial.issue_date);console.log('🏠 Set ownership_type to: property');}console.log('🔄 Final newData after auto-fill:',{ownership_type:newData.ownership_type,owner_company_id:newData.owner_company_id,lease_provider_id:newData.lease_provider_id,invoice_number:newData.invoice_number,commission_date:newData.commission_date,cvt_end_date:newData.cvt_end_date,jackpot_name:newData.jackpot_name});console.log('🔄 About to update formData with newData');}else{console.log('❌ No invoice found for serial number:',value);}}// If manager changes in locations form, auto-fill phone and email\nif(entityType==='locations'&&field==='manager_id'){if(value){const selectedManager=Array.isArray(users)?users.find(user=>user.id===value):null;if(selectedManager){newData.manager_phone=selectedManager.phone||'';newData.manager_email=selectedManager.email||'';}}else{// Clear manager details if no manager is selected\nnewData.manager_phone='';newData.manager_email='';}}// If contact person changes in locations form, auto-fill contact details\nif(entityType==='locations'&&field==='contact_person_id'){if(value){const selectedContact=Array.isArray(users)?users.find(user=>user.id===value):null;if(selectedContact){newData.contact_person=\"\".concat(selectedContact.first_name||'',\" \").concat(selectedContact.last_name||'').trim()||selectedContact.username;newData.contact_email=selectedContact.email||'';newData.contact_phone=selectedContact.phone||'';}}else{// Clear contact details if no contact person is selected\nnewData.contact_person='';newData.contact_email='';newData.contact_phone='';}}return newData;});};const handleGamesChange=games=>{const gameArray=games.split('\\n').filter(game=>game.trim());setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{games:gameArray}));};const renderFormFields=()=>{var _providers$find,_companies$find;switch(entityType){case'companies':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Company Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.name||'',onChange:e=>handleChange('name',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Registration Number *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.registration_number||'',onChange:e=>handleChange('registration_number',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Tax ID *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.tax_id||'',onChange:e=>handleChange('tax_id',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.address||'',onChange:e=>handleChange('address',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD83D\\uDCDE Phone *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.phone||'',onChange:e=>handleChange('phone',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD83D\\uDCE7 Email *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:formData.email||'',onChange:e=>handleChange('email',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Website\"}),/*#__PURE__*/_jsx(\"input\",{type:\"url\",value:formData.website||'',onChange:e=>handleChange('website',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Company Logo\"}),/*#__PURE__*/_jsx(\"div\",{className:\"avatar-section\",children:/*#__PURE__*/_jsx(AvatarUpload,{entityType:\"companies\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',currentAvatar:avatar,onAvatarChange:handleAvatarChange,showCustomNotification:showCustomNotification})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Custom Avatar Editor\"}),/*#__PURE__*/_jsx(CustomAvatarEditor,{entityType:\"companies\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',currentAvatar:avatar,onAvatarChange:handleAvatarChange,entityName:formData.name,showCustomNotification:showCustomNotification})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Company Documents\"}),/*#__PURE__*/_jsx(FileUpload,{entityType:\"companies\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',onFileUpload:()=>fetchFiles&&fetchFiles(),showCustomNotification:showCustomNotification}),/*#__PURE__*/_jsx(FileDisplay,{entityType:\"companies\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',showCustomNotification:showCustomNotification})]})]});case'locations':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Location Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.name||'',onChange:e=>handleChange('name',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Company *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.company_id||'',onChange:e=>handleChange('company_id',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Company\"}),companies.map(company=>/*#__PURE__*/_jsx(\"option\",{value:company.id,children:company.name},company.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.address||'',onChange:e=>handleChange('address',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"City *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.city||'',onChange:e=>handleChange('city',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"County *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.county||'',onChange:e=>handleChange('county',e.target.value),required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Country\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.country||'Romania',onChange:e=>handleChange('country',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Postal Code *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.postal_code||'',onChange:e=>handleChange('postal_code',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Manager\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.manager_id||'',onChange:e=>handleChange('manager_id',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Manager\"}),users.map(user=>/*#__PURE__*/_jsxs(\"option\",{value:user.id,children:[user.first_name&&user.last_name?\"\".concat(user.first_name,\" \").concat(user.last_name):user.username,\" - \",user.email]},user.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Manager Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.manager_phone||'',onChange:e=>handleChange('manager_phone',e.target.value),placeholder:\"Auto-populated when manager is selected\",readOnly:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Manager Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:formData.manager_email||'',onChange:e=>handleChange('manager_email',e.target.value),placeholder:\"Auto-populated when manager is selected\",readOnly:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Contact Person Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.contact_person_type||'manual',onChange:e=>handleChange('contact_person_type',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"manual\",children:\"Manual Entry\"}),/*#__PURE__*/_jsx(\"option\",{value:\"user\",children:\"Select from Users\"})]})]}),formData.contact_person_type==='user'?/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Contact Person (User)\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.contact_person_id||'',onChange:e=>handleChange('contact_person_id',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select User\"}),users.map(user=>/*#__PURE__*/_jsxs(\"option\",{value:user.id,children:[user.first_name&&user.last_name?\"\".concat(user.first_name,\" \").concat(user.last_name):user.username,\" - \",user.email]},user.id))]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Contact Person Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.contact_person||'',onChange:e=>handleChange('contact_person',e.target.value),placeholder:\"Enter contact person name\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Contact Person Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:formData.contact_email||'',onChange:e=>handleChange('contact_email',e.target.value),placeholder:\"Enter contact person email\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Contact Person Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.contact_phone||'',onChange:e=>handleChange('contact_phone',e.target.value),placeholder:\"Enter contact person phone\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Location Avatar\"}),/*#__PURE__*/_jsx(\"div\",{className:\"avatar-section\",children:/*#__PURE__*/_jsx(AvatarUpload,{entityType:\"locations\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',currentAvatar:avatar,onAvatarChange:handleAvatarChange,showCustomNotification:showCustomNotification})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Custom Avatar Editor\"}),/*#__PURE__*/_jsx(CustomAvatarEditor,{entityType:\"locations\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',currentAvatar:avatar,onAvatarChange:handleAvatarChange,entityName:formData.name,showCustomNotification:showCustomNotification})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Location Documents\"}),/*#__PURE__*/_jsx(FileUpload,{entityType:\"locations\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',onFileUpload:()=>fetchFiles&&fetchFiles(),showCustomNotification:showCustomNotification}),/*#__PURE__*/_jsx(FileDisplay,{entityType:\"locations\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',showCustomNotification:showCustomNotification})]})]});case'providers':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Provider Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.name||'',onChange:e=>handleChange('name',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Company Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.company_name||'',onChange:e=>handleChange('company_name',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Contact Person *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.contact_person||'',onChange:e=>handleChange('contact_person',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD83D\\uDCE7 Email *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:formData.email||'',onChange:e=>handleChange('email',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD83D\\uDCDE Phone *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.phone||'',onChange:e=>handleChange('phone',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.address||'',onChange:e=>handleChange('address',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Website\"}),/*#__PURE__*/_jsx(\"input\",{type:\"url\",value:formData.website||'',onChange:e=>handleChange('website',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Provider Logo\"}),/*#__PURE__*/_jsx(\"div\",{className:\"avatar-section\",children:/*#__PURE__*/_jsx(AvatarUpload,{entityType:\"providers\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',currentAvatar:avatar,onAvatarChange:handleAvatarChange,showCustomNotification:showCustomNotification})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Custom Avatar Editor\"}),/*#__PURE__*/_jsx(CustomAvatarEditor,{entityType:\"providers\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',currentAvatar:avatar,onAvatarChange:handleAvatarChange,entityName:formData.name,showCustomNotification:showCustomNotification})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Provider Documents\"}),/*#__PURE__*/_jsx(FileUpload,{entityType:\"providers\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',onFileUpload:()=>fetchFiles&&fetchFiles(),showCustomNotification:showCustomNotification}),/*#__PURE__*/_jsx(FileDisplay,{entityType:\"providers\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',showCustomNotification:showCustomNotification})]})]});case'cabinets':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.name||'',onChange:e=>handleChange('name',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Model\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.model||'',onChange:e=>handleChange('model',e.target.value),placeholder:\"Optional model name\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Provider *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.provider_id||'',onChange:e=>handleChange('provider_id',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Provider\"}),providers.map(provider=>/*#__PURE__*/_jsx(\"option\",{value:provider.id,children:provider.name},provider.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Cabinet Logo\"}),/*#__PURE__*/_jsx(\"div\",{className:\"avatar-section\",children:/*#__PURE__*/_jsx(AvatarUpload,{entityType:\"cabinets\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',currentAvatar:avatar,onAvatarChange:handleAvatarChange,showCustomNotification:showCustomNotification})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Custom Avatar Editor\"}),/*#__PURE__*/_jsx(CustomAvatarEditor,{entityType:\"cabinets\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',currentAvatar:avatar,onAvatarChange:handleAvatarChange,entityName:formData.name,showCustomNotification:showCustomNotification})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Cabinet Documents\"}),/*#__PURE__*/_jsx(FileUpload,{entityType:\"cabinets\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',onFileUpload:()=>fetchFiles&&fetchFiles(),showCustomNotification:showCustomNotification}),/*#__PURE__*/_jsx(FileDisplay,{entityType:\"cabinets\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',showCustomNotification:showCustomNotification})]})]});case'slots':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{background:'linear-gradient(135deg, var(--accent-color) 0%, #4a90e2 100%)',color:'white',padding:'24px 32px',borderRadius:'12px 12px 0 0',margin:'-32px -32px 32px -32px',display:'flex',alignItems:'center',justifyContent:'space-between',boxShadow:'0 4px 20px rgba(0,0,0,0.1)'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'48px',height:'48px',background:'rgba(255,255,255,0.2)',borderRadius:'12px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'24px'},children:\"\\uD83C\\uDFB0\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,fontSize:'24px',fontWeight:'700'},children:editingEntity?'Edit Slot Machine':'Add Slot Machine'}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'4px 0 0 0',opacity:0.9,fontSize:'14px'},children:editingEntity?'Update slot machine information':'Create a new slot machine entry'})]})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-primary)',border:'1px solid var(--border-color)',borderRadius:'12px',marginBottom:'24px',overflow:'hidden',boxShadow:'0 2px 8px rgba(0,0,0,0.04)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{background:'var(--bg-secondary)',padding:'16px 24px',borderBottom:'1px solid var(--border-color)'},children:/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,color:'var(--text-primary)',fontSize:'18px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDCCB Basic Information\"})}),/*#__PURE__*/_jsx(\"div\",{style:{padding:'24px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'24px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:\"Provider *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.provider_id||'',onChange:e=>handleChange('provider_id',e.target.value),required:true,style:{width:'100%',padding:'12px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-primary)',color:'var(--text-primary)',fontSize:'14px',transition:'all 0.2s ease'},onFocus:e=>e.target.style.borderColor='var(--accent-color)',onBlur:e=>e.target.style.borderColor='var(--border-color)',children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Provider\"}),providers.map(provider=>/*#__PURE__*/_jsx(\"option\",{value:provider.id,children:provider.name},provider.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:\"Game Mix *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.game_mix_id||'',onChange:e=>handleChange('game_mix_id',e.target.value),required:true,style:{width:'100%',padding:'12px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-primary)',color:'var(--text-primary)',fontSize:'14px',transition:'all 0.2s ease'},onFocus:e=>e.target.style.borderColor='var(--accent-color)',onBlur:e=>e.target.style.borderColor='var(--border-color)',children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Game Mix\"}),gameMixes.filter(mix=>{if(!formData.provider_id)return true;return mix.provider_id===formData.provider_id;}).map(mix=>{const provider=providers.find(p=>p.id===mix.provider_id);return/*#__PURE__*/_jsxs(\"option\",{value:mix.id,children:[mix.name,\" (\",provider?provider.name:'Unknown Provider',\")\"]},mix.id);})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:\"Cabinet *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.cabinet_id||'',onChange:e=>handleChange('cabinet_id',e.target.value),required:true,style:{width:'100%',padding:'12px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-primary)',color:'var(--text-primary)',fontSize:'14px',transition:'all 0.2s ease'},onFocus:e=>e.target.style.borderColor='var(--accent-color)',onBlur:e=>e.target.style.borderColor='var(--border-color)',children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Cabinet\"}),cabinets.filter(cabinet=>{if(!formData.provider_id)return true;return cabinet.provider_id===formData.provider_id;}).map(cabinet=>{const provider=providers.find(p=>p.id===cabinet.provider_id);return/*#__PURE__*/_jsxs(\"option\",{value:cabinet.id,children:[cabinet.name,\" (\",provider?provider.name:'Unknown Provider',\")\"]},cabinet.id);})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:\"Serial Number *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.serial_number||'',onChange:e=>handleChange('serial_number',e.target.value),required:true,style:{width:'100%',padding:'12px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-primary)',color:'var(--text-primary)',fontSize:'14px',transition:'all 0.2s ease'},onFocus:e=>e.target.style.borderColor='var(--accent-color)',onBlur:e=>e.target.style.borderColor='var(--border-color)',placeholder:\"Enter serial number\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:\"Model *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.model||'',readOnly:true,required:true,style:{width:'100%',padding:'12px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-secondary)',color:'var(--text-secondary)',fontSize:'14px',cursor:'not-allowed'},placeholder:\"Auto-filled from cabinet\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:\"Location *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.location_id||'',onChange:e=>handleChange('location_id',e.target.value),required:true,style:{width:'100%',padding:'12px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-primary)',color:'var(--text-primary)',fontSize:'14px',transition:'all 0.2s ease'},onFocus:e=>e.target.style.borderColor='var(--accent-color)',onBlur:e=>e.target.style.borderColor='var(--border-color)',children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Location\"}),locations.map(location=>/*#__PURE__*/_jsx(\"option\",{value:location.id,children:location.name},location.id))]})]})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-primary)',border:'1px solid var(--border-color)',borderRadius:'12px',marginBottom:'24px',overflow:'hidden',boxShadow:'0 2px 8px rgba(0,0,0,0.04)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{background:'var(--bg-secondary)',padding:'16px 24px',borderBottom:'1px solid var(--border-color)'},children:/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,color:'var(--text-primary)',fontSize:'18px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDCC4 Ownership & Documentation\"})}),/*#__PURE__*/_jsx(\"div\",{style:{padding:'24px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'24px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:\"Ownership Type *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.ownership_type||'',onChange:e=>handleChange('ownership_type',e.target.value),required:true,style:{width:'100%',padding:'12px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-primary)',color:'var(--text-primary)',fontSize:'14px',transition:'all 0.2s ease'},onFocus:e=>e.target.style.borderColor='var(--accent-color)',onBlur:e=>e.target.style.borderColor='var(--border-color)',children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Ownership Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"property\",children:\"Property (Owned)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rent\",children:\"Rent (Leased)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:\"Owner Company\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.ownership_type==='rent'?((_providers$find=providers.find(p=>p.id===formData.lease_provider_id))===null||_providers$find===void 0?void 0:_providers$find.name)||'':((_companies$find=companies.find(c=>c.id===formData.owner_company_id))===null||_companies$find===void 0?void 0:_companies$find.name)||'',onChange:e=>{const selectedName=e.target.value;if(formData.ownership_type==='rent'){const provider=providers.find(p=>p.name===selectedName);handleChange('lease_provider_id',(provider===null||provider===void 0?void 0:provider.id)||'');}else{const company=companies.find(c=>c.name===selectedName);handleChange('owner_company_id',(company===null||company===void 0?void 0:company.id)||'');}},style:{width:'100%',padding:'12px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-primary)',color:'var(--text-primary)',fontSize:'14px',transition:'all 0.2s ease'},onFocus:e=>e.target.style.borderColor='var(--accent-color)',onBlur:e=>e.target.style.borderColor='var(--border-color)',children:[/*#__PURE__*/_jsxs(\"option\",{value:\"\",children:[\"Select \",formData.ownership_type==='rent'?'Provider':'Company']}),formData.ownership_type==='rent'?providers.map(provider=>/*#__PURE__*/_jsx(\"option\",{value:provider.name,children:provider.name},provider.id)):companies.map(company=>/*#__PURE__*/_jsx(\"option\",{value:company.name,children:company.name},company.id))]})]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:\"Invoice Number\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.invoice_number||'',onChange:e=>handleChange('invoice_number',e.target.value),style:{width:'100%',padding:'12px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-primary)',color:'var(--text-primary)',fontSize:'14px',transition:'all 0.2s ease'},onFocus:e=>e.target.style.borderColor='var(--accent-color)',onBlur:e=>e.target.style.borderColor='var(--border-color)',children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Invoice\"}),invoices.map(invoice=>/*#__PURE__*/_jsxs(\"option\",{value:invoice.invoice_number,children:[invoice.invoice_number,\" - \",invoice.amount,\"\\u20AC\"]},invoice.id))]})]})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'16px',justifyContent:'flex-end',padding:'24px 0',borderTop:'1px solid var(--border-color)',marginTop:'24px'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleCloseModal,style:{padding:'12px 24px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-primary)',color:'var(--text-primary)',fontSize:'14px',fontWeight:'600',cursor:'pointer',transition:'all 0.2s ease'},onMouseEnter:e=>{e.target.style.borderColor='var(--accent-color)';e.target.style.color='var(--accent-color)';},onMouseLeave:e=>{e.target.style.borderColor='var(--border-color)';e.target.style.color='var(--text-primary)';},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",style:{padding:'12px 24px',border:'none',borderRadius:'8px',background:'linear-gradient(135deg, var(--accent-color) 0%, #4a90e2 100%)',color:'white',fontSize:'14px',fontWeight:'600',cursor:'pointer',transition:'all 0.2s ease',boxShadow:'0 4px 12px rgba(0,0,0,0.15)'},onMouseEnter:e=>{e.target.style.transform='translateY(-2px)';e.target.style.boxShadow='0 6px 16px rgba(0,0,0,0.2)';},onMouseLeave:e=>{e.target.style.transform='translateY(0)';e.target.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)';},children:editingEntity?'Update Slot Machine':'Create Slot Machine'})]})]});case'gamemixes':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Mix Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.name||'',onChange:e=>handleChange('name',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description||'',onChange:e=>handleChange('description',e.target.value),required:true,rows:\"3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Provider *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.provider_id||'',onChange:e=>handleChange('provider_id',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Provider\"}),providers.map(provider=>/*#__PURE__*/_jsx(\"option\",{value:provider.id,children:provider.name},provider.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Games (one per line) *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:(formData.games||[]).join('\\n'),onChange:e=>handleGamesChange(e.target.value),required:true,rows:\"8\",placeholder:\"Enter game names, one per line\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Game Mix Avatar\"}),/*#__PURE__*/_jsx(\"div\",{className:\"avatar-section\",children:/*#__PURE__*/_jsx(AvatarUpload,{entityType:\"game_mixes\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',currentAvatar:avatar,onAvatarChange:handleAvatarChange,showCustomNotification:showCustomNotification})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Custom Avatar Editor\"}),/*#__PURE__*/_jsx(CustomAvatarEditor,{entityType:\"game_mixes\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',currentAvatar:avatar,onAvatarChange:handleAvatarChange,entityName:formData.name,showCustomNotification:showCustomNotification})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Game Mix Documents\"}),/*#__PURE__*/_jsx(FileUpload,{entityType:\"game_mixes\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',onFileUpload:()=>fetchFiles&&fetchFiles(),showCustomNotification:showCustomNotification}),/*#__PURE__*/_jsx(FileDisplay,{entityType:\"game_mixes\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',showCustomNotification:showCustomNotification})]})]});case'invoices':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Invoice Number *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.invoice_number||'',onChange:e=>handleChange('invoice_number',e.target.value),required:true,placeholder:\"e.g., INV-2025-001\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Company *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.company_id||'',onChange:e=>handleChange('company_id',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Company\"}),companies.map(company=>/*#__PURE__*/_jsx(\"option\",{value:company.id,children:company.name},company.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Location *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.location_id||'',onChange:e=>handleChange('location_id',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Locations\"}),locations.map(location=>/*#__PURE__*/_jsx(\"option\",{value:location.id,children:location.name},location.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Customer\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.buyer_id||'',onChange:e=>handleChange('buyer_id',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Customer (Company)\"}),companies.map(company=>/*#__PURE__*/_jsx(\"option\",{value:company.id,children:company.name},company.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Seller\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.seller_id||'',onChange:e=>handleChange('seller_id',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Seller (Provider)\"}),providers.map(provider=>/*#__PURE__*/_jsx(\"option\",{value:provider.id,children:provider.name},provider.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Transaction Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.transaction_type||'',onChange:e=>handleChange('transaction_type',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Transaction Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rent\",children:\"Rent\"}),/*#__PURE__*/_jsx(\"option\",{value:\"buy\",children:\"Buy\"}),/*#__PURE__*/_jsx(\"option\",{value:\"sell\",children:\"Sell\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Serial Numbers *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.serial_numbers||'',onChange:e=>handleChange('serial_numbers',e.target.value),required:true,placeholder:\"e.g., SER001 SER002 SER003 (space separated)\"}),/*#__PURE__*/_jsx(\"small\",{className:\"field-help\",children:\"Enter one or multiple serial numbers separated by spaces\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Issue Date *\"}),/*#__PURE__*/_jsx(Calendar,{value:formData.issue_date,onChange:date=>handleChange('issue_date',date),placeholder:\"Select issue date\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Due Date *\"}),/*#__PURE__*/_jsx(Calendar,{value:formData.due_date,onChange:date=>handleChange('due_date',date),placeholder:\"Select due date\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount (\\u20AC) *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:formData.amount||'',onChange:e=>handleChange('amount',parseFloat(e.target.value)),required:true,placeholder:\"0.00\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Currency\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.currency||'EUR',onChange:e=>handleChange('currency',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"EUR\",children:\"EUR (\\u20AC)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"RON\",children:\"RON (Lei)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"USD\",children:\"USD ($)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.status||'pending',onChange:e=>handleChange('status',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"Pending\"}),/*#__PURE__*/_jsx(\"option\",{value:\"paid\",children:\"Paid\"}),/*#__PURE__*/_jsx(\"option\",{value:\"overdue\",children:\"Overdue\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description||'',onChange:e=>handleChange('description',e.target.value),required:true,rows:\"3\",placeholder:\"Invoice description or notes\"})]})]});case'metrology':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Serial Numbers *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.serial_number||'',onChange:e=>handleChange('serial_number',e.target.value),required:true,placeholder:\"Enter serial numbers separated by space (e.g., 188686 2547364 100393)\",rows:\"3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Certificate Number *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.certificate_number||'',onChange:e=>handleChange('certificate_number',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Certificate Type *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.certificate_type||'',onChange:e=>handleChange('certificate_type',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"calibration\",children:\"Calibration\"}),/*#__PURE__*/_jsx(\"option\",{value:\"verification\",children:\"Verification\"}),/*#__PURE__*/_jsx(\"option\",{value:\"certification\",children:\"Certification\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Issue Date *\"}),/*#__PURE__*/_jsx(Calendar,{value:formData.issue_date,onChange:date=>handleChange('issue_date',date)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Expiry Date *\"}),/*#__PURE__*/_jsx(Calendar,{value:formData.expiry_date,onChange:date=>handleChange('expiry_date',date)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Calibration Interval (months) *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:formData.calibration_interval||'',onChange:e=>handleChange('calibration_interval',parseInt(e.target.value)),required:true,min:\"1\",max:\"60\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Issuing Authority *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.issuing_authority||'',onChange:e=>handleChange('issuing_authority',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Issuing Authority\"}),/*#__PURE__*/_jsx(\"option\",{value:\"BRML\",children:\"BRML\"}),/*#__PURE__*/_jsx(\"option\",{value:\"BMM\",children:\"BMM\"}),/*#__PURE__*/_jsx(\"option\",{value:\"METRON\",children:\"METRON\"}),/*#__PURE__*/_jsx(\"option\",{value:\"INSPECTION SLOT\",children:\"INSPECTION SLOT\"}),/*#__PURE__*/_jsx(\"option\",{value:\"RMC\",children:\"RMC\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"CVT Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.cvt_type||'',onChange:e=>handleChange('cvt_type',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select CVT Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"initial\",children:\"Initial\"}),/*#__PURE__*/_jsx(\"option\",{value:\"periodic\",children:\"Periodic\"}),/*#__PURE__*/_jsx(\"option\",{value:\"reparation\",children:\"Reparation\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"CVT End Date\"}),/*#__PURE__*/_jsx(Calendar,{value:formData.cvt_expiry_date,onChange:date=>handleChange('cvt_expiry_date',date)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description||'',onChange:e=>handleChange('description',e.target.value),required:true,rows:\"3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Metrology Documents\"}),/*#__PURE__*/_jsx(FileUpload,{entityType:\"metrology\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',onFileUpload:()=>fetchFiles&&fetchFiles(),showCustomNotification:showCustomNotification}),/*#__PURE__*/_jsx(FileDisplay,{entityType:\"metrology\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',showCustomNotification:showCustomNotification})]})]});case'metrology2':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Serial Numbers *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.serial_number||'',onChange:e=>handleChange('serial_number',e.target.value),required:true,placeholder:\"Enter serial numbers separated by space (e.g., 188686 2547364 100393)\",rows:\"3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Certificate Number *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.certificate_number||'',onChange:e=>handleChange('certificate_number',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Issue Date *\"}),/*#__PURE__*/_jsx(Calendar,{value:formData.issue_date,onChange:date=>handleChange('issue_date',date)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Issuing Authority *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.issuing_authority||'',onChange:e=>handleChange('issuing_authority',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Issuing Authority\"}),/*#__PURE__*/_jsx(\"option\",{value:\"BRML\",children:\"BRML\"}),/*#__PURE__*/_jsx(\"option\",{value:\"BMM\",children:\"BMM\"}),/*#__PURE__*/_jsx(\"option\",{value:\"METRON\",children:\"METRON\"}),/*#__PURE__*/_jsx(\"option\",{value:\"INSPECTION SLOT\",children:\"INSPECTION SLOT\"}),/*#__PURE__*/_jsx(\"option\",{value:\"RMC\",children:\"RMC\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"CVT Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.cvt_type||'',onChange:e=>handleChange('cvt_type',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select CVT Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"initial\",children:\"Initial\"}),/*#__PURE__*/_jsx(\"option\",{value:\"periodic\",children:\"Periodic\"}),/*#__PURE__*/_jsx(\"option\",{value:\"reparation\",children:\"Reparation\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"CVT End Date\"}),/*#__PURE__*/_jsx(Calendar,{value:formData.cvt_expiry_date,onChange:date=>handleChange('cvt_expiry_date',date)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description||'',onChange:e=>handleChange('description',e.target.value),required:true,rows:\"3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Metrology Documents\"}),/*#__PURE__*/_jsx(FileUpload,{entityType:\"metrology\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',onFileUpload:()=>fetchFiles&&fetchFiles(),showCustomNotification:showCustomNotification}),/*#__PURE__*/_jsx(FileDisplay,{entityType:\"metrology\",entityId:(entity===null||entity===void 0?void 0:entity.id)||'temp',showCustomNotification:showCustomNotification})]})]});case'jackpots':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Serial Number *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.serial_number||'',onChange:e=>handleChange('serial_number',e.target.value),placeholder:\"Enter slot machine serial number\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Jackpot Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.jackpot_name||'',onChange:e=>handleChange('jackpot_name',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Jackpot Type *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.jackpot_type||'progressive',onChange:e=>handleChange('jackpot_type',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"progressive\",children:\"Progressive\"}),/*#__PURE__*/_jsx(\"option\",{value:\"fixed\",children:\"Fixed\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mystery\",children:\"Mystery\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Increment Rate (%) *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:formData.increment_rate||0.1,onChange:e=>handleChange('increment_rate',parseFloat(e.target.value)),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Level 1\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.level_1||'',onChange:e=>handleChange('level_1',e.target.value),placeholder:\"e.g., 111-222\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Level 2\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.level_2||'',onChange:e=>handleChange('level_2',e.target.value),placeholder:\"e.g., 222-333\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Level 3\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.level_3||'',onChange:e=>handleChange('level_3',e.target.value),placeholder:\"e.g., 333-555\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Level 4\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.level_4||'',onChange:e=>handleChange('level_4',e.target.value),placeholder:\"e.g., 555-888\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Level 5\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.level_5||'',onChange:e=>handleChange('level_5',e.target.value),placeholder:\"e.g., 888-999\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description||'',onChange:e=>handleChange('description',e.target.value),rows:\"3\",placeholder:\"Additional details about the jackpot\",required:true})]})]});case'comision_date':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD83D\\uDCDD Event Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.event_name||'',onChange:e=>handleChange('event_name',e.target.value),placeholder:\"Enter event name (e.g., COM-001, Summer Event, etc.)\",required:true}),/*#__PURE__*/_jsx(\"small\",{style:{color:'var(--text-secondary)',fontSize:'12px'},children:\"Enter a descriptive name for this commission event\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD83D\\uDCC5 Commission Date *\"}),/*#__PURE__*/_jsx(Calendar,{value:formData.commission_date||'',onChange:value=>handleChange('commission_date',value),placeholder:\"Select commission date\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD83D\\uDD22 Serial Numbers *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.serial_numbers||'',onChange:e=>handleChange('serial_numbers',e.target.value),rows:\"4\",placeholder:\"Enter serial numbers separated by spaces (e.g., SN001 SN002 SN003)\",required:true}),/*#__PURE__*/_jsx(\"small\",{style:{color:'var(--text-secondary)',fontSize:'12px'},children:\"Enter one or more serial numbers separated by spaces\"})]})]});default:return/*#__PURE__*/_jsxs(\"div\",{children:[\"Form not implemented for \",entityType]});}};const getTitle=()=>{const titles={companies:'Company',locations:'Location',providers:'Provider',cabinets:'Cabinet',slots:'Slot Machine',gamemixes:'Game Mix',invoices:'Invoice',onjn:'ONJN Report',legal:'Legal Document',metrology:'Metrology',jackpots:'Jackpot',comision_date:'Comision Date'};return titles[entityType]||'Entity';};return/*#__PURE__*/_jsxs(\"div\",{className:\"user-edit-modal\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop\",onClick:onClose}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:entity?\"Edit \".concat(getTitle()):\"Create \".concat(getTitle())}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"user-form\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-section\",children:/*#__PURE__*/_jsx(\"div\",{className:\"form-grid\",children:renderFormFields()})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"btn-cancel\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-save\",children:entity?\"Update \".concat(getTitle()):\"Create \".concat(getTitle())})]})]})]})]});};// User Edit Form Component\nconst UserEditForm=_ref12=>{var _user$permissions,_user$permissions2;let{user,onSave,onClose,companies,locations,showCustomNotification}=_ref12;const[formData,setFormData]=useState({username:(user===null||user===void 0?void 0:user.username)||'',email:(user===null||user===void 0?void 0:user.email)||'',phone:(user===null||user===void 0?void 0:user.phone)||'',first_name:(user===null||user===void 0?void 0:user.first_name)||'',last_name:(user===null||user===void 0?void 0:user.last_name)||'',role:(user===null||user===void 0?void 0:user.role)||'operator',password:'',is_active:(user===null||user===void 0?void 0:user.is_active)!==false,assigned_locations:(user===null||user===void 0?void 0:user.assigned_locations)||[],permissions:{modules:{dashboard:true,companies:true,locations:true,providers:true,cabinets:true,game_mixes:true,slot_machines:true,invoices:true,onjn_reports:true,legal_documents:true,metrology:true,jackpots:true,users:true},actions:{companies:{create:true,read:true,update:true,delete:true},locations:{create:true,read:true,update:true,delete:true},providers:{create:true,read:true,update:true,delete:true},cabinets:{create:true,read:true,update:true,delete:true},game_mixes:{create:true,read:true,update:true,delete:true},slot_machines:{create:true,read:true,update:true,delete:true},invoices:{create:true,read:true,update:true,delete:true},onjn_reports:{create:true,read:true,update:true,delete:true},legal_documents:{create:true,read:true,update:true,delete:true},metrology:{create:true,read:true,update:true,delete:true},jackpots:{create:true,read:true,update:true,delete:true},users:{create:true,read:true,update:true,delete:true}},accessible_companies:(user===null||user===void 0?void 0:(_user$permissions=user.permissions)===null||_user$permissions===void 0?void 0:_user$permissions.accessible_companies)||[],accessible_locations:(user===null||user===void 0?void 0:(_user$permissions2=user.permissions)===null||_user$permissions2===void 0?void 0:_user$permissions2.accessible_locations)||[]}});// Avatar state\nconst{avatar,setAvatar}=useAvatar('users',user===null||user===void 0?void 0:user.id);const handleAvatarChange=newAvatar=>{setAvatar(newAvatar);};useEffect(()=>{if(user!==null&&user!==void 0&&user.permissions){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{permissions:{modules:_objectSpread(_objectSpread({},prev.permissions.modules),user.permissions.modules),actions:_objectSpread(_objectSpread({},prev.permissions.actions),user.permissions.actions),accessible_companies:user.permissions.accessible_companies||[],accessible_locations:user.permissions.accessible_locations||[]}}));}},[user]);const handleSubmit=e=>{e.preventDefault();onSave(formData);};const handleModuleChange=(module,checked)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{permissions:_objectSpread(_objectSpread({},prev.permissions),{},{modules:_objectSpread(_objectSpread({},prev.permissions.modules),{},{[module]:checked})})}));};const handleActionChange=(module,action,checked)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{permissions:_objectSpread(_objectSpread({},prev.permissions),{},{actions:_objectSpread(_objectSpread({},prev.permissions.actions),{},{[module]:_objectSpread(_objectSpread({},prev.permissions.actions[module]),{},{[action]:checked})})})}));};const handleCompanyChange=(companyId,checked)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{permissions:_objectSpread(_objectSpread({},prev.permissions),{},{accessible_companies:checked?[...prev.permissions.accessible_companies,companyId]:prev.permissions.accessible_companies.filter(id=>id!==companyId)})}));};const handleLocationChange=(locationId,checked)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{permissions:_objectSpread(_objectSpread({},prev.permissions),{},{accessible_locations:checked?[...prev.permissions.accessible_locations,locationId]:prev.permissions.accessible_locations.filter(id=>id!==locationId)}),assigned_locations:checked?[...prev.assigned_locations,locationId]:prev.assigned_locations.filter(id=>id!==locationId)}));};// Select All functions\nconst handleSelectAllModules=checked=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{permissions:_objectSpread(_objectSpread({},prev.permissions),{},{modules:modules.reduce((acc,module)=>{acc[module.key]=checked;return acc;},{})})}));};const handleSelectAllActions=checked=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{permissions:_objectSpread(_objectSpread({},prev.permissions),{},{actions:modules.filter(m=>m.key!=='dashboard').reduce((acc,module)=>{acc[module.key]=actions.reduce((actionAcc,action)=>{actionAcc[action.key]=checked;return actionAcc;},{});return acc;},{})})}));};const handleSelectAllCompanies=checked=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{permissions:_objectSpread(_objectSpread({},prev.permissions),{},{accessible_companies:checked?companies.map(c=>c.id):[]})}));};const handleSelectAllLocations=checked=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{permissions:_objectSpread(_objectSpread({},prev.permissions),{},{accessible_locations:checked?locations.map(l=>l.id):[]})}));};const modules=[{key:'dashboard',label:'Dashboard',icon:'📊'},{key:'companies',label:'Companies',icon:'🏢'},{key:'locations',label:'Locations',icon:'📍'},{key:'providers',label:'Providers',icon:'🎮'},{key:'cabinets',label:'Cabinets',icon:'🎰'},{key:'game_mixes',label:'Game Mixes',icon:'🎲'},{key:'slot_machines',label:'Slot Machines',icon:'🎯'},{key:'invoices',label:'Invoices',icon:'💰'},{key:'onjn_reports',label:'ONJN Reports',icon:'📋'},{key:'legal_documents',label:'Legal Documents',icon:'📄'},{key:'users',label:'Users',icon:'👥'}];const actions=[{key:'create',label:'Create',icon:'➕'},{key:'read',label:'Read',icon:'👁️'},{key:'update',label:'Update',icon:'✏️'},{key:'delete',label:'Delete',icon:'🗑️'}];return/*#__PURE__*/_jsxs(\"div\",{className:\"user-edit-modal\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop\",onClick:onClose}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:user?'Edit User':'Create User'}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"user-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"User Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.username,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{username:e.target.value})),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD83D\\uDCE7 Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:formData.email,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{email:e.target.value})),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD83D\\uDCDE Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.phone,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{phone:e.target.value})),placeholder:\"Enter phone number\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"First Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.first_name,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{first_name:e.target.value})),placeholder:\"Enter first name\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Last Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.last_name,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{last_name:e.target.value})),placeholder:\"Enter last name\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Role\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.role,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{role:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Admin\"}),/*#__PURE__*/_jsx(\"option\",{value:\"manager\",children:\"Manager\"}),/*#__PURE__*/_jsx(\"option\",{value:\"operator\",children:\"Operator\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Password \",user&&'(leave empty to keep current)']}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:formData.password,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{password:e.target.value})),placeholder:user?\"Leave empty to keep current\":\"Enter password\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.is_active,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{is_active:e.target.checked}))}),\"Active User\"]})})]}),user&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Profile Avatar\"}),/*#__PURE__*/_jsx(\"div\",{className:\"avatar-section\",children:/*#__PURE__*/_jsx(AvatarUpload,{entityType:\"users\",entityId:user.id,currentAvatar:avatar,onAvatarChange:handleAvatarChange,showCustomNotification:showCustomNotification})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Module Access\"}),/*#__PURE__*/_jsx(\"div\",{className:\"select-all-row\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label select-all-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:modules.every(module=>formData.permissions.modules[module.key]),onChange:e=>handleSelectAllModules(e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:'bold',color:'var(--accent-color)'},children:\"Select All Modules\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"permissions-grid\",children:modules.map(module=>/*#__PURE__*/_jsx(\"div\",{className:\"permission-item\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.permissions.modules[module.key],onChange:e=>handleModuleChange(module.key,e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{className:\"module-icon\",children:module.icon}),module.label]})},module.key))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Action Permissions\"}),/*#__PURE__*/_jsx(\"div\",{className:\"select-all-row\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label select-all-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:modules.filter(m=>m.key!=='dashboard').every(module=>actions.every(action=>{var _formData$permissions;return(_formData$permissions=formData.permissions.actions[module.key])===null||_formData$permissions===void 0?void 0:_formData$permissions[action.key];})),onChange:e=>handleSelectAllActions(e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:'bold',color:'var(--accent-color)'},children:\"Select All Actions\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"actions-table\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"actions-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"module-col\",children:\"Module\"}),actions.map(action=>/*#__PURE__*/_jsxs(\"div\",{className:\"action-col\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"action-icon\",children:action.icon}),action.label]},action.key))]}),modules.filter(m=>m.key!=='dashboard').map(module=>/*#__PURE__*/_jsxs(\"div\",{className:\"actions-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"module-col\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"module-icon\",children:module.icon}),module.label]}),actions.map(action=>{var _formData$permissions2;return/*#__PURE__*/_jsx(\"div\",{className:\"action-col\",children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:((_formData$permissions2=formData.permissions.actions[module.key])===null||_formData$permissions2===void 0?void 0:_formData$permissions2[action.key])||false,onChange:e=>handleActionChange(module.key,action.key,e.target.checked),disabled:!formData.permissions.modules[module.key]})},action.key);})]},module.key))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Company Access\"}),/*#__PURE__*/_jsx(\"div\",{className:\"select-all-row\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label select-all-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:companies.every(company=>formData.permissions.accessible_companies.includes(company.id)),onChange:e=>handleSelectAllCompanies(e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:'bold',color:'var(--accent-color)'},children:\"Select All Companies\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"access-grid\",children:companies.map(company=>/*#__PURE__*/_jsx(\"div\",{className:\"access-item\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.permissions.accessible_companies.includes(company.id),onChange:e=>handleCompanyChange(company.id,e.target.checked)}),\"\\uD83C\\uDFE2 \",company.name]})},company.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Location Access\"}),/*#__PURE__*/_jsx(\"div\",{className:\"select-all-row\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label select-all-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:locations.every(location=>formData.permissions.accessible_locations.includes(location.id)),onChange:e=>handleSelectAllLocations(e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:'bold',color:'var(--accent-color)'},children:\"Select All Locations\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"access-grid\",children:locations.map(location=>/*#__PURE__*/_jsx(\"div\",{className:\"access-item\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.permissions.accessible_locations.includes(location.id),onChange:e=>handleLocationChange(location.id,e.target.checked)}),\"\\uD83D\\uDCCD \",location.name]})},location.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"btn-cancel\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-save\",children:user?'Update User':'Create User'})]})]})]})]});};// Dashboard Component\nconst ScheduleChangeForm=_ref13=>{let{slot,providers,cabinets,gameMixes,locations,users,onSave,onCancel}=_ref13;const[formData,setFormData]=useState({newStatus:slot.status==='active'?'inactive':'active',provider_id:slot.provider_id||'',game_mix_id:slot.game_mix_id||'',cabinet_id:slot.cabinet_id||'',model:slot.model||'',location_id:slot.location_id||'',scheduledDate:new Date().toISOString().split('T')[0],scheduledTime:new Date().toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit',hour12:false})});// Dacă există modificări programate, să le afișeze\nconst existingChanges=slot.existingChanges||[];// Auto-fill model when cabinet is selected\nuseEffect(()=>{if(formData.cabinet_id){const selectedCabinet=cabinets.find(cabinet=>cabinet.id===formData.cabinet_id);if(selectedCabinet&&selectedCabinet.model){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{model:selectedCabinet.model}));}}},[formData.cabinet_id,cabinets]);const handleSubmit=e=>{e.preventDefault();const scheduledDateTime=new Date(\"\".concat(formData.scheduledDate,\"T\").concat(formData.scheduledTime)).toISOString();onSave({newStatus:formData.newStatus,provider_id:formData.provider_id,game_mix_id:formData.game_mix_id,cabinet_id:formData.cabinet_id,model:formData.model,location_id:formData.location_id,scheduledDateTime:scheduledDateTime});};const handleChange=(field,value)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,style:{display:'flex',flexDirection:'column',gap:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'var(--bg-secondary)',padding:'16px',borderRadius:'8px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{margin:'0 0 12px 0',color:'var(--text-primary)',fontSize:'16px'},children:[\"Slot Machine: \",slot.serial_number||slot.id]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0',color:'var(--text-secondary)',fontSize:'14px'},children:[\"Current Status: \",/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:slot.status})]})]}),existingChanges.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#fff3cd',padding:'16px',borderRadius:'8px',border:'1px solid #ffeaa7',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 16px 0',color:'#856404',fontSize:'16px',fontWeight:'600',borderBottom:'2px solid #f39c12',paddingBottom:'8px'},children:\"\\u23F0 Existing Scheduled Changes\"}),existingChanges.map((change,index)=>{var _change$changes,_change$changes$statu,_change$changes2,_change$changes2$stat,_change$changes9,_change$changes9$mode,_change$model,_change$changes0,_change$changes0$mode,_change$model2;return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'white',padding:'12px',borderRadius:'6px',border:'1px solid #ffeaa7',marginBottom:'8px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'8px'},children:[/*#__PURE__*/_jsxs(\"strong\",{style:{color:'#856404'},children:[\"Change #\",index+1]}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#856404',fontSize:'12px'},children:[\"Scheduled for: \",new Date(change.scheduledDateTime).toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#856404',fontSize:'14px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'8px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Modified by:\"}),\" \",(()=>{// Caută utilizatorul complet în lista de utilizatori\nconst user=Array.isArray(users)?users.find(u=>u.username===change.userName):null;if(user&&user.first_name&&user.last_name){return\"\".concat(user.first_name,\" \").concat(user.last_name);}else if(user&&user.username){return user.username;}else{return change.userName||'Unknown User';}})()]}),/*#__PURE__*/_jsx(\"div\",{style:{border:'1px solid #dee2e6',borderRadius:'4px',overflow:'hidden',marginTop:'8px'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',fontSize:'12px'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:'#f8f9fa',borderBottom:'1px solid #dee2e6'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px',textAlign:'left',borderRight:'1px solid #dee2e6',fontWeight:'bold'},children:\"Field\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px',textAlign:'left',borderRight:'1px solid #dee2e6',fontWeight:'bold'},children:\"Old Value\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px',textAlign:'left',fontWeight:'bold'},children:\"New Value\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid #f1f3f4'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4',fontWeight:'bold'},children:\"Status\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4'},children:((_change$changes=change.changes)===null||_change$changes===void 0?void 0:(_change$changes$statu=_change$changes.status)===null||_change$changes$statu===void 0?void 0:_change$changes$statu.old)||change.oldValue||'-'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px'},children:((_change$changes2=change.changes)===null||_change$changes2===void 0?void 0:(_change$changes2$stat=_change$changes2.status)===null||_change$changes2$stat===void 0?void 0:_change$changes2$stat.new)||change.newValue||'-'})]}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid #f1f3f4'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4',fontWeight:'bold'},children:\"Provider\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4'},children:((_change$changes3,_change$changes3$prov,_change$provider_id)=>{const providerId=((_change$changes3=change.changes)===null||_change$changes3===void 0?void 0:(_change$changes3$prov=_change$changes3.provider_id)===null||_change$changes3$prov===void 0?void 0:_change$changes3$prov.old)||((_change$provider_id=change.provider_id)===null||_change$provider_id===void 0?void 0:_change$provider_id.old);const oldProvider=providers.find(p=>p.id===providerId);return oldProvider?oldProvider.name:providerId||'-';})()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px'},children:((_change$changes4,_change$changes4$prov,_change$provider_id2)=>{const providerId=((_change$changes4=change.changes)===null||_change$changes4===void 0?void 0:(_change$changes4$prov=_change$changes4.provider_id)===null||_change$changes4$prov===void 0?void 0:_change$changes4$prov.new)||((_change$provider_id2=change.provider_id)===null||_change$provider_id2===void 0?void 0:_change$provider_id2.new);const newProvider=providers.find(p=>p.id===providerId);return newProvider?newProvider.name:providerId||'-';})()})]}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid #f1f3f4'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4',fontWeight:'bold'},children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4'},children:((_change$changes5,_change$changes5$game,_change$game_mix_id)=>{const gameMixId=((_change$changes5=change.changes)===null||_change$changes5===void 0?void 0:(_change$changes5$game=_change$changes5.game_mix_id)===null||_change$changes5$game===void 0?void 0:_change$changes5$game.old)||((_change$game_mix_id=change.game_mix_id)===null||_change$game_mix_id===void 0?void 0:_change$game_mix_id.old);const oldGameMix=gameMixes.find(g=>g.id===gameMixId);return oldGameMix?oldGameMix.name:gameMixId||'-';})()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px'},children:((_change$changes6,_change$changes6$game,_change$game_mix_id2)=>{const gameMixId=((_change$changes6=change.changes)===null||_change$changes6===void 0?void 0:(_change$changes6$game=_change$changes6.game_mix_id)===null||_change$changes6$game===void 0?void 0:_change$changes6$game.new)||((_change$game_mix_id2=change.game_mix_id)===null||_change$game_mix_id2===void 0?void 0:_change$game_mix_id2.new);const newGameMix=gameMixes.find(g=>g.id===gameMixId);return newGameMix?newGameMix.name:gameMixId||'-';})()})]}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid #f1f3f4'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4',fontWeight:'bold'},children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4'},children:((_change$changes7,_change$changes7$cabi,_change$cabinet_id)=>{const cabinetId=((_change$changes7=change.changes)===null||_change$changes7===void 0?void 0:(_change$changes7$cabi=_change$changes7.cabinet_id)===null||_change$changes7$cabi===void 0?void 0:_change$changes7$cabi.old)||((_change$cabinet_id=change.cabinet_id)===null||_change$cabinet_id===void 0?void 0:_change$cabinet_id.old);const oldCabinet=cabinets.find(c=>c.id===cabinetId);return oldCabinet?oldCabinet.name:cabinetId||'-';})()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px'},children:((_change$changes8,_change$changes8$cabi,_change$cabinet_id2)=>{const cabinetId=((_change$changes8=change.changes)===null||_change$changes8===void 0?void 0:(_change$changes8$cabi=_change$changes8.cabinet_id)===null||_change$changes8$cabi===void 0?void 0:_change$changes8$cabi.new)||((_change$cabinet_id2=change.cabinet_id)===null||_change$cabinet_id2===void 0?void 0:_change$cabinet_id2.new);const newCabinet=cabinets.find(c=>c.id===cabinetId);return newCabinet?newCabinet.name:cabinetId||'-';})()})]}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid #f1f3f4'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4',fontWeight:'bold'},children:\"Model\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4'},children:((_change$changes9=change.changes)===null||_change$changes9===void 0?void 0:(_change$changes9$mode=_change$changes9.model)===null||_change$changes9$mode===void 0?void 0:_change$changes9$mode.old)||((_change$model=change.model)===null||_change$model===void 0?void 0:_change$model.old)||'-'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px'},children:((_change$changes0=change.changes)===null||_change$changes0===void 0?void 0:(_change$changes0$mode=_change$changes0.model)===null||_change$changes0$mode===void 0?void 0:_change$changes0$mode.new)||((_change$model2=change.model)===null||_change$model2===void 0?void 0:_change$model2.new)||'-'})]}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid #f1f3f4'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4',fontWeight:'bold'},children:\"Location\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid #f1f3f4'},children:((_change$changes1,_change$changes1$loca,_change$location_id)=>{const locationId=((_change$changes1=change.changes)===null||_change$changes1===void 0?void 0:(_change$changes1$loca=_change$changes1.location_id)===null||_change$changes1$loca===void 0?void 0:_change$changes1$loca.old)||((_change$location_id=change.location_id)===null||_change$location_id===void 0?void 0:_change$location_id.old);const oldLocation=locations.find(l=>l.id===locationId);return oldLocation?oldLocation.name:locationId||'-';})()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px'},children:((_change$changes10,_change$changes10$loc,_change$location_id2)=>{const locationId=((_change$changes10=change.changes)===null||_change$changes10===void 0?void 0:(_change$changes10$loc=_change$changes10.location_id)===null||_change$changes10$loc===void 0?void 0:_change$changes10$loc.new)||((_change$location_id2=change.location_id)===null||_change$location_id2===void 0?void 0:_change$location_id2.new);const newLocation=locations.find(l=>l.id===locationId);return newLocation?newLocation.name:locationId||'-';})()})]})]})]})})]})]},change.id);})]}),/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'var(--bg-secondary)',padding:'16px',borderRadius:'8px',border:'1px solid var(--border-color)',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 16px 0',color:'var(--text-primary)',fontSize:'16px',fontWeight:'600',borderBottom:'2px solid var(--accent-color)',paddingBottom:'8px'},children:\"\\uD83D\\uDCCB Basic Information\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Provider *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.provider_id,onChange:e=>handleChange('provider_id',e.target.value),required:true,style:{width:'100%',padding:'8px',border:'1px solid var(--border-color)',borderRadius:'4px',backgroundColor:'var(--bg-secondary)',color:'var(--text-primary)'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Provider\"}),providers.map(provider=>/*#__PURE__*/_jsx(\"option\",{value:provider.id,children:provider.name},provider.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Game Mix *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.game_mix_id,onChange:e=>handleChange('game_mix_id',e.target.value),required:true,style:{width:'100%',padding:'8px',border:'1px solid var(--border-color)',borderRadius:'4px',backgroundColor:'var(--bg-secondary)',color:'var(--text-primary)'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Game Mix\"}),gameMixes.filter(mix=>{if(!formData.provider_id)return true;return mix.provider_id===formData.provider_id;}).map(mix=>{const provider=providers.find(p=>p.id===mix.provider_id);return/*#__PURE__*/_jsxs(\"option\",{value:mix.id,children:[mix.name,\" (\",provider?provider.name:'Unknown Provider',\")\"]},mix.id);})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Cabinet *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.cabinet_id,onChange:e=>handleChange('cabinet_id',e.target.value),required:true,style:{width:'100%',padding:'8px',border:'1px solid var(--border-color)',borderRadius:'4px',backgroundColor:'var(--bg-secondary)',color:'var(--text-primary)'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Cabinet\"}),cabinets.filter(cabinet=>{if(!formData.provider_id)return true;return cabinet.provider_id===formData.provider_id;}).map(cabinet=>{const provider=providers.find(p=>p.id===cabinet.provider_id);return/*#__PURE__*/_jsxs(\"option\",{value:cabinet.id,children:[cabinet.name,\" (\",provider?provider.name:'Unknown Provider',\")\"]},cabinet.id);})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Model *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.model,onChange:e=>handleChange('model',e.target.value),required:true,placeholder:\"Auto-filled from selected cabinet\",style:{width:'100%',padding:'8px',border:'1px solid var(--border-color)',borderRadius:'4px',backgroundColor:'var(--bg-secondary)',color:'var(--text-primary)'}}),/*#__PURE__*/_jsx(\"small\",{style:{color:'var(--text-secondary)',fontSize:'12px'},children:\"Model is automatically filled based on the selected cabinet\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Location *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.location_id,onChange:e=>handleChange('location_id',e.target.value),required:true,style:{width:'100%',padding:'8px',border:'1px solid var(--border-color)',borderRadius:'4px',backgroundColor:'var(--bg-secondary)',color:'var(--text-primary)'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Locations\"}),locations.map(location=>/*#__PURE__*/_jsx(\"option\",{value:location.id,children:location.name},location.id))]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',color:'var(--text-primary)',fontWeight:'600',fontSize:'14px'},children:\"New Status:\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px'},children:[/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',gap:'8px',cursor:'pointer',padding:'8px 12px',borderRadius:'6px',backgroundColor:formData.newStatus==='active'?'var(--accent-color)':'transparent',color:formData.newStatus==='active'?'white':'var(--text-primary)',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"status\",value:\"active\",checked:formData.newStatus==='active',onChange:e=>handleChange('newStatus',e.target.value),style:{display:'none'}}),\"Active\"]}),/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',gap:'8px',cursor:'pointer',padding:'8px 12px',borderRadius:'6px',backgroundColor:formData.newStatus==='inactive'?'#dc3545':'transparent',color:formData.newStatus==='inactive'?'white':'var(--text-primary)',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"status\",value:\"inactive\",checked:formData.newStatus==='inactive',onChange:e=>handleChange('newStatus',e.target.value),style:{display:'none'}}),\"Inactive\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',color:'var(--text-primary)',fontWeight:'600',fontSize:'14px'},children:\"Date:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.scheduledDate,onChange:e=>handleChange('scheduledDate',e.target.value),style:{width:'100%',padding:'10px',border:'1px solid var(--border-color)',borderRadius:'6px',backgroundColor:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'14px'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',color:'var(--text-primary)',fontWeight:'600',fontSize:'14px'},children:\"Time:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:formData.scheduledTime,onChange:e=>handleChange('scheduledTime',e.target.value),style:{width:'100%',padding:'10px',border:'1px solid var(--border-color)',borderRadius:'6px',backgroundColor:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'14px'}})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',justifyContent:'flex-end',marginTop:'20px'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onCancel,style:{padding:'10px 20px',border:'1px solid var(--border-color)',borderRadius:'8px',backgroundColor:'transparent',color:'var(--text-primary)',cursor:'pointer',fontSize:'14px',fontWeight:'500'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",style:{padding:'10px 20px',border:'none',borderRadius:'8px',backgroundColor:'var(--accent-color)',color:'white',cursor:'pointer',fontSize:'14px',fontWeight:'600'},children:\"Schedule Change\"})]})]});};// Games Page Component\nconst GamesPage=_ref14=>{let{gameMixes,theme,setActiveView,gameAvatars,setSelectedGameForDetails,setShowGameDetailsPage,gamesData,setGamesData,fetchGamesData,showCustomNotification,setShowGameTablePage,addBreadcrumb}=_ref14;// State pentru loading animation\nconst[isRefreshing,setIsRefreshing]=useState(false);// Extrage jocurile unice din gameMixes\nconst getUniqueGames=()=>{const uniqueGames=new Set();gameMixes.forEach(mix=>{if(mix.games){if(Array.isArray(mix.games)){mix.games.forEach(game=>uniqueGames.add(game.trim()));}else if(typeof mix.games==='string'){mix.games.split(',').forEach(game=>uniqueGames.add(game.trim()));}}});return Array.from(uniqueGames).sort();};const games=getUniqueGames();// Debug: Log all game names to see what we're working with\nconsole.log('🎮 All games in system:',games);console.log('🎯 Game Mixes data:',gameMixes);console.log('🧠 Games Data available:',gamesData);return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"h1\",{style:{color:'var(--text-primary)',margin:'0 0 16px 0',fontSize:'28px',fontWeight:'700'},children:\"\\uD83C\\uDFAE Games Management\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',alignItems:'center',flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveView('dashboard'),style:{background:'var(--accent-color)',color:'white',border:'none',borderRadius:'8px',padding:'10px 20px',cursor:'pointer',fontSize:'14px',fontWeight:'600'},children:\"\\u2190 Back to Dashboard\"}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{console.log('🗑️ Clearing all game images...');// Clear gamesData to force complete reload\nsetGamesData(null);// Clear any cached images\nif(window.caches){try{const cacheNames=await caches.keys();await Promise.all(cacheNames.map(name=>caches.delete(name)));console.log('🗑️ Browser cache cleared');}catch(error){console.log('⚠️ Could not clear browser cache:',error);}}// Force all images to reload by adding timestamp\nconst images=document.querySelectorAll('img');let clearedCount=0;images.forEach(img=>{if(img.src.includes('cdn.cashpot.ro')){// Add timestamp to force reload\nconst separator=img.src.includes('?')?'&':'?';img.src=img.src+separator+'t='+Date.now();clearedCount++;}});// Force complete data refresh after clearing\nsetTimeout(async()=>{try{await fetchGamesData(true);console.log('🔄 Games data refreshed after clearing images');showCustomNotification('Images cleared and data refreshed!','success');}catch(error){console.error('❌ Error refreshing games data:',error);showCustomNotification('Images cleared but refresh failed','warning');}},1000);console.log(\"\\uD83D\\uDDD1\\uFE0F Cleared \".concat(clearedCount,\" images and scheduled data refresh\"));showCustomNotification(\"\".concat(clearedCount,\" images cleared, refreshing data...\"),'success');},style:{background:'var(--bg-primary)',color:'var(--text-primary)',border:'1px solid var(--border-color)',borderRadius:'8px',padding:'10px 20px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDDD1\\uFE0F Clear Images\"}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{if(isRefreshing)return;// Prevent multiple clicks\nsetIsRefreshing(true);console.log('🔄 Refreshing games data...');try{// Simulate a small delay to show the animation\nawait new Promise(resolve=>setTimeout(resolve,800));// Force complete data refresh\nawait fetchGamesData(true);console.log('🔄 Complete refresh of games database completed');console.log('✅ Games data refreshed successfully!');showCustomNotification('Games data refreshed successfully!','success');}catch(error){console.error('❌ Error refreshing games data:',error);showCustomNotification('Error refreshing games data','error');}finally{setIsRefreshing(false);}},disabled:isRefreshing,style:{background:isRefreshing?'var(--border-color)':'var(--accent-color)',color:isRefreshing?'var(--text-secondary)':'white',border:'1px solid var(--border-color)',borderRadius:'8px',padding:'10px 20px',cursor:isRefreshing?'not-allowed':'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px',transition:'all 0.3s ease',opacity:isRefreshing?0.7:1},children:isRefreshing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'16px',height:'16px',border:'2px solid var(--text-secondary)',borderTop:'2px solid transparent',borderRadius:'50%',animation:'spin 1s linear infinite'}}),\"Refreshing...\"]}):/*#__PURE__*/_jsx(_Fragment,{children:\"\\uD83D\\uDD04 Refresh Games\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowGameTablePage(true);},style:{background:'var(--bg-primary)',color:'var(--text-primary)',border:'1px solid var(--border-color)',borderRadius:'8px',padding:'10px 20px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDCCA Game Table\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(200px, 1fr))',gap:'20px'},children:games.map((gameName,index)=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>{setSelectedGameForDetails(gameName);setShowGameDetailsPage(true);// Add breadcrumb for game details\naddBreadcrumb(gameName,'🎯',()=>{setShowGameDetailsPage(true);setSelectedGameForDetails(gameName);});},style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'16px',border:'1px solid var(--border-color)',cursor:'pointer',transition:'transform 0.2s ease-in-out',':hover':{transform:'translateY(-2px)'}},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'191.844px',height:'277.094px',margin:'0 auto 12px auto',display:'flex',alignItems:'center',justifyContent:'center',overflow:'hidden'},children:(()=>{// Check if gamesData exists and has the required functions\nif(!gamesData||!gamesData.findGameBySmartMatching){console.log(\"\\u26A0\\uFE0F gamesData not ready for \".concat(gameName,\", showing emoji fallback\"));return/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'48px',display:'flex',alignItems:'center',justifyContent:'center',height:'100%'},children:\"\\uD83C\\uDFB0\"});}// Use smart matching system\nconst gameData=gamesData.findGameBySmartMatching(gameName);if(gameData&&gameData.link){console.log(\"\\u2705 Found logo for \".concat(gameName,\" via smart matching:\"),gameData.link);return/*#__PURE__*/_jsx(\"img\",{src:gameData.link,alt:\"\".concat(gameName,\" Logo\"),style:{width:'100%',height:'100%',objectFit:'cover'},onError:e=>{console.log(\"\\u274C Image failed to load for \".concat(gameName));if(e.target&&e.target.style){e.target.style.display='none';}if(e.target&&e.target.nextSibling&&e.target.nextSibling.style){e.target.nextSibling.style.display='flex';}}});}console.log(\"\\u274C No logo found for \".concat(gameName,\" via smart matching\"));// Fallback to gameAvatars if available\nif(gameAvatars[gameName]){return/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(gameAvatars[gameName].mime_type,\";base64,\").concat(gameAvatars[gameName].file_data),alt:\"\".concat(gameName,\" Avatar\"),style:{width:'100%',height:'100%',objectFit:'cover'}});}// Default emoji if no image available\nreturn/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'48px',display:'flex',alignItems:'center',justifyContent:'center',height:'100%'},children:\"\\uD83C\\uDFB0\"});})()}),/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'16px',fontWeight:'600',color:'var(--text-primary)',textAlign:'center',margin:'0'},children:gameName})]},index))})]})})})})});};// Game Details Page Component\nconst GameDetailsPage=_ref15=>{let{gameName,onClose,gameMixes,slotMachines,locations,providers,cabinets,theme,gamesData,setGamesData,setSelectedGameMixForDetails,setShowGameMixDetailsPage,setShowGameDetailsPage,gamesViewMode,setGamesViewMode,addBreadcrumb}=_ref15;if(!gameName)return null;// Funcție pentru a găsi toate sloturile care conțin acest joc\nconst getAssociatedSlots=()=>{return slotMachines.filter(slot=>{const gameMix=gameMixes.find(gm=>gm.id===slot.game_mix_id);if(!gameMix||!gameMix.games)return false;if(Array.isArray(gameMix.games)){return gameMix.games.includes(gameName);}else if(typeof gameMix.games==='string'){return gameMix.games.split(',').map(g=>g.trim()).includes(gameName);}return false;});};const associatedSlots=getAssociatedSlots();return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0'},children:\"\\uD83C\\uDFAE Game Information\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'24px',alignItems:'flex-start'},children:[/*#__PURE__*/_jsx(\"div\",{style:{flexShrink:0},children:(()=>{// Use smart matching system\nconst gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;if(gameData&&gameData.link){return/*#__PURE__*/_jsx(\"img\",{src:gameData.link,alt:\"\".concat(gameName,\" Logo\"),style:{width:'191.844px',height:'277.094px',objectFit:'contain',borderRadius:'8px',display:'block'},onError:e=>{if(e.target&&e.target.style){e.target.style.display='none';}if(e.target&&e.target.nextSibling&&e.target.nextSibling.style){e.target.nextSibling.style.display='block';}}});}return/*#__PURE__*/_jsx(\"div\",{style:{width:'191.844px',height:'277.094px',background:'var(--bg-primary)',borderRadius:'8px',display:'flex',alignItems:'center',justifyContent:'center',border:'1px solid var(--border-color)'},children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'48px'},children:\"\\uD83C\\uDFB0\"})});})()}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px',marginBottom:'24px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFAF Game Name:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:gameName})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFB0 Associated Slots:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:associatedSlots.length})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(250px, 1fr))',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDD94 Game ID:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0',fontSize:'12px',fontFamily:'monospace'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;return gameData?gameData.id||'N/A':'N/A';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFE2 Provider:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;if(gameData&&gameData.Provider){return gameData.Provider;}// Fallback to finding provider from associated slots\nconst provider=associatedSlots.length>0?providers.find(p=>p.id===associatedSlots[0].provider_id):null;return provider?provider.name:'N/A';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFB2 Game Type:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;return gameData?gameData.game_type||'Slots':'N/A';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFEA Product:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;return gameData?gameData.product||'Casino':'Casino';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFAF Classification:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;return gameData?gameData.classification||'Video Slot':'Video Slot';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\u2699\\uFE0F Game Mechanic:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;return gameData?gameData.game_mechanic||'RNG':'RNG';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFA8 Theme:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;if(gameData&&gameData.theme){return gameData.theme;}// Fallback to intelligent guessing\nconst gameNameLower=gameName.toLowerCase();if(gameNameLower.includes('fruit')||gameNameLower.includes('hot')||gameNameLower.includes('burning'))return'Fruits';if(gameNameLower.includes('egypt')||gameNameLower.includes('ra')||gameNameLower.includes('pharaoh'))return'Ancient Civilizations';if(gameNameLower.includes('dragon')||gameNameLower.includes('myth'))return'Dragons and Mythical Creatures';if(gameNameLower.includes('vampire')||gameNameLower.includes('horror'))return'Horror and Supernatural';if(gameNameLower.includes('crown')||gameNameLower.includes('royal'))return'Royal and Luxury';if(gameNameLower.includes('zodiac')||gameNameLower.includes('wheel'))return'Space and Sci-fi';return'Various Themes';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCCA Volatility:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;if(gameData&&gameData.volatility){return gameData.volatility;}// Fallback to intelligent guessing\nconst gameNameLower=gameName.toLowerCase();if(gameNameLower.includes('extreme')||gameNameLower.includes('high'))return'High';if(gameNameLower.includes('medium'))return'Medium';if(gameNameLower.includes('low'))return'Low';return'Medium';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDD22 Lines:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;if(gameData&&gameData.lines){return gameData.lines;}// Fallback to intelligent guessing\nconst gameNameLower=gameName.toLowerCase();if(gameNameLower.includes('100'))return'100';if(gameNameLower.includes('40'))return'40';if(gameNameLower.includes('20'))return'20';if(gameNameLower.includes('10'))return'10';if(gameNameLower.includes('5'))return'5';return'Variable';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCD0 Layout:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;if(gameData&&gameData.layout){return gameData.layout;}// Fallback to intelligent guessing\nconst gameNameLower=gameName.toLowerCase();if(gameNameLower.includes('100')||gameNameLower.includes('40'))return'5x4';if(gameNameLower.includes('20')||gameNameLower.includes('10')||gameNameLower.includes('5'))return'5x3';return'5x3';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFAF Game Features:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;return gameData?gameData.game_features||'N/A':'N/A';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCB0 RTP:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;if(gameData&&gameData.rtp){return\"\".concat((parseFloat(gameData.rtp)*100).toFixed(2),\"%\");}return'N/A';})()})]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0 0 20px 0'},children:[\"\\uD83C\\uDFB2 Available Mixes with \",gameName]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(400px, 1fr))',gap:'24px'},children:(()=>{// Find all game mixes that contain this game\nconst mixesWithGame=gameMixes.filter(mix=>{if(!mix.games)return false;if(Array.isArray(mix.games)){return mix.games.includes(gameName);}else if(typeof mix.games==='string'){return mix.games.split(',').map(g=>g.trim()).includes(gameName);}return false;});if(mixesWithGame.length===0){return/*#__PURE__*/_jsx(\"div\",{style:{gridColumn:'1 / -1',textAlign:'center',padding:'20px',color:'var(--text-secondary)'},children:\"No game mixes found containing this game.\"});}return mixesWithGame.map((mix,index)=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>{console.log('🎯 Clicked on mix:',mix.name);console.log('🎯 Setting selectedGameMixForDetails:',mix);setSelectedGameMixForDetails(mix);setShowGameMixDetailsPage(true);setShowGameDetailsPage(false);setGamesViewMode('grid');// Reset to grid view\n// Add breadcrumb for game mix details (capture mix in closure)\nconst mixForBreadcrumb=mix;addBreadcrumb(mix.name,'🎮',()=>{// Navigate back to games page and close details\nsetActiveView('games');setShowGameMixDetailsPage(false);setSelectedGameMixForDetails(null);});},style:{background:'var(--bg-primary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)',textAlign:'center',cursor:'pointer',transition:'all 0.2s ease'},onMouseEnter:e=>{e.target.style.transform='translateY(-2px)';e.target.style.boxShadow='0 4px 12px rgba(0, 0, 0, 0.15)';},onMouseLeave:e=>{e.target.style.transform='translateY(0px)';e.target.style.boxShadow='none';},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'300px',height:'120px',margin:'0 auto 16px auto',display:'flex',alignItems:'center',justifyContent:'center',overflow:'hidden',borderRadius:'12px',background:'var(--bg-secondary)',border:'1px solid var(--border-color)'},children:(()=>{// Use AvatarDisplay component for game mix avatar\nconst{avatar,loading}=useAvatar('game_mixes',mix.id);if(loading){return/*#__PURE__*/_jsx(\"div\",{style:{width:'20px',height:'95px',background:'var(--border-color)',borderRadius:'4px'}});}if(avatar){return/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(avatar.mime_type,\";base64,\").concat(avatar.file_data),alt:\"\".concat(mix.name,\" Avatar\"),style:{width:'100%',height:'100%',objectFit:'cover'}});}// Fallback: background albastru cu text alb\nreturn/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',height:'100%',background:'#1976d2',color:'#ffffff',fontWeight:'normal',display:'flex',alignItems:'center',justifyContent:'center',borderRadius:'4px',fontSize:'12px',whiteSpace:'normal',wordBreak:'break-word',textAlign:'center',padding:'0 4px',lineHeight:'1.1'},children:mix.name.substring(0,8).toUpperCase()});})()}),/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'18px',fontWeight:'600',color:'var(--text-primary)',margin:'0 0 12px 0'},children:mix.name}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'14px',color:'var(--text-secondary)',margin:'0'},children:(()=>{if(Array.isArray(mix.games)){return\"\".concat(mix.games.length,\" games\");}else if(typeof mix.games==='string'){return\"\".concat(mix.games.split(',').length,\" games\");}return'0 games';})()})]},mix.id));})()})]}),associatedSlots.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0 0 20px 0'},children:[\"\\uD83C\\uDFB0 Slots with \",gameName]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Gaming Places\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:associatedSlots.map((slot,index)=>{const location=locations.find(l=>l.id===slot.location_id);const provider=providers.find(p=>p.id===slot.provider_id);const cabinet=cabinets.find(c=>c.id===slot.cabinet_id);const gameMix=gameMixes.find(gm=>gm.id===slot.game_mix_id);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:slot.serial_number}),/*#__PURE__*/_jsx(\"td\",{children:location?location.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:provider?provider.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:cabinet?cabinet.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:gameMix?gameMix.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:slot.gaming_places||'N/A'})]},slot.id);})})]})})]}),associatedSlots.length===0&&/*#__PURE__*/_jsx(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)',textAlign:'center'},children:/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',fontSize:'16px',margin:'0'},children:\"No slots found with this game.\"})})]})})})})});};const GameMixDetailsPage=_ref16=>{let{gameMix,onClose,slotMachines,locations,providers,cabinets,theme,gamesData,addBreadcrumb}=_ref16;if(!gameMix)return null;// Function to get all slots that use this game mix\nconst getAssociatedSlots=()=>{return slotMachines.filter(slot=>slot.game_mix_id===gameMix.id);};// Function to get games in this mix\nconst getGamesInMix=()=>{if(!gameMix.games)return[];if(Array.isArray(gameMix.games)){return gameMix.games;}else if(typeof gameMix.games==='string'){return gameMix.games.split(',').map(g=>g.trim()).filter(g=>g);}return[];};const associatedSlots=getAssociatedSlots();const gamesInMix=getGamesInMix();// State for games view mode (grid or list)\nconst[gamesViewMode,setGamesViewMode]=useState('grid');return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--success-color)',color:'white',padding:'20px',borderRadius:'12px',marginBottom:'24px',textAlign:'center',fontSize:'18px',fontWeight:'bold'},children:[\"\\uD83C\\uDF89 SUCCESS! GameMixDetailsPage este deschis\\u0103 pentru: \",gameMix.name]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'24px'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',fontSize:'24px',fontWeight:'600',margin:'0',display:'flex',alignItems:'center',gap:'8px'},children:[\"\\uD83C\\uDFB2 \",gameMix.name,\" - Game Mix Details\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--primary-color)',color:'white',border:'none',borderRadius:'8px',padding:'10px 16px',fontSize:'14px',fontWeight:'500',cursor:'pointer',display:'flex',alignItems:'center',gap:'6px',transition:'all 0.2s ease'},onMouseEnter:e=>e.target.style.opacity='0.9',onMouseLeave:e=>e.target.style.opacity='1',children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)'},children:/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",style:{width:'100%'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{width:'80px',textAlign:'center',padding:'16px 8px'},children:\"\\uD83C\\uDFB0\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'120px',padding:'16px 12px'},children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'150px',padding:'16px 12px'},children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'150px',padding:'16px 12px'},children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'150px',padding:'16px 12px'},children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'120px',padding:'16px 12px'},children:\"Gaming Places\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'100px',padding:'16px 12px'},children:\"Status\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:associatedSlots.length>0?associatedSlots.map((slot,index)=>{const location=locations.find(l=>l.id===slot.location_id);const provider=providers.find(p=>p.id===slot.provider_id);const cabinet=cabinets.find(c=>c.id===slot.cabinet_id);return/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)',transition:'background-color 0.2s ease'},onMouseEnter:e=>e.target.parentElement.style.backgroundColor='var(--bg-primary)',onMouseLeave:e=>e.target.parentElement.style.backgroundColor='transparent',children:[/*#__PURE__*/_jsx(\"td\",{style:{textAlign:'center',padding:'12px 8px',verticalAlign:'middle'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:'60px',height:'60px',margin:'0 auto',display:'flex',alignItems:'center',justifyContent:'center',background:'var(--bg-primary)',borderRadius:'8px',border:'1px solid var(--border-color)'},children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'24px'},children:\"\\uD83C\\uDFB0\"})})}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',fontWeight:'500',color:'var(--text-primary)',fontFamily:'monospace',fontSize:'13px'},children:slot.serial_number||'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:location?location.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:provider?provider.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:cabinet?cabinet.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)',textAlign:'center'},children:slot.gaming_places||'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',textAlign:'center'},children:/*#__PURE__*/_jsx(\"span\",{style:{background:'var(--success-color)',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'12px',fontWeight:'500'},children:\"Active\"})})]},slot.id||index);}):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\",style:{textAlign:'center',padding:'40px 20px',color:'var(--text-secondary)',fontSize:'16px'},children:\"No slots found using this game mix.\"})})})]})})}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0'},children:[\"\\uD83C\\uDFAE Games in \",gameMix.name]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setGamesViewMode('grid'),style:{background:currentViewMode==='grid'?'var(--primary-color)':'var(--bg-primary)',color:currentViewMode==='grid'?'white':'var(--text-secondary)',border:'1px solid var(--border-color)',borderRadius:'6px',padding:'8px 12px',fontSize:'12px',fontWeight:'500',cursor:'pointer',transition:'all 0.2s ease'},children:\"\\uD83D\\uDDBC\\uFE0F Grid\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setGamesViewMode('list'),style:{background:currentViewMode==='list'?'var(--primary-color)':'var(--bg-primary)',color:currentViewMode==='list'?'white':'var(--text-secondary)',border:'1px solid var(--border-color)',borderRadius:'6px',padding:'8px 12px',fontSize:'12px',fontWeight:'500',cursor:'pointer',transition:'all 0.2s ease'},children:\"\\uD83D\\uDCCB List\"})]})]}),gamesInMix.length>0?gamesViewMode==='grid'?/*#__PURE__*/// Grid View - Original layout\n_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(250px, 1fr))',gap:'16px'},children:gamesInMix.map((gameName,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-primary)',borderRadius:'12px',padding:'16px',border:'1px solid var(--border-color)',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'100px',height:'140px',margin:'0 auto 12px auto',display:'flex',alignItems:'center',justifyContent:'center',overflow:'hidden',borderRadius:'8px',background:'var(--bg-secondary)',border:'1px solid var(--border-color)'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;if(gameData&&gameData.link){return/*#__PURE__*/_jsx(\"img\",{src:gameData.link,alt:\"\".concat(gameName,\" Logo\"),style:{width:'100%',height:'100%',objectFit:'contain'},onError:e=>{e.target.style.display='none';if(e.target&&e.target.nextSibling&&e.target.nextSibling.style){e.target.nextSibling.style.display='flex';}}});}return/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'24px'},children:\"\\uD83C\\uDFB0\"});})()}),/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'14px',fontWeight:'600',color:'var(--text-primary)',margin:'0',textAlign:'center'},children:gameName})]},index))}):/*#__PURE__*/// List View - Table format\n_jsx(\"div\",{style:{background:'var(--bg-primary)',borderRadius:'8px',border:'1px solid var(--border-color)',overflow:'hidden'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{background:'var(--bg-secondary)',borderBottom:'2px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"th\",{style:{width:'80px',textAlign:'center',padding:'16px 8px',color:'var(--text-primary)',fontWeight:'600'},children:\"\\uD83C\\uDFB0\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'16px 12px',textAlign:'left',color:'var(--text-primary)',fontWeight:'600'},children:\"Game Name\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'16px 12px',textAlign:'left',color:'var(--text-primary)',fontWeight:'600'},children:\"Classification\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'16px 12px',textAlign:'left',color:'var(--text-primary)',fontWeight:'600'},children:\"Theme\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'16px 12px',textAlign:'left',color:'var(--text-primary)',fontWeight:'600'},children:\"Volatility\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:gamesInMix.map((gameName,index)=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;return/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)',transition:'background-color 0.2s ease'},onMouseEnter:e=>e.target.parentElement.style.backgroundColor='var(--bg-secondary)',onMouseLeave:e=>e.target.parentElement.style.backgroundColor='transparent',children:[/*#__PURE__*/_jsx(\"td\",{style:{textAlign:'center',padding:'12px 8px',verticalAlign:'middle'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:'60px',height:'60px',margin:'0 auto',display:'flex',alignItems:'center',justifyContent:'center',background:'var(--bg-secondary)',borderRadius:'8px',border:'1px solid var(--border-color)',overflow:'hidden'},children:gameData&&gameData.link?/*#__PURE__*/_jsx(\"img\",{src:gameData.link,alt:\"\".concat(gameName,\" Logo\"),style:{width:'100%',height:'100%',objectFit:'contain'},onError:e=>{e.target.style.display='none';if(e.target&&e.target.nextSibling&&e.target.nextSibling.style){e.target.nextSibling.style.display='flex';}}}):/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'20px'},children:\"\\uD83C\\uDFB0\"})})}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',fontWeight:'500',color:'var(--text-primary)'},children:gameName}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:gameData?gameData.classification||'Video Slot':'Video Slot'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:gameData?gameData.theme||'Various':'Various'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:gameData?gameData.volatility||'Medium':'Medium'})]},index);})})]})}):/*#__PURE__*/_jsx(\"div\",{style:{background:'var(--bg-primary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)',textAlign:'center'},children:/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',fontSize:'16px',margin:'0'},children:\"No games found in this mix.\"})})]}),associatedSlots.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0 0 20px 0'},children:[\"\\uD83C\\uDFB0 Slots using \",gameMix.name]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Gaming Places\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:associatedSlots.map((slot,index)=>{const location=locations.find(l=>l.id===slot.location_id);const provider=providers.find(p=>p.id===slot.provider_id);const cabinet=cabinets.find(c=>c.id===slot.cabinet_id);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:slot.serial_number||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:location?location.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:provider?provider.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:cabinet?cabinet.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:slot.gaming_places||'N/A'})]},slot.id||index);})})]})})]}),associatedSlots.length===0&&/*#__PURE__*/_jsx(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)',textAlign:'center'},children:/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',fontSize:'16px',margin:'0'},children:\"No slots found using this game mix.\"})})]})})})})});};const Dashboard=()=>{var _user$permissions3,_user$permissions3$mo,_user$permissions4,_user$permissions4$mo,_user$permissions5,_user$permissions5$mo,_user$permissions6,_user$permissions6$mo,_user$permissions7,_user$permissions7$mo,_user$permissions8,_user$permissions8$mo,_user$permissions9,_user$permissions9$mo,_user$permissions0,_user$permissions0$mo,_user$permissions1,_user$permissions1$mo,_user$permissions10,_user$permissions10$m,_user$permissions11,_user$permissions11$m,_user$permissions12,_user$permissions12$m,_user$username,_user$username2,_editDateTimeModal$sc;const{user,logout}=useAuth();const[stats,setStats]=useState(null);const[companies,setCompanies]=useState([]);const[locations,setLocations]=useState([]);const[providers,setProviders]=useState([]);const[cabinets,setCabinets]=useState([]);const[slotMachines,setSlotMachines]=useState([]);const[gameMixes,setGameMixes]=useState([]);const[invoices,setInvoices]=useState([]);const[onjnReports,setOnjnReports]=useState([]);const[legalDocuments,setLegalDocuments]=useState([]);const[metrology,setMetrology]=useState([]);const[jackpots,setJackpots]=useState([]);const[comisionDates,setComisionDates]=useState([]);const[showReportDetailsModal,setShowReportDetailsModal]=useState(false);const[selectedReportDetails,setSelectedReportDetails]=useState(null);const[users,setUsers]=useState([]);const[editingUser,setEditingUser]=useState(null);const[showUserForm,setShowUserForm]=useState(false);const[editingEntity,setEditingEntity]=useState(null);const[selectedItems,setSelectedItems]=useState([]);const[showEntityForm,setShowEntityForm]=useState(false);const[showBulkEditForm,setShowBulkEditForm]=useState(false);const[bulkEditType,setBulkEditType]=useState('');const[bulkEditData,setBulkEditData]=useState({});const[searchTerm,setSearchTerm]=useState('');const[entityType,setEntityType]=useState('');const[companiesLocations,setCompaniesLocations]=useState({companies:[],locations:[]});const[activeView,setActiveView]=useState(()=>{const savedView=localStorage.getItem('activeView');return savedView||'dashboard';});const[loading,setLoading]=useState(true);// Initialize theme from localStorage or default to 'light'\nconst[theme,setTheme]=useState(()=>{const savedTheme=localStorage.getItem('theme');return savedTheme||'light';});const[isSidebarCollapsed,setIsSidebarCollapsed]=useState(()=>{try{return localStorage.getItem('sidebarCollapsed')==='1';}catch(_unused){return false;}});const toggleSidebar=()=>{setIsSidebarCollapsed(prev=>{const next=!prev;try{localStorage.setItem('sidebarCollapsed',next?'1':'0');}catch(_unused2){}return next;});};// Click-to-filter states for slot machines table\nconst[selectedLocationFilter,setSelectedLocationFilter]=useState(null);const[selectedProviderFilter,setSelectedProviderFilter]=useState(null);const[selectedCabinetFilter,setSelectedCabinetFilter]=useState(null);const[selectedGameMixFilter,setSelectedGameMixFilter]=useState(null);const[selectedInvoiceFilter,setSelectedInvoiceFilter]=useState(null);const[selectedContractFilter,setSelectedContractFilter]=useState(null);const[selectedSerialFilter,setSelectedSerialFilter]=useState(null);const[selectedCompanyFilter,setSelectedCompanyFilter]=useState(null);const[selectedRTPFilter,setSelectedRTPFilter]=useState(null);const[selectedPlacesFilter,setSelectedPlacesFilter]=useState(null);const[selectedCvtDateFilter,setSelectedCvtDateFilter]=useState(null);// Multi-select cascade filter states for slot machines\nconst[selectedLocations,setSelectedLocations]=useState([]);const[selectedCabinets,setSelectedCabinets]=useState([]);const[selectedGameMixes,setSelectedGameMixes]=useState([]);const[selectedModels,setSelectedModels]=useState([]);const[selectedJackpotTypes,setSelectedJackpotTypes]=useState([]);// Dropdown visibility states for filters\nconst[showLocationFilterDropdown,setShowLocationFilterDropdown]=useState(false);const[showCabinetFilterDropdown,setShowCabinetFilterDropdown]=useState(false);const[showGameMixFilterDropdown,setShowGameMixFilterDropdown]=useState(false);const[showModelFilterDropdown,setShowModelFilterDropdown]=useState(false);const[showJackpotFilterDropdown,setShowJackpotFilterDropdown]=useState(false);// Provider avatar filter state\nconst[selectedProviderAvatarFilter,setSelectedProviderAvatarFilter]=useState(null);// Get filtered data for cascade filters\nconst getFilteredLocations=useMemo(()=>{let filtered=locations.filter(location=>location.status!=='inactive');// Filter by selected provider avatar\nif(selectedProviderAvatarFilter){filtered=filtered.filter(location=>slotMachines.some(slot=>slot.location_id===location.id&&slot.provider_id===selectedProviderAvatarFilter));}return filtered;},[locations,selectedProviderAvatarFilter,slotMachines]);const getFilteredCabinets=useMemo(()=>{let filtered=cabinets.filter(cabinet=>cabinet.status!=='inactive');// Filter by selected provider avatar\nif(selectedProviderAvatarFilter){filtered=filtered.filter(cabinet=>slotMachines.some(slot=>slot.cabinet_id===cabinet.id&&slot.provider_id===selectedProviderAvatarFilter));}// Filter by selected locations\nif(selectedLocations.length>0){filtered=filtered.filter(cabinet=>selectedLocations.some(locId=>slotMachines.some(slot=>slot.cabinet_id===cabinet.id&&slot.location_id===locId)));}// Filter by selected game mixes\nif(selectedGameMixes.length>0){filtered=filtered.filter(cabinet=>slotMachines.some(slot=>slot.cabinet_id===cabinet.id&&selectedGameMixes.includes(slot.game_mix_id)));}return filtered;},[cabinets,selectedProviderAvatarFilter,selectedLocations,selectedGameMixes,slotMachines]);const getFilteredGameMixes=useMemo(()=>{let filtered=gameMixes.filter(mix=>mix.status!=='inactive');// Filter by selected provider avatar\nif(selectedProviderAvatarFilter){filtered=filtered.filter(mix=>slotMachines.some(slot=>slot.game_mix_id===mix.id&&slot.provider_id===selectedProviderAvatarFilter));}// Filter by selected locations\nif(selectedLocations.length>0){filtered=filtered.filter(mix=>selectedLocations.some(locId=>slotMachines.some(slot=>slot.game_mix_id===mix.id&&slot.location_id===locId)));}// Filter by selected cabinets\nif(selectedCabinets.length>0){filtered=filtered.filter(mix=>selectedCabinets.some(cabinetId=>slotMachines.some(slot=>slot.game_mix_id===mix.id&&slot.cabinet_id===cabinetId)));}return filtered;},[gameMixes,selectedProviderAvatarFilter,selectedLocations,selectedCabinets,slotMachines]);const getFilteredModels=useMemo(()=>{let filtered=[...new Set(slotMachines.map(slot=>slot.model).filter(Boolean))];// Filter by selected provider avatar\nif(selectedProviderAvatarFilter){filtered=filtered.filter(model=>slotMachines.some(slot=>slot.model===model&&slot.provider_id===selectedProviderAvatarFilter));}// Filter by selected locations\nif(selectedLocations.length>0){filtered=filtered.filter(model=>slotMachines.some(slot=>slot.model===model&&selectedLocations.includes(slot.location_id)));}// Filter by selected cabinets\nif(selectedCabinets.length>0){filtered=filtered.filter(model=>slotMachines.some(slot=>slot.model===model&&selectedCabinets.includes(slot.cabinet_id)));}// Filter by selected game mixes\nif(selectedGameMixes.length>0){filtered=filtered.filter(model=>slotMachines.some(slot=>slot.model===model&&selectedGameMixes.includes(slot.game_mix_id)));}return filtered;},[selectedProviderAvatarFilter,selectedLocations,selectedCabinets,selectedGameMixes,slotMachines]);const getFilteredJackpots=useMemo(()=>{// Get only jackpot names from the separate jackpots array\nlet allJackpots=[...new Set(jackpots.map(jackpot=>jackpot.jackpot_name).filter(Boolean))];let filtered=[...new Set(allJackpots)];// Only apply complex filtering if we have active filters\nconst hasActiveFilters=selectedProviderAvatarFilter||selectedLocations.length>0||selectedCabinets.length>0||selectedGameMixes.length>0||selectedModels.length>0;if(!hasActiveFilters){return filtered;}// Create a map for faster slot lookup\nconst slotMap=new Map();slotMachines.forEach(slot=>{slotMap.set(slot.serial_number,slot);});// Filter by selected provider avatar\nif(selectedProviderAvatarFilter){filtered=filtered.filter(jackpot=>jackpots.some(jp=>{const slot=slotMap.get(jp.serial_number);return jp.jackpot_name===jackpot&&slot&&slot.provider_id===selectedProviderAvatarFilter;}));}// Filter by selected locations\nif(selectedLocations.length>0){filtered=filtered.filter(jackpot=>jackpots.some(jp=>{const slot=slotMap.get(jp.serial_number);return jp.jackpot_name===jackpot&&slot&&selectedLocations.includes(slot.location_id);}));}// Filter by selected cabinets\nif(selectedCabinets.length>0){filtered=filtered.filter(jackpot=>jackpots.some(jp=>{const slot=slotMap.get(jp.serial_number);return jp.jackpot_name===jackpot&&slot&&selectedCabinets.includes(slot.cabinet_id);}));}// Filter by selected game mixes\nif(selectedGameMixes.length>0){filtered=filtered.filter(jackpot=>jackpots.some(jp=>{const slot=slotMap.get(jp.serial_number);return jp.jackpot_name===jackpot&&slot&&selectedGameMixes.includes(slot.game_mix_id);}));}// Filter by selected models\nif(selectedModels.length>0){filtered=filtered.filter(jackpot=>jackpots.some(jp=>{const slot=slotMap.get(jp.serial_number);return jp.jackpot_name===jackpot&&slot&&selectedModels.includes(slot.model);}));}return filtered;},[selectedProviderAvatarFilter,selectedLocations,selectedCabinets,selectedGameMixes,selectedModels,slotMachines,jackpots]);// Multi-select filter handlers\nconst handleLocationToggle=locationId=>{setSelectedLocations(prev=>prev.includes(locationId)?prev.filter(id=>id!==locationId):[...prev,locationId]);// Clear dependent filters\nsetSelectedCabinets([]);setSelectedGameMixes([]);setSelectedModels([]);};const handleCabinetToggle=cabinetId=>{setSelectedCabinets(prev=>prev.includes(cabinetId)?prev.filter(id=>id!==cabinetId):[...prev,cabinetId]);// Clear dependent filters\nsetSelectedGameMixes([]);setSelectedModels([]);};const handleGameMixToggle=gameMixId=>{setSelectedGameMixes(prev=>prev.includes(gameMixId)?prev.filter(id=>id!==gameMixId):[...prev,gameMixId]);// Clear dependent filters\nsetSelectedModels([]);};const handleModelToggle=model=>{setSelectedModels(prev=>prev.includes(model)?prev.filter(m=>m!==model):[...prev,model]);};const handleJackpotToggle=jackpot=>{setSelectedJackpotTypes(prev=>prev.includes(jackpot)?prev.filter(j=>j!==jackpot):[...prev,jackpot]);};const clearAllFilters=()=>{setSelectedLocations([]);setSelectedCabinets([]);setSelectedGameMixes([]);setSelectedModels([]);setSelectedJackpotTypes([]);};// Close dropdowns when clicking outside\nuseEffect(()=>{const handleClickOutside=event=>{if(!event.target.closest('.filter-dropdown-container')){setShowLocationFilterDropdown(false);setShowCabinetFilterDropdown(false);setShowGameMixFilterDropdown(false);setShowModelFilterDropdown(false);setShowJackpotFilterDropdown(false);}};document.addEventListener('mousedown',handleClickOutside);return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[]);// Invoice popup state\nconst[showInvoicePopup,setShowInvoicePopup]=useState(false);const[selectedInvoice,setSelectedInvoice]=useState(null);const[showAddCvtDatePopup,setShowAddCvtDatePopup]=useState(false);// Jackpot popup state\nconst[selectedJackpots,setSelectedJackpots]=useState(null);// Invoice slots popup state\nconst[selectedInvoiceSlots,setSelectedInvoiceSlots]=useState(null);// Slot attachments modal state\nconst[showSlotAttachmentsModal,setShowSlotAttachmentsModal]=useState(false);const[selectedSlotId,setSelectedSlotId]=useState(null);const[showEntityAttachmentsModal,setShowEntityAttachmentsModal]=useState(false);const[selectedEntityType,setSelectedEntityType]=useState(null);const[selectedEntityId,setSelectedEntityId]=useState(null);// Change history modal state\nconst[showChangeHistoryModal,setShowChangeHistoryModal]=useState(false);const[changeHistoryData,setChangeHistoryData]=useState([]);const[selectedHistoryEntityType,setSelectedHistoryEntityType]=useState('');const[selectedHistoryEntityId,setSelectedHistoryEntityId]=useState('');// All modifications history modal state\nconst[showAllModificationsModal,setShowAllModificationsModal]=useState(false);const[allModificationsData,setAllModificationsData]=useState([]);const[selectedAllModificationsEntityType,setSelectedAllModificationsEntityType]=useState('');const[selectedAllModificationsEntityId,setSelectedAllModificationsEntityId]=useState('');// CVT attachments modal state\nconst[showCvtAttachments,setShowCvtAttachments]=useState(false);const[selectedCvtForAttachments,setSelectedCvtForAttachments]=useState(null);// Marketing module state\nconst[marketingCampaigns,setMarketingCampaigns]=useState([]);const[showMarketingForm,setShowMarketingForm]=useState(false);const emptyMarketingForm={type:'promotion',name:'',description:'',locations:[],start_at:'',end_at:'',payouts:[]// {date:'', location_id:'', amount:''}\n};const[marketingForm,setMarketingForm]=useState(emptyMarketingForm);const[savingMarketing,setSavingMarketing]=useState(false);const fetchMarketingCampaigns=async()=>{try{const headers={Authorization:\"Bearer \".concat(localStorage.getItem('token'))};const res=await fetch(\"\".concat(API,\"/marketing/campaigns\"),{headers});if(res.ok){const data=await res.json();setMarketingCampaigns(data);}}catch(e){console.error('Failed to load marketing campaigns',e);}};useEffect(()=>{if(activeView==='marketing'){fetchMarketingCampaigns();}},[activeView]);// Bulk delete confirmation modal state\nconst[showBulkDeleteConfirm,setShowBulkDeleteConfirm]=useState(false);const[bulkDeleteType,setBulkDeleteType]=useState('');// Individual delete confirmation modal state\nconst[showDeleteConfirm,setShowDeleteConfirm]=useState(false);const[fileToDelete,setFileToDelete]=useState(null);// Metrology popup state\nconst[selectedMetrology,setSelectedMetrology]=useState(null);// Metrology search state\nconst[metrologySearchTerm,setMetrologySearchTerm]=useState('');// Commission Date Details Page state\nconst[showCommissionDateDetailsPage,setShowCommissionDateDetailsPage]=useState(false);const[selectedCommissionDate,setSelectedCommissionDate]=useState(null);const[showJackpotDetailsPage,setShowJackpotDetailsPage]=useState(false);const[selectedJackpot,setSelectedJackpot]=useState(null);const[showMetrologyDetailsPage,setShowMetrologyDetailsPage]=useState(false);const[showInvoiceDetailsPage,setShowInvoiceDetailsPage]=useState(false);const[showLocationDetailsPage,setShowLocationDetailsPage]=useState(false);const[selectedLocation,setSelectedLocation]=useState(null);// Provider Details Page state\nconst[showProviderDetailsPage,setShowProviderDetailsPage]=useState(false);const[selectedProvider,setSelectedProvider]=useState(null);// Cabinet Details Page state\nconst[showCabinetDetailsPage,setShowCabinetDetailsPage]=useState(false);const[selectedCabinet,setSelectedCabinet]=useState(null);// Slots Details Page state (for filtered results)\nconst[showSlotsDetailsPage,setShowSlotsDetailsPage]=useState(false);const[selectedSlotsForDetails,setSelectedSlotsForDetails]=useState([]);const[selectedSlotsFilterType,setSelectedSlotsFilterType]=useState('');const[selectedSlotsFilterValue,setSelectedSlotsFilterValue]=useState('');const[showHistoryChangesPage,setShowHistoryChangesPage]=useState(false);const handleCloseHistoryChanges=useCallback(()=>setShowHistoryChangesPage(false),[]);// Notification system state\nconst[showNotification,setShowNotification]=useState(false);const[notificationMessage,setNotificationMessage]=useState('');const[notificationType,setNotificationType]=useState('success');// 'success', 'error', 'warning', 'info'\n// Scheduled changes and history state\nconst[scheduledChanges,setScheduledChanges]=useState(()=>{const saved=localStorage.getItem('scheduledChanges');return saved?JSON.parse(saved):[];});const[changeHistory,setChangeHistory]=useState(()=>{const saved=localStorage.getItem('changeHistory');return saved?JSON.parse(saved):[];});const[showScheduledChangesModal,setShowScheduledChangesModal]=useState(false);const[showHistoryModal,setShowHistoryModal]=useState(false);const[showScheduledChangeForSlot,setShowScheduledChangeForSlot]=useState(null);const[showBulkStatusConfirm,setShowBulkStatusConfirm]=useState(false);const[bulkStatusData,setBulkStatusData]=useState(null);// Game Mix Games Page state\nconst[showGameMixGamesPage,setShowGameMixGamesPage]=useState(false);const[selectedGameMix,setSelectedGameMix]=useState(null);// Games Page state\nconst[showGameDetailsPage,setShowGameDetailsPage]=useState(false);const[selectedGameForDetails,setSelectedGameForDetails]=useState(null);const[gameAvatars,setGameAvatars]=useState({});const[gamesData,setGamesData]=useState({});// Game Mix Details Page state\nconst[showGameMixDetailsPage,setShowGameMixDetailsPage]=useState(false);const[selectedGameMixForDetails,setSelectedGameMixForDetails]=useState(null);const[gamesViewMode,setGamesViewMode]=useState('grid');// Game Table Page state\nconst[showGameTablePage,setShowGameTablePage]=useState(false);// Schedule change modal states\nconst[showScheduleChangeModal,setShowScheduleChangeModal]=useState(false);const[scheduleChangeData,setScheduleChangeData]=useState(null);// Cancel confirmation modal states\nconst[showCancelConfirmation,setShowCancelConfirmation]=useState(false);const[cancelConfirmationData,setCancelConfirmationData]=useState(null);const[confirmModalData,setConfirmModalData]=useState({isOpen:false,title:'',message:'',onConfirm:null,onCancel:null});const[editDateTimeModal,setEditDateTimeModal]=useState({isOpen:false,scheduledChange:null,newDateTime:'',onSave:null,onCancel:null});// Timer state for countdown display\nconst[timerTick,setTimerTick]=useState(Date.now());// Breadcrumb navigation state\nconst[breadcrumbPath,setBreadcrumbPath]=useState([]);// User avatar hook\nconst{avatar}=useAvatar('users',user===null||user===void 0?void 0:user.id);// Save theme preference to localStorage whenever it changes\nuseEffect(()=>{localStorage.setItem('theme',theme);},[theme]);// Save active view to localStorage whenever it changes\nuseEffect(()=>{localStorage.setItem('activeView',activeView);},[activeView]);// Save scheduled changes and history to localStorage\nuseEffect(()=>{localStorage.setItem('scheduledChanges',JSON.stringify(scheduledChanges));},[scheduledChanges]);useEffect(()=>{localStorage.setItem('changeHistory',JSON.stringify(changeHistory));},[changeHistory]);// Breadcrumb navigation functions\nconst addBreadcrumb=(label,icon,action)=>{setBreadcrumbPath(prev=>[...prev,{label,icon,action}]);};const removeBreadcrumb=index=>{setBreadcrumbPath(prev=>prev.slice(0,index+1));};const clearBreadcrumb=()=>{setBreadcrumbPath([]);};const navigateToBreadcrumb=index=>{if(index===-1){// Home button clicked - clear breadcrumb and go back to the main page\nsetBreadcrumbPath([]);// Close all detail pages when navigating to Home\nsetShowGameMixDetailsPage(false);setShowGameDetailsPage(false);setShowGameMixGamesPage(false);setShowLocationDetailsPage(false);setShowProviderDetailsPage(false);setShowCabinetDetailsPage(false);setShowInvoiceDetailsPage(false);setShowJackpotDetailsPage(false);setShowMetrologyDetailsPage(false);setShowCommissionDateDetailsPage(false);// Don't change activeView - stay on the current main page (games, gamemixes, etc.)\nreturn;}const targetPath=breadcrumbPath.slice(0,index);const targetBreadcrumb=targetPath[targetPath.length-1];// Update breadcrumb path first\nsetBreadcrumbPath(targetPath);// Execute the action for the target breadcrumb\nif(targetBreadcrumb&&targetBreadcrumb.action){targetBreadcrumb.action();}};// Custom notification function\nconst showCustomNotification=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'success';setNotificationMessage(message);setNotificationType(type);setShowNotification(true);setTimeout(()=>{setShowNotification(false);},4000);};const handleCancelScheduledChanges=()=>{if(cancelConfirmationData){const{slotId,changesCount}=cancelConfirmationData;// Șterge modificările programate pentru acest slot\nsetScheduledChanges(prev=>prev.filter(change=>!(change.entityType==='slots'&&change.itemId===slotId)));showCustomNotification(\"\".concat(changesCount,\" scheduled changes cancelled\"),'success');setShowCancelConfirmation(false);setCancelConfirmationData(null);setShowScheduledChangeForSlot(null);}};const handleEditScheduledDateTime=scheduledChange=>{// Use the scheduled date/time (future date) instead of current date/time\nconst scheduledDateTime=new Date(scheduledChange.scheduledDateTime);const formattedDateTime=scheduledDateTime.toISOString().slice(0,16);// YYYY-MM-DDTHH:MM\nsetEditDateTimeModal({isOpen:true,scheduledChange:scheduledChange,newDateTime:formattedDateTime,onSave:newDateTime=>{// Update the scheduled change with new date/time\nsetScheduledChanges(prev=>prev.map(change=>change.id===scheduledChange.id?_objectSpread(_objectSpread({},change),{},{scheduledDateTime:newDateTime}):change));// Close both modals\nsetEditDateTimeModal({isOpen:false,scheduledChange:null,newDateTime:'',onSave:null,onCancel:null});setShowScheduledChangeForSlot(null);showCustomNotification('Scheduled date/time updated successfully','success');},onCancel:()=>{setEditDateTimeModal({isOpen:false,scheduledChange:null,newDateTime:'',onSave:null,onCancel:null});}});};const handleScheduledChange=async(entityType,itemId,action,oldValue,newValue,scheduledDateTime)=>{try{console.log('Scheduling change:',{entityType,itemId,action,oldValue,newValue,scheduledDateTime});const change={id:Date.now()+Math.random(),entityType,itemId,action,oldValue,newValue,scheduledDateTime,timestamp:new Date().toISOString(),userName:(user===null||user===void 0?void 0:user.username)||'Unknown User'};setScheduledChanges(prev=>[...prev,change]);// Save to backend change history\ntry{const changeHistoryData={entity_type:entityType,entity_id:itemId,field_name:action,old_value:oldValue||'',new_value:newValue||'',scheduled_datetime:scheduledDateTime};await fetch(\"\".concat(API,\"/change-history\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify(changeHistoryData)});}catch(error){console.error('Error saving change history to backend:',error);}const timeUntilExecution=new Date(scheduledDateTime).getTime()-Date.now();const minutes=Math.floor(timeUntilExecution/(1000*60));const seconds=Math.floor(timeUntilExecution%(1000*60)/1000);showCustomNotification(\"Change scheduled successfully. Will execute in \".concat(minutes,\":\").concat(seconds.toString().padStart(2,'0')),'success');}catch(error){console.error('Error scheduling change:',error);showCustomNotification('Error scheduling change','error');}};useEffect(()=>{if(user){// Încarcă datele imediat în background\nfetchDashboardData();loadChangeHistoryCount('slots');fetchGamesData(false);// Don't force refresh on user change\n}},[user]);// Timer tick effect for scheduled changes\nuseEffect(()=>{if(showHistoryChangesPage){// Pause schedule executor while All History Changes is open to avoid flicker\nreturn;}const timerTick=()=>{const now=Date.now();const expiredChanges=scheduledChanges.filter(change=>new Date(change.scheduledDateTime).getTime()<=now);if(expiredChanges.length>0){console.log('Applying expired scheduled changes:',expiredChanges);expiredChanges.forEach(async change=>{// Apply the change\nconsole.log('Applying change:',change);try{// Apply changes to backend based on entity type\nif(change.entityType==='slots'){const token=localStorage.getItem('token');const headers={'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'};// Get current slot data\nconst currentSlot=slotMachines.find(slot=>slot.id===change.itemId);if(!currentSlot){console.error('Slot not found:',change.itemId);return;}// Prepare updated data based on changes\nconst updatedData=_objectSpread({},currentSlot);if(change.changes){// Apply comprehensive changes\nif(change.changes.status){updatedData.status=change.changes.status.new;}if(change.changes.provider_id){updatedData.provider_id=change.changes.provider_id.new;}if(change.changes.game_mix_id){updatedData.game_mix_id=change.changes.game_mix_id.new;}if(change.changes.cabinet_id){updatedData.cabinet_id=change.changes.cabinet_id.new;}if(change.changes.model){updatedData.model=change.changes.model.new;}if(change.changes.location_id){updatedData.location_id=change.changes.location_id.new;}}else{// Fallback for old format\nif(change.action==='status_change'){updatedData.status=change.newValue;}}// Update slot in backend\nconst response=await fetch(\"\".concat(API,\"/slot-machines/\").concat(change.itemId),{method:'PUT',headers,body:JSON.stringify(updatedData)});if(!response.ok){throw new Error(\"Failed to update slot: \".concat(response.statusText));}// Refresh data after successful update\nawait fetchDashboardData();console.log('Slot updated successfully:',change.itemId);}// Add to history\nconst historyEntry={id:Date.now()+Math.random(),entityType:change.entityType,itemId:change.itemId,action:change.action,oldValue:change.oldValue,newValue:change.newValue,timestamp:new Date().toISOString(),executed:true,reason:'Scheduled change executed',userName:change.userName||(user===null||user===void 0?void 0:user.username)||'Unknown User'};setChangeHistory(prev=>[historyEntry,...prev]);// Save to backend change history\ntry{const changeHistoryData={entity_type:change.entityType,entity_id:change.itemId,field_name:change.action,old_value:change.oldValue||'',new_value:change.newValue||'',scheduled_datetime:change.scheduledDateTime};await fetch(\"\".concat(API,\"/change-history\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify(changeHistoryData)});}catch(error){console.error('Error saving change history to backend:',error);}}catch(error){console.error('Error applying scheduled change:',error);showCustomNotification(\"Error applying scheduled change: \".concat(error.message),'error');}});// Remove expired changes from scheduled changes\nsetScheduledChanges(prev=>prev.filter(change=>new Date(change.scheduledDateTime).getTime()>now));showCustomNotification(\"\".concat(expiredChanges.length,\" scheduled changes have been applied\"),'success');}};const interval=setInterval(timerTick,1000);return()=>clearInterval(interval);},[scheduledChanges,showHistoryChangesPage]);// Timer tick for countdown display updates\nuseEffect(()=>{if(showHistoryChangesPage){// Pause the visual countdown ticker to stop re-renders while page is open\nreturn;}const interval=setInterval(()=>setTimerTick(Date.now()),1000);return()=>clearInterval(interval);},[showHistoryChangesPage]);// Initialize timer state and clean up expired changes on mount\nuseEffect(()=>{const now=Date.now();const validChanges=scheduledChanges.filter(change=>new Date(change.scheduledDateTime).getTime()>now);if(validChanges.length!==scheduledChanges.length){setScheduledChanges(validChanges);}},[]);const fetchDashboardData=async()=>{try{var _comisionDatesData$;const token=localStorage.getItem('token');const headers={Authorization:\"Bearer \".concat(token)};const[statsRes,companiesRes,locationsRes,providersRes,cabinetsRes,slotMachinesRes,gameMixesRes,invoicesRes,onjnRes,legalRes,metrologyRes,jackpotsRes,comisionDatesRes,usersRes,adminDataRes]=await Promise.all([fetch(\"\".concat(API,\"/dashboard/stats\"),{headers}),fetch(\"\".concat(API,\"/companies\"),{headers}),fetch(\"\".concat(API,\"/locations\"),{headers}),fetch(\"\".concat(API,\"/providers\"),{headers}),fetch(\"\".concat(API,\"/cabinets\"),{headers}),fetch(\"\".concat(API,\"/slot-machines\"),{headers}),fetch(\"\".concat(API,\"/game-mixes\"),{headers}),fetch(\"\".concat(API,\"/invoices\"),{headers}),fetch(\"\".concat(API,\"/onjn-reports\"),{headers}),fetch(\"\".concat(API,\"/legal-documents\"),{headers}),fetch(\"\".concat(API,\"/metrology\"),{headers}),fetch(\"\".concat(API,\"/jackpots\"),{headers}),fetch(\"\".concat(API,\"/comision-dates\"),{headers}),fetch(\"\".concat(API,\"/users\"),{headers}),(user===null||user===void 0?void 0:user.role)==='admin'?fetch(\"\".concat(API,\"/admin/companies-locations\"),{headers}):Promise.resolve({json:()=>({companies:[],locations:[]})})]);// Handle responses that might return errors for non-admin users\nconst[statsData,companiesData,locationsData,providersData,cabinetsData,slotMachinesData,gameMixesData,invoicesData,onjnData,legalData,metrologyData,jackpotsData,comisionDatesData,usersData,adminData]=await Promise.all([statsRes.json(),companiesRes.json(),locationsRes.json(),providersRes.json(),cabinetsRes.json(),slotMachinesRes.json(),gameMixesRes.json(),invoicesRes.json(),onjnRes.json(),legalRes.json(),metrologyRes.json(),jackpotsRes.json(),comisionDatesRes.json(),usersRes.ok?usersRes.json():[],// Return empty array if users endpoint fails\nadminDataRes.ok?adminDataRes.json():{companies:[],locations:[]}]);setStats(statsData);setCompanies(companiesData);setLocations(locationsData);setProviders(providersData);setCabinets(cabinetsData);// Populate jackpot data for slot machines\nconst slotMachinesWithJackpots=slotMachinesData.map(slot=>{const associatedJackpots=jackpotsData.filter(jp=>jp.serial_number===slot.serial_number);if(associatedJackpots.length>0){if(associatedJackpots.length===1){slot.jackpot_name=associatedJackpots[0].jackpot_name;slot.jackpot_type=associatedJackpots[0].jackpot_type;}else{slot.jackpot_name='Multiple Jackpots';slot.jackpot_type='Multiple Types';}}return slot;});setSlotMachines(slotMachinesWithJackpots);setGameMixes(gameMixesData);setInvoices(invoicesData);setOnjnReports(onjnData);setLegalDocuments(legalData);setMetrology(metrologyData);setJackpots(jackpotsData);setComisionDates(comisionDatesData);console.log('📊 Updated comisionDates:',comisionDatesData.length,'items');console.log('📊 comisionDatesData:',comisionDatesData);console.log('📊 First comision date event_name:',(_comisionDatesData$=comisionDatesData[0])===null||_comisionDatesData$===void 0?void 0:_comisionDatesData$.event_name);setUsers(usersData);setCompaniesLocations(adminData);}catch(error){console.error('Error fetching dashboard data:',error);}finally{setLoading(false);}};const fetchGamesData=async function(){let forceRefresh=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;try{// Don't reload if data already exists and force refresh is not requested\nif(!forceRefresh&&gamesData&&gamesData.gamesDatabase&&gamesData.gamesDatabase.length>0){console.log('🎮 Games data already loaded, skipping reload');return;}console.log('🎮 Fetching games data from Google Sheets API...');// Fetch games from backend API (which gets data from Google Sheets)\nconst response=await fetch(\"\".concat(API,\"/games\"),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token')),'Content-Type':'application/json'}});if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();const gamesDatabase=data.games||[];console.log('🎮 Successfully fetched',gamesDatabase.length,'games from Google Sheets');// Create ultra-simple game name matching function\nconst findGameBySmartMatching=gameName=>{if(!gameName)return null;const normalizedGameName=gameName.toLowerCase().trim();console.log(\"\\uD83D\\uDD0D Ultra-simple matching for: \\\"\".concat(gameName,\"\\\" (normalized: \\\"\").concat(normalizedGameName,\"\\\")\"));// First: Exact match by game name only\nlet game=gamesDatabase.find(g=>g.game_name.toLowerCase()===normalizedGameName);if(game){console.log(\"\\u2705 Exact match found: \\\"\".concat(game.game_name,\"\\\"\"));return game;}// Second: Simple contains match (game name contains search term)\ngame=gamesDatabase.find(g=>g.game_name.toLowerCase().includes(normalizedGameName));if(game){console.log(\"\\u2705 Contains match found: \\\"\".concat(game.game_name,\"\\\"\"));return game;}// Third: Game name is in search term\ngame=gamesDatabase.find(g=>normalizedGameName.includes(g.game_name.toLowerCase()));if(game){console.log(\"\\u2705 Reverse contains match found: \\\"\".concat(game.game_name,\"\\\"\"));return game;}console.log(\"\\u274C No match found for: \\\"\".concat(gameName,\"\\\"\"));return null;};// Create games map with smart matching\nconst gamesMap={};gamesDatabase.forEach(game=>{// Add main game name only\ngamesMap[game.game_name]=game;});// Store both the map and the smart matching function\nsetGamesData({gamesMap:gamesMap,findGameBySmartMatching:findGameBySmartMatching,gamesDatabase:gamesDatabase});console.log('🎮 Loaded games data:',gamesDatabase.length,'games');console.log('🎯 Available games:',Object.keys(gamesMap));console.log('🧠 Smart matching system activated!');}catch(error){console.error('Error fetching games data:',error);// Fallback to empty data if API fails\nsetGamesData({gamesMap:{},findGameBySmartMatching:()=>null,gamesDatabase:[]});}};const handleSlotStatusChange=async(slot,newStatus)=>{if(slot.status===newStatus)return;// If setting to inactive, show confirmation dialog\nif(newStatus==='inactive'){setConfirmModalData({isOpen:true,title:'⚠️ WARNING!',message:\"Slot \\\"\".concat(slot.serial_number,\"\\\" will be set as INACTIVE.\\n\\nThis slot will disappear from the Slot Machines list and will be moved to Warehouse.\\n\\nDo you want to continue?\"),onConfirm:()=>{setConfirmModalData({isOpen:false,title:'',message:'',onConfirm:null,onCancel:null});handleStatusChange(slot,'inactive');},onCancel:()=>{setConfirmModalData({isOpen:false,title:'',message:'',onConfirm:null,onCancel:null});}});return;}// For active status, proceed directly\nawait handleStatusChange(slot,newStatus);};const handleStatusChange=async(slot,newStatus)=>{try{const token=localStorage.getItem('token');// Create a simple update object with only the necessary fields\nconst updateData={cabinet_id:slot.cabinet_id,game_mix_id:slot.game_mix_id,provider_id:slot.provider_id,model:slot.model,serial_number:slot.serial_number,denomination:slot.denomination,max_bet:slot.max_bet,rtp:slot.rtp,gaming_places:slot.gaming_places,commission_date:slot.commission_date,invoice_number:slot.invoice_number,status:newStatus};const response=await fetch(\"\".concat(API,\"/slot-machines/\").concat(slot.id),{method:'PUT',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify(updateData)});if(response.ok){// Force refresh all data\nawait fetchDashboardData();// Show success message with specific info for inactive status\nif(newStatus==='inactive'){showCustomNotification(\"\\u2705 Slot \\\"\".concat(slot.serial_number,\"\\\" set as INACTIVE and moved to Warehouse!\"),'success');}else{const statusText=newStatus==='active'?'active':'inactive';showCustomNotification(\"\\u2705 Slot status updated successfully to: \".concat(statusText),'success');}}else{const errorData=await response.json();showCustomNotification(\"Update error: \".concat(errorData.detail||'Unknown error'),'error');}}catch(error){showCustomNotification('Connection error: '+error.message,'error');}};// Funcția handleMetrologyDateChange pentru editarea datelor CVT\n// Navigation items with permission checks\nconst navigationItems=user?[{id:'dashboard',label:'Dashboard',icon:'📊'},...(user!==null&&user!==void 0&&(_user$permissions3=user.permissions)!==null&&_user$permissions3!==void 0&&(_user$permissions3$mo=_user$permissions3.modules)!==null&&_user$permissions3$mo!==void 0&&_user$permissions3$mo.companies?[{id:'companies',label:'Companies',icon:'🏢',count:companies.length}]:[]),...(user!==null&&user!==void 0&&(_user$permissions4=user.permissions)!==null&&_user$permissions4!==void 0&&(_user$permissions4$mo=_user$permissions4.modules)!==null&&_user$permissions4$mo!==void 0&&_user$permissions4$mo.locations?[{id:'locations',label:'Locations',icon:'📍',count:locations.length}]:[]),...(user!==null&&user!==void 0&&(_user$permissions5=user.permissions)!==null&&_user$permissions5!==void 0&&(_user$permissions5$mo=_user$permissions5.modules)!==null&&_user$permissions5$mo!==void 0&&_user$permissions5$mo.providers?[{id:'providers',label:'Providers',icon:'🎮',count:providers.length}]:[]),...(user!==null&&user!==void 0&&(_user$permissions6=user.permissions)!==null&&_user$permissions6!==void 0&&(_user$permissions6$mo=_user$permissions6.modules)!==null&&_user$permissions6$mo!==void 0&&_user$permissions6$mo.cabinets?[{id:'cabinets',label:'Cabinets',icon:'🎰',count:cabinets.length}]:[]),...(user!==null&&user!==void 0&&(_user$permissions7=user.permissions)!==null&&_user$permissions7!==void 0&&(_user$permissions7$mo=_user$permissions7.modules)!==null&&_user$permissions7$mo!==void 0&&_user$permissions7$mo.game_mixes?[{id:'gamemixes',label:'Game Mixes',icon:'🎲',count:gameMixes.length}]:[]),{id:'games',label:'Games',icon:'🎮',count:(()=>{const uniqueGames=new Set();gameMixes.forEach(mix=>{if(mix.games){if(Array.isArray(mix.games)){mix.games.forEach(game=>uniqueGames.add(game.trim()));}else if(typeof mix.games==='string'){mix.games.split(',').forEach(game=>uniqueGames.add(game.trim()));}}});return uniqueGames.size;})()},...(user!==null&&user!==void 0&&(_user$permissions8=user.permissions)!==null&&_user$permissions8!==void 0&&(_user$permissions8$mo=_user$permissions8.modules)!==null&&_user$permissions8$mo!==void 0&&_user$permissions8$mo.slot_machines?[{id:'slots',label:'Slots',icon:'🍒',count:slotMachines.filter(s=>s.status!=='inactive').length}]:[]),...(user!==null&&user!==void 0&&(_user$permissions9=user.permissions)!==null&&_user$permissions9!==void 0&&(_user$permissions9$mo=_user$permissions9.modules)!==null&&_user$permissions9$mo!==void 0&&_user$permissions9$mo.slot_machines?[{id:'warehouse',label:'Warehouse',icon:'📦',count:slotMachines.filter(s=>s.status==='inactive').length}]:[]),...(user!==null&&user!==void 0&&(_user$permissions0=user.permissions)!==null&&_user$permissions0!==void 0&&(_user$permissions0$mo=_user$permissions0.modules)!==null&&_user$permissions0$mo!==void 0&&_user$permissions0$mo.metrology?[{id:'metrology2',label:'Metrology CVT',icon:'🔬',count:metrology.length}]:[]),...(user!==null&&user!==void 0&&(_user$permissions1=user.permissions)!==null&&_user$permissions1!==void 0&&(_user$permissions1$mo=_user$permissions1.modules)!==null&&_user$permissions1$mo!==void 0&&_user$permissions1$mo.jackpots?[{id:'jackpots',label:'Jackpots',icon:'🎰',count:jackpots.length}]:[]),{id:'marketing',label:'Marketing',icon:'📣',count:marketingCampaigns.length},...(user!==null&&user!==void 0&&(_user$permissions10=user.permissions)!==null&&_user$permissions10!==void 0&&(_user$permissions10$m=_user$permissions10.modules)!==null&&_user$permissions10$m!==void 0&&_user$permissions10$m.invoices?[{id:'invoices',label:'Invoices',icon:'💰',count:invoices.length}]:[]),...(user!==null&&user!==void 0&&(_user$permissions11=user.permissions)!==null&&_user$permissions11!==void 0&&(_user$permissions11$m=_user$permissions11.modules)!==null&&_user$permissions11$m!==void 0&&_user$permissions11$m.onjn_reports?[{id:'onjn',label:'ONJN Reports',icon:'📋',count:onjnReports.length+comisionDates.length}]:[]),...(user!==null&&user!==void 0&&(_user$permissions12=user.permissions)!==null&&_user$permissions12!==void 0&&(_user$permissions12$m=_user$permissions12.modules)!==null&&_user$permissions12$m!==void 0&&_user$permissions12$m.legal_documents?[{id:'legal',label:'Legal Documents',icon:'📄',count:legalDocuments.length}]:[]),...((user===null||user===void 0?void 0:user.role)==='admin'?[{id:'users',label:'Users',icon:'👥',count:users.length}]:[])]:[];const handleEditUser=userData=>{setEditingUser(userData);setShowUserForm(true);};const handleCloseUserForm=()=>{setEditingUser(null);setShowUserForm(false);};const handleSaveUser=async userData=>{try{console.log('👤 Saving user data:',userData);console.log('📞 Phone field:',userData.phone);const token=localStorage.getItem('token');const method=editingUser?'PUT':'POST';const url=editingUser?\"\".concat(API,\"/users/\").concat(editingUser.id):\"\".concat(API,\"/users\");console.log('🌐 URL:',url);console.log('📋 Method:',method);const response=await fetch(url,{method,headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify(userData)});if(response.ok){const responseData=await response.json();console.log('✅ Server response:',responseData);console.log('📞 Phone in response:',responseData.phone);await fetchDashboardData();// Refresh data\nhandleCloseUserForm();showCustomNotification('✅ User saved successfully!','success');}else{const errorData=await response.json();console.error('❌ Server error:',errorData);showCustomNotification(\"\\u274C Failed to save user: \".concat(errorData.detail||'Unknown error'),'error');console.error('Failed to save user');}}catch(error){showCustomNotification(\"\\u274C Error saving user: \".concat(error.message),'error');console.error('Error saving user:',error);}};// Generic entity handlers\nconst handleAddEntity=type=>{setEntityType(type);setEditingEntity(null);setShowEntityForm(true);};const handleEditEntity=(entityData,type)=>{setEntityType(type);setEditingEntity(entityData);setShowEntityForm(true);};const handleCloseEntityForm=()=>{setEditingEntity(null);setShowEntityForm(false);setEntityType('');};const handleSaveEntity=async entityData=>{try{// Debug: Log the data being saved for slots\nif(entityType==='slots'){console.log('🎰 Saving slot machine data:',entityData);console.log('🔍 Fields present:',Object.keys(entityData));console.log('📋 Production year:',entityData.production_year);console.log('📍 Location ID:',entityData.location_id);console.log('🏠 Ownership type:',entityData.ownership_type);}// Debug: Log the data being saved for locations\nif(entityType==='locations'){console.log('📍 Saving location data:',entityData);console.log('🔍 Fields present:',Object.keys(entityData));console.log('👤 Contact person:',entityData.contact_person);console.log('📧 Contact email:',entityData.contact_email);console.log('📞 Contact phone:',entityData.contact_phone);console.log('🆔 Contact person ID:',entityData.contact_person_id);console.log('📝 Contact person type:',entityData.contact_person_type);}// Debug: Log the data being saved for invoices\nif(entityType==='invoices'){console.log('🧾 Saving invoice data:',entityData);console.log('🔍 Fields present:',Object.keys(entityData));console.log('📊 Status:',entityData.status);console.log('💰 Amount:',entityData.amount);console.log('📅 Issue date:',entityData.issue_date);console.log('📅 Due date:',entityData.due_date);console.log('🏢 Buyer ID:',entityData.buyer_id);console.log('🏪 Seller ID:',entityData.seller_id);console.log('📍 Location ID:',entityData.location_id);console.log('🔄 Transaction Type:',entityData.transaction_type);console.log('🔄 Transaction Type (raw):',entityData.transaction_type);console.log('🔄 All invoice fields:',JSON.stringify(entityData,null,2));}// Debug: Log the data being saved for jackpots\nif(entityType==='jackpots'){console.log('🎰 Saving jackpot data:',entityData);console.log('🔍 Fields present:',Object.keys(entityData));console.log('🔢 Serial number:',entityData.serial_number);console.log('🏷️ Jackpot name:',entityData.jackpot_name);console.log('📊 Jackpot type:',entityData.jackpot_type);console.log('📊 Increment rate:',entityData.increment_rate);console.log('📝 Description:',entityData.description);}// Debug: Log the data being saved for comision_date\nif(entityType==='comision_date'){console.log('📅 Saving comision date data:',entityData);console.log('🔍 Fields present:',Object.keys(entityData));console.log('📝 Event name:',entityData.event_name);console.log('📅 Commission date:',entityData.commission_date);console.log('🔢 Serial numbers:',entityData.serial_numbers);}const token=localStorage.getItem('token');const method=editingEntity?'PUT':'POST';const endpoint=getEntityEndpoint(entityType);const url=editingEntity?\"\".concat(API,\"/\").concat(endpoint,\"/\").concat(editingEntity.id||editingEntity._id):\"\".concat(API,\"/\").concat(endpoint);console.log('🌐 API URL:',url);console.log('📤 Request body:',JSON.stringify(entityData,null,2));const response=await fetch(url,{method,headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify(entityData)});console.log('📡 Response status:',response.status);if(response.ok){const responseData=await response.json();console.log('✅ Save successful, response data:',responseData);// Force refresh data with cache busting\nawait fetchDashboardData();// Refresh data\nconsole.log('🔄 Data refreshed after save');// Force re-render by updating state\nif(entityType==='comision_date'){console.log('🔄 Forcing comision dates refresh...');// Force a small delay to ensure backend has processed the update\nsetTimeout(async()=>{try{const token=localStorage.getItem('token');const response=await fetch(\"\".concat(API,\"/comision-dates\"),{headers:{'Authorization':\"Bearer \".concat(token),'Cache-Control':'no-cache','Pragma':'no-cache'}});if(response.ok){var _freshData$;const freshData=await response.json();console.log('🔄 Fresh comision dates data:',freshData);console.log('🔄 First item event_name:',(_freshData$=freshData[0])===null||_freshData$===void 0?void 0:_freshData$.event_name);console.log('🔄 All items event_names:',freshData.map(item=>({id:item.id,event_name:item.event_name})));setComisionDates(freshData);console.log('🔄 State updated with fresh data');// Also refresh ONJN reports to update the combined data\nconst onjnResponse=await fetch(\"\".concat(API,\"/onjn-reports\"),{headers:{'Authorization':\"Bearer \".concat(token),'Cache-Control':'no-cache','Pragma':'no-cache'}});if(onjnResponse.ok){const onjnData=await onjnResponse.json();setOnjnReports(onjnData);console.log('🔄 ONJN reports refreshed');}// Force a second refresh after a longer delay to ensure UI updates\nsetTimeout(async()=>{try{const secondResponse=await fetch(\"\".concat(API,\"/comision-dates\"),{headers:{'Authorization':\"Bearer \".concat(token),'Cache-Control':'no-cache','Pragma':'no-cache'}});if(secondResponse.ok){const secondData=await secondResponse.json();console.log('🔄 Second refresh comision dates data:',secondData);setComisionDates(secondData);console.log('🔄 Second refresh completed');}}catch(error){console.error('Error in second refresh:',error);}},1000);}}catch(error){console.error('Error refreshing comision dates:',error);}},500);}handleCloseEntityForm();showCustomNotification(\"\\u2705 \".concat(getEntityDisplayName(entityType),\" saved successfully!\"),'success');}else{const error=await response.json();console.error('❌ Failed to save entity:',error);console.error('📡 Response status:',response.status,response.statusText);showCustomNotification(\"\\u274C Failed to save \".concat(getEntityDisplayName(entityType),\": \").concat(error.detail||'Unknown error'),'error');}}catch(error){console.error('Error saving entity:',error);showCustomNotification(\"\\u274C Error saving \".concat(getEntityDisplayName(entityType),\": \").concat(error.message),'error');}};const handleDeleteEntity=async(entityId,type)=>{console.log('🔥 DELETE REQUESTED:',entityId,type);// Set the item to delete and show confirmation modal\nsetFileToDelete({id:entityId,type:type});setShowDeleteConfirm(true);};const confirmDeleteEntity=async()=>{const{id:entityId,type}=fileToDelete;console.log('🔥 CONFIRMING DELETE:',entityId,type);try{const token=localStorage.getItem('token');const endpoint=getEntityEndpoint(type);console.log('📍 DELETE URL:',\"\".concat(API,\"/\").concat(endpoint,\"/\").concat(entityId));const response=await fetch(\"\".concat(API,\"/\").concat(endpoint,\"/\").concat(entityId),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});console.log('📡 DELETE Response:',response.status,response.statusText);if(response.ok){console.log('✅ Delete successful, refreshing data...');showCustomNotification('✅ Item deleted successfully!','success');console.log('🔄 Calling fetchDashboardData...');try{await fetchDashboardData();// Refresh data\nconsole.log('✅ fetchDashboardData completed');}catch(error){console.error('❌ Error in fetchDashboardData:',error);}}else{const error=await response.json();console.error('❌ DELETE Failed:',error);showCustomNotification('❌ Failed to delete: '+(error.detail||'Unknown error'),'error');}}catch(error){console.error('💥 Delete exception:',error);showCustomNotification('❌ Error deleting: '+error.message,'error');}finally{setShowDeleteConfirm(false);setFileToDelete(null);}};const cancelDeleteEntity=()=>{setShowDeleteConfirm(false);setFileToDelete(null);};const getEntityEndpoint=type=>{const endpoints={companies:'companies',locations:'locations',providers:'providers',cabinets:'cabinets',slots:'slot-machines',gamemixes:'game-mixes',invoices:'invoices',onjn:'onjn-reports',legal:'legal-documents',metrology:'metrology',metrology2:'metrology',jackpots:'jackpots',comision_date:'comision-dates'};return endpoints[type]||type;};// Bulk Edit Handler\nconst handleBulkEdit=entityType=>{if(selectedItems.length===0){showCustomNotification('Please select items to bulk edit','warning');return;}setBulkEditType(entityType);setBulkEditData({});setShowBulkEditForm(true);};const handleBulkDelete=async entityType=>{console.log('🔥 BULK DELETE CLICKED:',entityType);console.log('🔥 Selected items:',selectedItems);console.log('🔥 Selected items length:',selectedItems.length);if(selectedItems.length===0){showCustomNotification('❌ Please select items to delete first!','error');return;}// Show confirmation modal instead of browser confirm\nconsole.log('🔥 Setting bulk delete modal to show');setBulkDeleteType(entityType);setShowBulkDeleteConfirm(true);console.log('🔥 Modal should be visible now');};const confirmBulkDelete=async()=>{const entityType=bulkDeleteType;console.log('🔥 Confirming bulk delete for:',entityType);try{console.log('🚀 Starting bulk delete...');const endpoint=getEntityEndpoint(entityType);const token=localStorage.getItem('token');// Delete each item individually\nlet successCount=0;for(const itemId of selectedItems){console.log(\"\\uD83D\\uDDD1\\uFE0F Deleting \".concat(itemId,\"...\"));const response=await fetch(\"\".concat(API,\"/\").concat(endpoint,\"/\").concat(itemId),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){successCount++;console.log(\"\\u2705 Deleted \".concat(itemId));}else{console.error(\"\\u274C Failed to delete \".concat(itemId));}}showCustomNotification(\"\\u2705 Successfully deleted \".concat(successCount,\" of \").concat(selectedItems.length,\" items!\"),'success');await fetchDashboardData();setSelectedItems([]);console.log('🔄 Data refreshed, selections cleared');}catch(error){console.error('💥 Bulk delete error:',error);showCustomNotification('❌ Bulk delete failed: '+error.message,'error');}finally{setShowBulkDeleteConfirm(false);setBulkDeleteType('');}};const cancelBulkDelete=()=>{console.log('🔥 Canceling bulk delete');setShowBulkDeleteConfirm(false);setBulkDeleteType('');};const confirmBulkStatus=()=>{if(bulkStatusData){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[bulkStatusData.field]:bulkStatusData.value}));setShowBulkStatusConfirm(false);setBulkStatusData(null);}};const cancelBulkStatus=()=>{setShowBulkStatusConfirm(false);setBulkStatusData(null);};// Bulk Duplicate Handler for Slots\nconst handleBulkDuplicate=async entityType=>{console.log('🔄 BULK DUPLICATE CLICKED:',entityType);console.log('🔄 Selected items:',selectedItems);if(selectedItems.length===0){showCustomNotification('❌ Please select items to duplicate first!','error');return;}if(entityType!=='slots'){showCustomNotification('❌ Duplication is only available for slots!','error');return;}try{console.log('🚀 Starting bulk duplicate...');const token=localStorage.getItem('token');// Get all existing slot serial numbers to avoid conflicts\nconst existingSerials=slotMachines.map(slot=>slot.serial_number);console.log('📋 Existing serials:',existingSerials);let successCount=0;for(let i=0;i<selectedItems.length;i++){const itemId=selectedItems[i];console.log(\"\\uD83D\\uDD04 Duplicating \".concat(itemId,\"...\"));// Find the original slot\nconst originalSlot=slotMachines.find(slot=>slot.id===itemId);if(!originalSlot){console.error(\"\\u274C Original slot not found: \".concat(itemId));continue;}// Generate new serial number\nconst baseSerial=originalSlot.serial_number;let newSerial=\"\".concat(baseSerial,\"-1\");let counter=1;// Find next available serial number\nwhile(existingSerials.includes(newSerial)){counter++;newSerial=\"\".concat(baseSerial,\"-\").concat(counter);}// Add new serial to existing list to avoid conflicts in same batch\nexistingSerials.push(newSerial);// Create duplicate slot data\nconst duplicateData=_objectSpread(_objectSpread({},originalSlot),{},{serial_number:newSerial,status:'active'// Set to active by default\n});// Remove id and created_at to create new record\ndelete duplicateData.id;delete duplicateData.created_at;delete duplicateData.created_by;console.log('📤 Creating duplicate with data:',duplicateData);const response=await fetch(\"\".concat(API,\"/slot-machines\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify(duplicateData)});if(response.ok){successCount++;console.log(\"\\u2705 Duplicated \".concat(originalSlot.serial_number,\" -> \").concat(newSerial));}else{const errorText=await response.text();console.error(\"\\u274C Failed to duplicate \".concat(originalSlot.serial_number,\":\"),errorText);}}showCustomNotification(\"\\u2705 Successfully duplicated \".concat(successCount,\" of \").concat(selectedItems.length,\" slots!\"),'success');await fetchDashboardData();setSelectedItems([]);console.log('🔄 Data refreshed, selections cleared');}catch(error){console.error('💥 Bulk duplicate error:',error);showCustomNotification('❌ Bulk duplicate failed: '+error.message,'error');}};// Handle item selection for bulk edit\nconst handleItemSelection=(itemId,checked)=>{if(checked){setSelectedItems([...selectedItems,itemId]);}else{setSelectedItems(selectedItems.filter(id=>id!==itemId));}};// Handle select all\nconst handleSelectAll=(items,checked)=>{if(checked){setSelectedItems(items.map(item=>item.id));}else{setSelectedItems([]);}};// Bulk Edit Save Handler\nconst handleBulkEditSave=async()=>{try{let updatePromises;if(bulkEditType==='metrology'){// For metrology, selectedItems are metrology record IDs directly\nupdatePromises=selectedItems.map(async metrologyId=>{// Update the metrology record directly\nconst response=await fetch(\"\".concat(API,\"/metrology/\").concat(metrologyId),{method:'PUT',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify(bulkEditData)});return response.ok;});}else{// For other entity types, use the standard approach\nupdatePromises=selectedItems.map(async itemId=>{const endpoint=getEntityEndpoint(bulkEditType);const response=await fetch(\"\".concat(API,\"/\").concat(endpoint,\"/\").concat(itemId),{method:'PUT',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify(bulkEditData)});return response.ok;});}const results=await Promise.all(updatePromises);const successCount=results.filter(Boolean).length;if(successCount===selectedItems.length){showCustomNotification(\"\\u2705 Successfully updated \".concat(successCount,\" \").concat(getEntityDisplayName(bulkEditType),\" items!\"),'success');}else{showCustomNotification(\"\\u26A0\\uFE0F Updated \".concat(successCount,\" of \").concat(selectedItems.length,\" items. Some updates failed.\"),'warning');}await fetchDashboardData();setShowBulkEditForm(false);setSelectedItems([]);}catch(error){console.error('Bulk edit error:',error);showCustomNotification(\"\\u274C Bulk edit failed: \".concat(error.message),'error');}};// Export Handler - Excel Format\nconst handleExport=entityType=>{const data={companies:companies,locations:locations,providers:providers,cabinets:cabinets,slots:slotMachines,gamemixes:gameMixes,invoices:invoices,onjn:onjnReports,legal:legalDocuments,users:users};const exportData=data[entityType]||[];if(exportData.length===0){showCustomNotification('No data to export','warning');return;}// Prepare data for Excel - remove internal fields and format properly\nconst excelData=exportData.map(item=>{const cleanItem=_objectSpread({},item);// Remove internal fields\ndelete cleanItem.id;delete cleanItem.created_at;delete cleanItem.created_by;delete cleanItem.password_hash;// Format dates\nif(cleanItem.commission_date){cleanItem.commission_date=new Date(cleanItem.commission_date).toISOString().split('T')[0];}if(cleanItem.issue_date){cleanItem.issue_date=new Date(cleanItem.issue_date).toISOString().split('T')[0];}if(cleanItem.due_date){cleanItem.due_date=new Date(cleanItem.due_date).toISOString().split('T')[0];}if(cleanItem.report_date){cleanItem.report_date=new Date(cleanItem.report_date).toISOString().split('T')[0];}return cleanItem;});// Create Excel workbook\nconst wb=XLSX.utils.book_new();const ws=XLSX.utils.json_to_sheet(excelData);// Auto-width columns\nconst colWidths=Object.keys(excelData[0]||{}).map(key=>({wch:Math.max(key.length,15)}));ws['!cols']=colWidths;XLSX.utils.book_append_sheet(wb,ws,getEntityDisplayName(entityType));// Download file\nconst fileName=\"\".concat(entityType,\"_export_\").concat(new Date().toISOString().split('T')[0],\".xlsx\");XLSX.writeFile(wb,fileName);showCustomNotification(\"\\u2705 \".concat(exportData.length,\" \").concat(getEntityDisplayName(entityType),\" items exported to Excel successfully!\"),'success');};// Import Handler - Excel Format\nconst handleImport=entityType=>{const input=document.createElement('input');input.type='file';input.accept='.xlsx,.xls';input.onchange=async e=>{const file=e.target.files[0];if(!file)return;try{const arrayBuffer=await file.arrayBuffer();const workbook=XLSX.read(arrayBuffer,{type:'array'});const sheetName=workbook.SheetNames[0];const worksheet=workbook.Sheets[sheetName];const importData=XLSX.utils.sheet_to_json(worksheet);if(importData.length===0){showCustomNotification('No data found in Excel file','error');return;}// Validate required fields based on entity type\nconst requiredFields=getRequiredFields(entityType);const missingFields=requiredFields.filter(field=>!Object.keys(importData[0]).includes(field));if(missingFields.length>0){showCustomNotification(\"Missing required columns: \".concat(missingFields.join(', ')),'error');return;}// Show preview and confirm import\n// Show import confirmation notification instead of browser confirm\nshowCustomNotification(\"Found \".concat(importData.length,\" rows in Excel file. Proceed with import?\"),'info');const confirmImport=true;// Always proceed for now\nif(confirmImport){// Process import (for now, just show success - actual API calls would go here)\nconsole.log(\"Importing \".concat(importData.length,\" \").concat(entityType,\":\"),importData);showCustomNotification(\"\\u2705 Ready to import \".concat(importData.length,\" \").concat(getEntityDisplayName(entityType),\" items!\\n\\n(Note: Actual import functionality would process these items through the API)\"),'success');}}catch(error){console.error('Import error:',error);showCustomNotification(\"\\u274C Error reading Excel file: \".concat(error.message),'error');}};input.click();};// Search Filter Function\nconst filterData=(data,searchTerm)=>{if(!searchTerm)return data;const search=searchTerm.toLowerCase();return data.filter(item=>{// Special handling for users to search in first_name and last_name\nif(item.first_name||item.last_name){const fullName=\"\".concat(item.first_name||'',\" \").concat(item.last_name||'').trim();if(fullName.toLowerCase().includes(search))return true;}// Search through all string and number fields\nreturn Object.values(item).some(value=>{if(value===null||value===undefined)return false;return String(value).toLowerCase().includes(search);});});};// Get required fields for validation\nconst getRequiredFields=entityType=>{const fields={companies:['name','email','phone'],locations:['name','address','city'],providers:['name','email'],cabinets:['name','model'],slots:['model','denomination'],gamemixes:['name'],invoices:['invoice_number','amount'],onjn:['report_number'],legal:['document_type','title'],users:['username','email','first_name','last_name','role'],metrology:['serial_number','certificate_number','issue_date'],jackpots:['serial_number','jackpot_type','increment_rate','description']};return fields[entityType]||['name'];};// Toggle functions for click-to-filter functionality\nconst toggleLocationFilter=locationId=>{setSelectedLocationFilter(selectedLocationFilter===locationId?null:locationId);};const toggleProviderFilter=providerId=>{setSelectedProviderFilter(selectedProviderFilter===providerId?null:providerId);};const toggleCabinetFilter=cabinetId=>{setSelectedCabinetFilter(selectedCabinetFilter===cabinetId?null:cabinetId);};const toggleGameMixFilter=gameMixId=>{setSelectedGameMixFilter(selectedGameMixFilter===gameMixId?null:gameMixId);};const toggleInvoiceFilter=invoiceNumber=>{setSelectedInvoiceFilter(selectedInvoiceFilter===invoiceNumber?null:invoiceNumber);};const toggleContractFilter=contractNumber=>{setSelectedContractFilter(selectedContractFilter===contractNumber?null:contractNumber);};const toggleSerialFilter=serialNumber=>{setSelectedSerialFilter(selectedSerialFilter===serialNumber?null:serialNumber);};const toggleCompanyFilter=companyId=>{setSelectedCompanyFilter(selectedCompanyFilter===companyId?null:companyId);};const toggleRTPFilter=rtp=>{setSelectedRTPFilter(selectedRTPFilter===rtp?null:rtp);};const togglePlacesFilter=places=>{setSelectedPlacesFilter(selectedPlacesFilter===places?null:places);};// Toggle function for CVT date filter\nconst toggleCvtDateFilter=cvtDate=>{setSelectedCvtDateFilter(selectedCvtDateFilter===cvtDate?null:cvtDate);};// Toggle function for provider avatar filter\nconst toggleProviderAvatarFilter=providerId=>{setSelectedProviderAvatarFilter(selectedProviderAvatarFilter===providerId?null:providerId);};const handleInvoiceClick=invoice=>{setSelectedInvoice(invoice);setShowInvoiceDetailsPage(true);};const handleCloseInvoicePopup=()=>{setShowInvoicePopup(false);setSelectedInvoice(null);};// Add CVT Date popup handlers\nconst handleOpenAddCvtDatePopup=()=>{setShowAddCvtDatePopup(true);};const handleCloseAddCvtDatePopup=()=>{setShowAddCvtDatePopup(false);};const handleCloseJackpotPopup=()=>{setSelectedJackpots(null);};const handleCloseInvoiceSlotsPopup=()=>{setSelectedInvoiceSlots(null);};const handleOpenSlotAttachments=slotId=>{setSelectedSlotId(slotId);setShowSlotAttachmentsModal(true);};const handleCloseSlotAttachments=()=>{setShowSlotAttachmentsModal(false);setSelectedSlotId(null);};const handleOpenEntityAttachments=(entityType,entityId)=>{console.log('🔗 Opening entity attachments:',{entityType,entityId});setSelectedEntityType(entityType);setSelectedEntityId(entityId);setShowEntityAttachmentsModal(true);};const handleCloseEntityAttachments=()=>{setShowEntityAttachmentsModal(false);setSelectedEntityType(null);setSelectedEntityId(null);};const handleOpenCvtAttachments=cvtId=>{setSelectedCvtForAttachments(cvtId);setShowCvtAttachments(true);};const handleCloseCvtAttachments=()=>{setShowCvtAttachments(false);setSelectedCvtForAttachments(null);};// Change history functions\nconst handleOpenChangeHistory=async(entityType,entityId)=>{try{// If entityId is 'all', we'll show a message that we need to select a specific provider\nif(entityId==='all'){showCustomNotification('Please select a specific provider to view its change history','info');return;}const response=await fetch(\"\".concat(API,\"/change-history/\").concat(entityType,\"/\").concat(entityId),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const historyData=await response.json();setChangeHistoryData(historyData);setSelectedHistoryEntityType(entityType);setSelectedHistoryEntityId(entityId);setShowChangeHistoryModal(true);}else{showCustomNotification('Failed to load change history','error');}}catch(error){console.error('Error loading change history:',error);showCustomNotification('Failed to load change history','error');}};const handleOpenGlobalChangeHistory=async entityType=>{try{const response=await fetch(\"\".concat(API,\"/change-history/\").concat(entityType,\"/all\"),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const historyData=await response.json();setChangeHistoryData(historyData);setSelectedHistoryEntityType(entityType);setSelectedHistoryEntityId('all');setShowChangeHistoryModal(true);}else{showCustomNotification('Failed to load change history','error');}}catch(error){console.error('Error loading change history:',error);showCustomNotification('Failed to load change history','error');}};// Funcție pentru a încărca numărul de înregistrări din istoric\nconst loadChangeHistoryCount=async entityType=>{try{const response=await fetch(\"\".concat(API,\"/change-history/\").concat(entityType,\"/all\"),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const historyData=await response.json();// Actualizează changeHistoryData pentru a afișa badge-ul corect\nif(entityType==='slots'){setChangeHistoryData(historyData);setSelectedHistoryEntityType(entityType);}}}catch(error){console.error('Error loading change history count:',error);}};const handleCloseChangeHistory=()=>{setShowChangeHistoryModal(false);setChangeHistoryData([]);setSelectedHistoryEntityType('');setSelectedHistoryEntityId('');};// Funcții pentru All Modifications History\nconst handleOpenAllModificationsHistory=async entityType=>{try{const response=await fetch(\"\".concat(API,\"/change-history/\").concat(entityType,\"/all\"),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const modificationsData=await response.json();setAllModificationsData(modificationsData);setSelectedAllModificationsEntityType(entityType);setSelectedAllModificationsEntityId('all');setShowAllModificationsModal(true);}else{showCustomNotification('Failed to load all modifications history','error');}}catch(error){console.error('Error loading all modifications history:',error);showCustomNotification('Failed to load all modifications history','error');}};const handleCloseAllModificationsHistory=()=>{setShowAllModificationsModal(false);setAllModificationsData([]);setSelectedAllModificationsEntityType('');setSelectedAllModificationsEntityId('');};const handleMetrologyClick=metrologyData=>{setSelectedMetrology(metrologyData);};const handleCloseMetrologyPopup=()=>{setSelectedMetrology(null);};const handleOpenCommissionDateDetails=commissionDate=>{setSelectedCommissionDate(commissionDate);setShowCommissionDateDetailsPage(true);// Add breadcrumb for commission date details\naddBreadcrumb(commissionDate.event_name||'Commission Date','📅',()=>{setShowCommissionDateDetailsPage(true);setSelectedCommissionDate(commissionDate);});};const handleCloseCommissionDateDetails=()=>{setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);};const handleShowJackpotDetails=jackpot=>{setSelectedJackpot(jackpot);setShowJackpotDetailsPage(true);// Add breadcrumb for jackpot details\naddBreadcrumb(jackpot.jackpot_name,'💰',()=>{setShowJackpotDetailsPage(true);setSelectedJackpot(jackpot);});};const handleCloseJackpotDetails=()=>{setShowJackpotDetailsPage(false);setSelectedJackpot(null);};const handleShowMetrologyDetails=metrology=>{setSelectedMetrology(metrology);setShowMetrologyDetailsPage(true);// Add breadcrumb for metrology details\naddBreadcrumb(metrology.certificate_number,'📋',()=>{setShowMetrologyDetailsPage(true);setSelectedMetrology(metrology);});};const handleCloseMetrologyDetails=()=>{setShowMetrologyDetailsPage(false);setSelectedMetrology(null);};const handleShowInvoiceDetails=invoice=>{setSelectedInvoice(invoice);setShowInvoiceDetailsPage(true);// Add breadcrumb for invoice details\naddBreadcrumb(invoice.invoice_number,'📄',()=>{setShowInvoiceDetailsPage(true);setSelectedInvoice(invoice);});};const handleCloseInvoiceDetails=()=>{setShowInvoiceDetailsPage(false);setSelectedInvoice(null);};const handleShowLocationDetails=location=>{setSelectedLocation(location);setShowLocationDetailsPage(true);// Add breadcrumb for location details\naddBreadcrumb(location.name,'📍',()=>{setShowLocationDetailsPage(true);setSelectedLocation(location);});};const handleCloseLocationDetails=()=>{setShowLocationDetailsPage(false);setSelectedLocation(null);};// Provider Details functions\nconst handleShowProviderDetails=provider=>{setSelectedProvider(provider);setShowProviderDetailsPage(true);// Add breadcrumb for provider details\naddBreadcrumb(provider.name,'🏢',()=>{setShowProviderDetailsPage(true);setSelectedProvider(provider);});};const handleCloseProviderDetails=()=>{setShowProviderDetailsPage(false);setSelectedProvider(null);};// Game Mix Details functions\nconst handleShowGameMixDetails=gameMix=>{setSelectedGameMixForDetails(gameMix);setShowGameMixDetailsPage(true);setGamesViewMode('grid');// Reset to grid view\n// Add breadcrumb for game mix details (capture gameMix in closure)\nconst gameMixForBreadcrumb=gameMix;addBreadcrumb(gameMix.name,'🎲',()=>{// Navigate back to games page and close details\nsetActiveView('games');setShowGameMixDetailsPage(false);setSelectedGameMixForDetails(null);});};const handleCloseGameMixDetails=()=>{setShowGameMixDetailsPage(false);setSelectedGameMixForDetails(null);};// Cabinet Details functions\nconst handleShowCabinetDetails=cabinet=>{setSelectedCabinet(cabinet);setShowCabinetDetailsPage(true);// Add breadcrumb for cabinet details\naddBreadcrumb(cabinet.name,'🖥️',()=>{setShowCabinetDetailsPage(true);setSelectedCabinet(cabinet);});};const handleCloseCabinetDetails=()=>{setShowCabinetDetailsPage(false);setSelectedCabinet(null);};// Slots Details functions\nconst handleCloseSlotsDetails=()=>{setShowSlotsDetailsPage(false);setSelectedSlotsForDetails([]);setSelectedSlotsFilterType('');setSelectedSlotsFilterValue('');};const renderTable=(title,data,columns,actions,entityType)=>{var _providers$find2,_locations$find,_providers$find3,_cabinets$find,_gameMixes$find;// Apply search filter\nlet filteredData=filterData(data,searchTerm);// Apply click-to-filter for slot machines\nif(entityType==='slots'){// Apply multi-select cascade filters FIRST\nif(selectedLocations.length>0){filteredData=filteredData.filter(slot=>selectedLocations.includes(slot.location_id));}if(selectedCabinets.length>0){filteredData=filteredData.filter(slot=>selectedCabinets.includes(slot.cabinet_id));}if(selectedGameMixes.length>0){filteredData=filteredData.filter(slot=>selectedGameMixes.includes(slot.game_mix_id));}if(selectedModels.length>0){filteredData=filteredData.filter(slot=>selectedModels.includes(slot.model));}if(selectedJackpotTypes.length>0){filteredData=filteredData.filter(slot=>selectedJackpotTypes.includes(slot.jackpot_name));}// Apply provider avatar filter\nif(selectedProviderAvatarFilter){filteredData=filteredData.filter(slot=>slot.provider_id===selectedProviderAvatarFilter);}if(selectedLocationFilter){filteredData=filteredData.filter(slot=>slot.location_id===selectedLocationFilter);}if(selectedProviderFilter){filteredData=filteredData.filter(slot=>slot.provider_id===selectedProviderFilter);}if(selectedCabinetFilter){filteredData=filteredData.filter(slot=>slot.cabinet_id===selectedCabinetFilter);}if(selectedGameMixFilter){filteredData=filteredData.filter(slot=>slot.game_mix_id===selectedGameMixFilter);}if(selectedInvoiceFilter){filteredData=filteredData.filter(slot=>slot.invoice_number===selectedInvoiceFilter);}if(selectedContractFilter){filteredData=filteredData.filter(slot=>slot.lease_contract_number===selectedContractFilter);}if(selectedSerialFilter){filteredData=filteredData.filter(slot=>slot.serial_number===selectedSerialFilter);}if(selectedCompanyFilter){filteredData=filteredData.filter(slot=>slot.owner_company_id===selectedCompanyFilter);}if(selectedRTPFilter){filteredData=filteredData.filter(slot=>slot.rtp===selectedRTPFilter);}if(selectedPlacesFilter){filteredData=filteredData.filter(slot=>slot.gaming_places===selectedPlacesFilter);}if(selectedCvtDateFilter){filteredData=filteredData.filter(slot=>{// Find metrology record for this slot\nconst metrologyItem=metrology.find(m=>{if(!m.serial_number)return false;// Try both newline and space separation\nconst serialNumbersNewline=m.serial_number.split('\\n').filter(s=>s.trim());const serialNumbersSpace=m.serial_number.split(' ').filter(s=>s.trim());// Use the one that has more items (more likely to be correct)\nconst serialNumbers=serialNumbersNewline.length>serialNumbersSpace.length?serialNumbersNewline:serialNumbersSpace;return serialNumbers.includes(slot.serial_number);});return(metrologyItem===null||metrologyItem===void 0?void 0:metrologyItem.cvt_expiry_date)===selectedCvtDateFilter;});}}return/*#__PURE__*/_jsxs(\"div\",{className:\"table-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"table-header\",children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px'},children:/*#__PURE__*/_jsx(\"h2\",{children:title})}),/*#__PURE__*/_jsxs(\"div\",{className:\"table-actions\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search \".concat(title.toLowerCase(),\"...\"),value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"search-input\"}),/*#__PURE__*/_jsx(\"span\",{className:\"search-icon\",children:\"\\uD83D\\uDD0D\"})]}),(actions===null||actions===void 0?void 0:actions.additionalButtons)&&actions.additionalButtons.map((button,index)=>/*#__PURE__*/_jsxs(\"button\",{className:\"btn-secondary\",onClick:button.onClick,title:button.label,style:button.style||{},children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:button.icon}),button.label]},index)),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-primary\",onClick:()=>(actions===null||actions===void 0?void 0:actions.onAdd)&&actions.onAdd(),children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\u2795\"}),\"Add \",entityType==='slots'?'Slot':entityType==='metrology'?'Metrologie':title.slice(0,-1)]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-secondary\",onClick:()=>(actions===null||actions===void 0?void 0:actions.onBulkEdit)&&actions.onBulkEdit(),title:\"Bulk Edit Selected\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\uD83D\\uDCDD\"}),\"Bulk Edit (\",selectedItems.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-danger\",onClick:()=>(actions===null||actions===void 0?void 0:actions.onBulkDelete)&&actions.onBulkDelete(),title:\"Bulk Delete Selected\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\uD83D\\uDDD1\\uFE0F\"}),\"Bulk Delete (\",selectedItems.length,\")\"]}),entityType==='slots'&&/*#__PURE__*/_jsxs(\"button\",{className:\"btn-warning\",onClick:()=>(actions===null||actions===void 0?void 0:actions.onBulkDuplicate)&&actions.onBulkDuplicate(),title:\"Duplicate Selected Slots\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\uD83D\\uDD04\"}),\"Duplicate (\",selectedItems.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-success\",onClick:()=>(actions===null||actions===void 0?void 0:actions.onExport)&&actions.onExport(),title:\"Export Data\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\uD83D\\uDCE4\"}),\"Export\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-info\",onClick:()=>(actions===null||actions===void 0?void 0:actions.onImport)&&actions.onImport(),title:\"Import Data\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\uD83D\\uDCE5\"}),\"Import\"]})]}),entityType==='providers'&&/*#__PURE__*/_jsxs(\"button\",{className:\"btn-secondary\",onClick:()=>{// Show a dropdown or modal to select which provider's history to view\nconst providerNames=providers.map(p=>p.name);const selectedProvider=prompt('Select a provider to view change history:\\n\\n'+providerNames.map((name,index)=>\"\".concat(index+1,\". \").concat(name)).join('\\n')+'\\n\\nEnter the number:');if(selectedProvider&&!isNaN(selectedProvider)){const providerIndex=parseInt(selectedProvider)-1;if(providerIndex>=0&&providerIndex<providers.length){const selectedProviderData=providers[providerIndex];handleOpenChangeHistory('providers',selectedProviderData.id);}else{showCustomNotification('Invalid selection','error');}}},title:\"View Change History\",style:{display:'flex',alignItems:'center',gap:'6px',padding:'8px 12px',borderRadius:'6px',border:'1px solid var(--border-color)',background:'var(--background-secondary)',color:'var(--text-primary)',cursor:'pointer',fontSize:'13px',fontWeight:'500',transition:'all 0.2s ease'},onMouseEnter:e=>{e.target.style.background='var(--accent-color)';e.target.style.color='white';},onMouseLeave:e=>{e.target.style.background='var(--background-secondary)';e.target.style.color='var(--text-primary)';},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'14px'},children:\"\\uD83D\\uDCCB\"}),\"Change History\"]})]}),entityType==='slots'&&/*#__PURE__*/_jsxs(\"div\",{style:{margin:'8px 0 0 0',display:'flex',justifyContent:'space-between',alignItems:'center',position:'relative',padding:'12px 0',minHeight:'60px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',flex:1,justifyContent:'flex-start',marginLeft:'40px',alignItems:'center',overflow:'visible'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown-container\",style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowLocationFilterDropdown(!showLocationFilterDropdown);setShowCabinetFilterDropdown(false);setShowGameMixFilterDropdown(false);setShowModelFilterDropdown(false);setShowJackpotFilterDropdown(false);},style:{width:'30px',height:'30px',borderRadius:'50%',border:'none',background:selectedLocations.length>0?'var(--accent-color)':'var(--bg-secondary)',color:selectedLocations.length>0?'white':'var(--text-primary)',cursor:'pointer',fontSize:'14px',display:'flex',alignItems:'center',justifyContent:'center',boxShadow:'0 4px 8px rgba(0, 0, 0, 0.3)'},title:\"Locations (\".concat(selectedLocations.length,\")\"),children:\"\\uD83D\\uDCCD\"}),showLocationFilterDropdown&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'100%',left:0,background:'var(--bg-primary)',border:'1px solid var(--border-color)',borderRadius:'8px',boxShadow:'0 8px 24px rgba(0,0,0,0.12)',zIndex:9999,minWidth:'220px',maxHeight:'240px',overflowY:'auto',marginTop:'6px',padding:'4px 0'},children:getFilteredLocations.map(location=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleLocationToggle(location.id),style:{padding:'10px 16px',cursor:'pointer',background:selectedLocations.includes(location.id)?'var(--accent-color)':'transparent',color:selectedLocations.includes(location.id)?'white':'var(--text-primary)',display:'flex',alignItems:'center',gap:'12px',fontSize:'14px',fontWeight:'normal',transition:'all 0.2s ease',borderLeft:selectedLocations.includes(location.id)?'3px solid rgba(255,255,255,0.3)':'3px solid transparent'},onMouseEnter:e=>{if(!selectedLocations.includes(location.id)){e.target.style.background='var(--bg-secondary)';}},onMouseLeave:e=>{if(!selectedLocations.includes(location.id)){e.target.style.background='transparent';}},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'16px',height:'16px',border:'2px solid',borderColor:selectedLocations.includes(location.id)?'var(--accent-color)':'var(--border-color)',background:selectedLocations.includes(location.id)?'var(--accent-color)':'transparent',borderRadius:'4px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'12px',fontWeight:'normal',color:selectedLocations.includes(location.id)?'white':'transparent'},children:selectedLocations.includes(location.id)&&'✓'}),location.name]},location.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown-container\",style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowCabinetFilterDropdown(!showCabinetFilterDropdown);setShowLocationFilterDropdown(false);setShowGameMixFilterDropdown(false);setShowModelFilterDropdown(false);setShowJackpotFilterDropdown(false);},style:{width:'30px',height:'30px',borderRadius:'50%',border:'none',background:selectedCabinets.length>0?'var(--accent-color)':'var(--bg-secondary)',color:selectedCabinets.length>0?'white':'var(--text-primary)',cursor:'pointer',fontSize:'14px',display:'flex',alignItems:'center',justifyContent:'center',boxShadow:'0 4px 8px rgba(0, 0, 0, 0.3)'},title:\"Cabinets (\".concat(selectedCabinets.length,\")\"),children:\"\\uD83C\\uDFB0\"}),showCabinetFilterDropdown&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'100%',left:0,background:'var(--bg-primary)',border:'1px solid var(--border-color)',borderRadius:'8px',boxShadow:'0 8px 24px rgba(0,0,0,0.12)',zIndex:9999,minWidth:'220px',maxHeight:'240px',overflowY:'auto',marginTop:'6px',padding:'4px 0'},children:getFilteredCabinets.map(cabinet=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleCabinetToggle(cabinet.id),style:{padding:'10px 16px',cursor:'pointer',background:selectedCabinets.includes(cabinet.id)?'var(--accent-color)':'transparent',color:selectedCabinets.includes(cabinet.id)?'white':'var(--text-primary)',display:'flex',alignItems:'center',gap:'12px',fontSize:'14px',fontWeight:'normal',transition:'all 0.2s ease',borderLeft:selectedCabinets.includes(cabinet.id)?'3px solid rgba(255,255,255,0.3)':'3px solid transparent'},onMouseEnter:e=>{if(!selectedCabinets.includes(cabinet.id)){e.target.style.background='var(--bg-secondary)';}},onMouseLeave:e=>{if(!selectedCabinets.includes(cabinet.id)){e.target.style.background='transparent';}},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'16px',height:'16px',border:'2px solid',borderColor:selectedCabinets.includes(cabinet.id)?'var(--accent-color)':'var(--border-color)',background:selectedCabinets.includes(cabinet.id)?'var(--accent-color)':'transparent',borderRadius:'4px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'12px',fontWeight:'normal',color:selectedCabinets.includes(cabinet.id)?'white':'transparent'},children:selectedCabinets.includes(cabinet.id)&&'✓'}),cabinet.name]},cabinet.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown-container\",style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowGameMixFilterDropdown(!showGameMixFilterDropdown);setShowLocationFilterDropdown(false);setShowCabinetFilterDropdown(false);setShowModelFilterDropdown(false);setShowJackpotFilterDropdown(false);},style:{width:'30px',height:'30px',borderRadius:'50%',border:'none',background:selectedGameMixes.length>0?'var(--accent-color)':'var(--bg-secondary)',color:selectedGameMixes.length>0?'white':'var(--text-primary)',cursor:'pointer',fontSize:'14px',display:'flex',alignItems:'center',justifyContent:'center',boxShadow:'0 4px 8px rgba(0, 0, 0, 0.3)'},title:\"Game Mixes (\".concat(selectedGameMixes.length,\")\"),children:\"\\uD83C\\uDFB2\"}),showGameMixFilterDropdown&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'100%',left:0,background:'var(--bg-primary)',border:'1px solid var(--border-color)',borderRadius:'8px',boxShadow:'0 8px 24px rgba(0,0,0,0.12)',zIndex:9999,minWidth:'220px',maxHeight:'240px',overflowY:'auto',marginTop:'6px',padding:'4px 0'},children:getFilteredGameMixes.map(mix=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleGameMixToggle(mix.id),style:{padding:'10px 16px',cursor:'pointer',background:selectedGameMixes.includes(mix.id)?'var(--accent-color)':'transparent',color:selectedGameMixes.includes(mix.id)?'white':'var(--text-primary)',display:'flex',alignItems:'center',gap:'12px',fontSize:'14px',fontWeight:'normal',transition:'all 0.2s ease',borderLeft:selectedGameMixes.includes(mix.id)?'3px solid rgba(255,255,255,0.3)':'3px solid transparent'},onMouseEnter:e=>{if(!selectedGameMixes.includes(mix.id)){e.target.style.background='var(--bg-secondary)';}},onMouseLeave:e=>{if(!selectedGameMixes.includes(mix.id)){e.target.style.background='transparent';}},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'16px',height:'16px',border:'2px solid',borderColor:selectedGameMixes.includes(mix.id)?'var(--accent-color)':'var(--border-color)',background:selectedGameMixes.includes(mix.id)?'var(--accent-color)':'transparent',borderRadius:'4px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'12px',fontWeight:'normal',color:selectedGameMixes.includes(mix.id)?'white':'transparent'},children:selectedGameMixes.includes(mix.id)&&'✓'}),mix.name]},mix.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown-container\",style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowModelFilterDropdown(!showModelFilterDropdown);setShowLocationFilterDropdown(false);setShowCabinetFilterDropdown(false);setShowGameMixFilterDropdown(false);setShowJackpotFilterDropdown(false);},style:{width:'30px',height:'30px',borderRadius:'50%',border:'none',background:selectedModels.length>0?'var(--accent-color)':'var(--bg-secondary)',color:selectedModels.length>0?'white':'var(--text-primary)',cursor:'pointer',fontSize:'14px',display:'flex',alignItems:'center',justifyContent:'center',boxShadow:'0 4px 8px rgba(0, 0, 0, 0.3)'},title:\"Models (\".concat(selectedModels.length,\")\"),children:\"\\u2618\\uFE0F\"}),showModelFilterDropdown&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'100%',left:0,background:'var(--bg-primary)',border:'1px solid var(--border-color)',borderRadius:'8px',boxShadow:'0 8px 24px rgba(0,0,0,0.12)',zIndex:9999,minWidth:'220px',maxHeight:'240px',overflowY:'auto',marginTop:'6px',padding:'4px 0'},children:getFilteredModels.map(model=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleModelToggle(model),style:{padding:'10px 16px',cursor:'pointer',background:selectedModels.includes(model)?'var(--accent-color)':'transparent',color:selectedModels.includes(model)?'white':'var(--text-primary)',display:'flex',alignItems:'center',gap:'12px',fontSize:'14px',fontWeight:'normal',transition:'all 0.2s ease',borderLeft:selectedModels.includes(model)?'3px solid rgba(255,255,255,0.3)':'3px solid transparent'},onMouseEnter:e=>{if(!selectedModels.includes(model)){e.target.style.background='var(--bg-secondary)';}},onMouseLeave:e=>{if(!selectedModels.includes(model)){e.target.style.background='transparent';}},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'16px',height:'16px',border:'2px solid',borderColor:selectedModels.includes(model)?'var(--accent-color)':'var(--border-color)',background:selectedModels.includes(model)?'var(--accent-color)':'transparent',borderRadius:'4px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'12px',fontWeight:'normal',color:selectedModels.includes(model)?'white':'transparent'},children:selectedModels.includes(model)&&'✓'}),model]},model))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown-container\",style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowJackpotFilterDropdown(!showJackpotFilterDropdown);setShowLocationFilterDropdown(false);setShowCabinetFilterDropdown(false);setShowGameMixFilterDropdown(false);setShowModelFilterDropdown(false);},style:{width:'30px',height:'30px',borderRadius:'50%',border:'none',background:selectedJackpotTypes.length>0?'var(--accent-color)':'var(--bg-secondary)',color:selectedJackpotTypes.length>0?'white':'var(--text-primary)',cursor:'pointer',fontSize:'14px',display:'flex',alignItems:'center',justifyContent:'center',boxShadow:'0 4px 8px rgba(0, 0, 0, 0.3)'},title:\"Jackpots (\".concat(selectedJackpotTypes.length,\")\"),children:\"\\uD83C\\uDFC6\"}),showJackpotFilterDropdown&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'100%',left:0,background:'var(--bg-primary)',border:'1px solid var(--border-color)',borderRadius:'8px',boxShadow:'0 8px 24px rgba(0,0,0,0.12)',zIndex:9999,minWidth:'220px',maxHeight:'240px',overflowY:'auto',marginTop:'6px',padding:'4px 0'},children:getFilteredJackpots.length===0?/*#__PURE__*/_jsx(\"div\",{style:{padding:'8px 16px',color:'var(--text-secondary)',fontSize:'14px'},children:\"No jackpots available\"}):getFilteredJackpots.map(jackpot=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleJackpotToggle(jackpot),style:{padding:'8px 16px',cursor:'pointer',display:'flex',alignItems:'center',gap:'8px',fontSize:'14px',color:'var(--text-primary)',backgroundColor:selectedJackpotTypes.includes(jackpot)?'var(--accent-color-light)':'transparent',transition:'background-color 0.2s ease'},onMouseEnter:e=>{if(!selectedJackpotTypes.includes(jackpot)){e.target.style.backgroundColor='var(--bg-secondary)';}},onMouseLeave:e=>{if(!selectedJackpotTypes.includes(jackpot)){e.target.style.backgroundColor='transparent';}},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'16px',height:'16px',border:'2px solid',borderColor:selectedJackpotTypes.includes(jackpot)?'var(--accent-color)':'var(--border-color)',background:selectedJackpotTypes.includes(jackpot)?'var(--accent-color)':'transparent',borderRadius:'4px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'12px',fontWeight:'normal',color:selectedJackpotTypes.includes(jackpot)?'white':'transparent'},children:selectedJackpotTypes.includes(jackpot)&&'✓'}),jackpot]},jackpot))})]}),(selectedLocations.length>0||selectedCabinets.length>0||selectedGameMixes.length>0||selectedModels.length>0||selectedJackpotTypes.length>0)&&/*#__PURE__*/_jsx(\"button\",{onClick:clearAllFilters,style:{width:'30px',height:'30px',borderRadius:'50%',border:'none',background:'#ff4757',color:'white',cursor:'pointer',fontSize:'14px',display:'flex',alignItems:'center',justifyContent:'center',boxShadow:'0 4px 8px rgba(0, 0, 0, 0.3)'},title:\"Clear all filters\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',gap:'8px',flex:1},children:providers.map(provider=>/*#__PURE__*/_jsx(\"div\",{className:\"provider-avatar-filter \".concat(selectedProviderAvatarFilter===provider.id?'active':''),onClick:()=>toggleProviderAvatarFilter(provider.id),title:\"Filter by \".concat(provider.name),children:/*#__PURE__*/_jsx(AvatarDisplay,{entityType:\"providers\",entityId:provider.id,size:30})},provider.id))}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',flex:1,justifyContent:'flex-end',marginRight:'40px',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"button\",{style:{width:'30px',height:'30px',borderRadius:'50%',border:'none',background:'var(--bg-secondary)',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'14px',boxShadow:'0 2px 4px rgba(0, 0, 0, 0.2)',transition:'all 0.2s ease'},onClick:()=>{// Deschide modal cu acțiuni programate pentru slot-uri\nconst slotScheduledChanges=scheduledChanges.filter(change=>change.entityType==='slots');if(slotScheduledChanges.length>0){setShowScheduledChangesModal(true);}},title:\"Scheduled actions\",children:\"\\u23F1\\uFE0F\"}),(()=>{const slotScheduledChanges=scheduledChanges.filter(change=>change.entityType==='slots');if(slotScheduledChanges.length>0){return/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'-3px',right:'-3px',backgroundColor:'#ef4444',color:'white',borderRadius:'50%',width:'16px',height:'16px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'10px',fontWeight:'bold',zIndex:1002},children:slotScheduledChanges.length});}return null;})()]}),/*#__PURE__*/_jsx(\"div\",{style:{position:'relative'},children:/*#__PURE__*/_jsx(\"button\",{style:{width:'30px',height:'30px',borderRadius:'50%',border:'none',background:'var(--bg-secondary)',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'14px',boxShadow:'0 2px 4px rgba(0, 0, 0, 0.2)',transition:'all 0.2s ease'},onClick:()=>setShowHistoryChangesPage(true),title:\"All History Changes\",children:\"\\uD83D\\uDCCA\"})})]})]}),entityType==='slots'&&(selectedProviderAvatarFilter||selectedLocationFilter||selectedProviderFilter||selectedCabinetFilter||selectedGameMixFilter||selectedInvoiceFilter||selectedContractFilter)&&/*#__PURE__*/_jsxs(\"div\",{className:\"active-filters-info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Active Filters:\"}),selectedProviderAvatarFilter&&/*#__PURE__*/_jsxs(\"span\",{className:\"filter-tag\",children:[\"\\uD83D\\uDC64 Provider: \",((_providers$find2=providers.find(p=>p.id===selectedProviderAvatarFilter))===null||_providers$find2===void 0?void 0:_providers$find2.name)||'Unknown',/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedProviderAvatarFilter(null),className:\"filter-remove\",children:\"\\xD7\"})]}),selectedLocationFilter&&/*#__PURE__*/_jsxs(\"span\",{className:\"filter-tag\",children:[\"\\uD83D\\uDCCD Location: \",((_locations$find=locations.find(l=>l.id===selectedLocationFilter))===null||_locations$find===void 0?void 0:_locations$find.name)||'Unknown',/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedLocationFilter(null),className:\"filter-remove\",children:\"\\xD7\"})]}),selectedProviderFilter&&/*#__PURE__*/_jsxs(\"span\",{className:\"filter-tag\",children:[\"\\uD83C\\uDFE2 Provider: \",((_providers$find3=providers.find(p=>p.id===selectedProviderFilter))===null||_providers$find3===void 0?void 0:_providers$find3.name)||'Unknown',/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedProviderFilter(null),className:\"filter-remove\",children:\"\\xD7\"})]}),selectedCabinetFilter&&/*#__PURE__*/_jsxs(\"span\",{className:\"filter-tag\",children:[\"\\uD83C\\uDFDB\\uFE0F Cabinet: \",((_cabinets$find=cabinets.find(c=>c.id===selectedCabinetFilter))===null||_cabinets$find===void 0?void 0:_cabinets$find.name)||'Unknown',/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedCabinetFilter(null),className:\"filter-remove\",children:\"\\xD7\"})]}),selectedGameMixFilter&&/*#__PURE__*/_jsxs(\"span\",{className:\"filter-tag\",children:[\"\\uD83C\\uDFAE Game Mix: \",((_gameMixes$find=gameMixes.find(gm=>gm.id===selectedGameMixFilter))===null||_gameMixes$find===void 0?void 0:_gameMixes$find.name)||'Unknown',/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedGameMixFilter(null),className:\"filter-remove\",children:\"\\xD7\"})]}),selectedInvoiceFilter&&/*#__PURE__*/_jsxs(\"span\",{className:\"filter-tag\",children:[\"\\uD83D\\uDCC4 Invoice: \",selectedInvoiceFilter,/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedInvoiceFilter(null),className:\"filter-remove\",children:\"\\xD7\"})]}),selectedContractFilter&&/*#__PURE__*/_jsxs(\"span\",{className:\"filter-tag\",children:[\"\\uD83D\\uDCCB Contract: \",selectedContractFilter,/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedContractFilter(null),className:\"filter-remove\",children:\"\\xD7\"})]}),selectedCvtDateFilter&&/*#__PURE__*/_jsxs(\"span\",{className:\"filter-tag\",children:[\"\\uD83D\\uDCC5 CVT Date: \",formatDateDDMMYYYY(selectedCvtDateFilter),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedCvtDateFilter(null),className:\"filter-remove\",children:\"\\xD7\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"table-content\",children:[filteredData.length<data.length&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-results-info\",children:[\"Showing \",filteredData.length,\" of \",data.length,\" results for \\\"\",searchTerm,\"\\\"\"]}),/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filteredData.length>0&&selectedItems.length===filteredData.length,onChange:e=>handleSelectAll(filteredData,e.target.checked)})}),/*#__PURE__*/_jsx(\"th\",{children:\"#\"}),columns.map(col=>/*#__PURE__*/_jsx(\"th\",{children:col.label},col.key)),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredData.length===0&&searchTerm?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{colSpan:columns.length+3,style:{textAlign:'center',padding:'2rem'},children:[\"No results found for \\\"\",searchTerm,\"\\\"\"]})}):filteredData.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{colSpan:columns.length+3,style:{textAlign:'center',padding:'2rem'},children:[\"No \",title.toLowerCase(),\" found\"]})}):filteredData.map((item,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedItems.includes(item.id),onChange:e=>handleItemSelection(item.id,e.target.checked)})}),/*#__PURE__*/_jsx(\"td\",{children:index+1}),columns.map(col=>/*#__PURE__*/_jsx(\"td\",{children:col.render?col.render(item):item[col.key]||'N/A'},\"\".concat(item.id,\"-\").concat(col.key))),/*#__PURE__*/_jsx(\"td\",{children:entityType==='slots'||entityType==='metrology'?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"table-row-actions-vertical\",style:{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',justifyContent:'center',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-edit\",onClick:()=>(actions===null||actions===void 0?void 0:actions.onEdit)&&actions.onEdit(item),title:\"Edit\",style:{fontSize:'12px',padding:'2px 4px',display:'inline-flex',alignItems:'center',justifyContent:'center',width:'32px',height:'32px',border:'none',backgroundColor:'#d1e7ff',borderRadius:'50%',color:'#1e3a8a',cursor:'pointer'},children:\"\\u270F\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-delete\",onClick:e=>{e.preventDefault();e.stopPropagation();handleDeleteEntity(item.id,entityType);},title:\"Delete \".concat(entityType==='slots'?'Slot Machine':entityType==='metrology'?'CVT Record':entityType==='companies'?'Company':entityType==='locations'?'Location':entityType==='providers'?'Provider':entityType==='cabinets'?'Cabinet':entityType==='gamemixes'?'Game Mix':entityType==='jackpots'?'Jackpot':entityType==='invoices'?'Invoice':entityType==='onjn'?'ONJN Report':entityType==='legal'?'Legal Document':entityType==='users'?'User':'Record'),style:{fontSize:'12px',padding:'2px 4px',display:'inline-flex',alignItems:'center',justifyContent:'center',width:'32px',height:'32px',border:'none',backgroundColor:'#d1e7ff',borderRadius:'50%',color:'#1e3a8a',cursor:'pointer'},children:\"\\uD83D\\uDDD1\\uFE0F\"}),entityType==='slots'?/*#__PURE__*/_jsx(AttachmentIndicator,{slotId:item.id,onClick:()=>handleOpenSlotAttachments(item.id)}):/*#__PURE__*/_jsx(GenericAttachmentIndicator,{entityType:item.entityType==='comision_dates'?'comision_dates':item.type==='comision_date'?'comision_dates':entityType==='onjn'?'onjn_reports':entityType,entityId:item.id,onClick:()=>handleOpenEntityAttachments(item.entityType==='comision_dates'?'comision_dates':item.type==='comision_date'?'comision_dates':entityType==='onjn'?'onjn_reports':entityType,item.id)}),(()=>{const changes=scheduledChanges.filter(change=>change.entityType==='slots'&&change.itemId===item.id);if(changes.length>0){const change=changes[0];const scheduledDateTime=new Date(change.scheduledDateTime);const msLeft=scheduledDateTime.getTime()-timerTick;const formatCountdown=ms=>{if(ms<=0)return'00:00';const totalSeconds=Math.floor(ms/1000);const minutes=Math.floor(totalSeconds/60);const seconds=totalSeconds%60;return\"\".concat(minutes.toString().padStart(2,'0'),\":\").concat(seconds.toString().padStart(2,'0'));};return/*#__PURE__*/_jsx(\"button\",{className:\"btn-timer\",onClick:()=>setShowScheduledChangeForSlot(item.id),title:\"View scheduled action\",style:{fontSize:'12px',padding:'2px 4px',display:'inline-flex',alignItems:'center',justifyContent:'center',width:'32px',height:'32px',border:'none',backgroundColor:'#d1e7ff',borderRadius:'50%',color:'#1e3a8a',cursor:'pointer',position:'relative'},children:\"\\u23F1\\uFE0F\"});}else{return/*#__PURE__*/_jsx(\"button\",{className:\"btn-timer\",onClick:()=>{setScheduleChangeData(item);setShowScheduleChangeModal(true);},title:\"Schedule Changes for Slot Machine\",style:{fontSize:'12px',padding:'2px 4px',display:'inline-flex',alignItems:'center',justifyContent:'center',width:'32px',height:'32px',border:'none',backgroundColor:'#d1e7ff',borderRadius:'50%',color:'#1e3a8a',cursor:'pointer'},children:\"\\u23F1\\uFE0F\"});}})()]}),(entityType==='slots'||entityType==='warehouse')&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',gap:'8px',marginTop:'4px'},children:[/*#__PURE__*/_jsxs(\"label\",{className:\"switch\",style:{display:'flex',alignItems:'center',cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:item.status==='active',onChange:e=>handleSlotStatusChange(item,e.target.checked?'active':'inactive'),style:{display:'none'}}),/*#__PURE__*/_jsx(\"span\",{style:{width:36,height:20,background:item.status==='active'?'var(--accent-color)':'#ccc',borderRadius:12,position:'relative',transition:'background 0.2s',display:'inline-block',marginRight:6},children:/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',left:item.status==='active'?18:2,top:2,width:16,height:16,background:'#fff',borderRadius:'50%',boxShadow:'0 1px 4px rgba(0,0,0,0.15)',transition:'left 0.2s'}})}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:14,color:item.status==='active'?'var(--accent-color)':'#888',fontWeight:600},children:item.status==='active'?'🟢':'🔴'})]}),(()=>{const changes=scheduledChanges.filter(change=>change.entityType==='slots'&&change.itemId===item.id);if(changes.length>0){const change=changes[0];const scheduledDateTime=new Date(change.scheduledDateTime);const msLeft=scheduledDateTime.getTime()-timerTick;const formatCountdown=ms=>{if(ms<=0)return'00:00';const totalSeconds=Math.floor(ms/1000);const totalMinutes=Math.floor(totalSeconds/60);const totalHours=Math.floor(totalMinutes/60);const totalDays=Math.floor(totalHours/24);if(totalDays>0){// Afișează zile, ore, minute\nconst remainingHours=totalHours%24;const remainingMinutes=totalMinutes%60;return\"\".concat(totalDays,\"d \").concat(remainingHours,\"h \").concat(remainingMinutes,\"m\");}else if(totalHours>0){// Afișează ore, minute\nconst remainingMinutes=totalMinutes%60;return\"\".concat(totalHours,\"h \").concat(remainingMinutes,\"m\");}else{// Afișează minute, secunde\nconst minutes=totalMinutes;const seconds=totalSeconds%60;return\"\".concat(minutes.toString().padStart(2,'0'),\":\").concat(seconds.toString().padStart(2,'0'));}};return/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowScheduledChangeForSlot(item.id),title:\"Edit scheduled action\",style:{fontSize:'13.9px',fontWeight:'normal',color:'#FF8C00',background:'none',border:'none',cursor:'pointer',padding:'4px 8px',borderRadius:'4px',transition:'background-color 0.2s'},onMouseEnter:e=>e.target.style.backgroundColor='#f0f0f0',onMouseLeave:e=>e.target.style.backgroundColor='transparent',children:formatCountdown(msLeft)});}return null;})()]})]})}):/*#__PURE__*/_jsxs(\"div\",{className:\"table-row-actions\",style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-edit\",onClick:()=>(actions===null||actions===void 0?void 0:actions.onEdit)&&actions.onEdit(item),title:\"Edit \".concat(entityType==='slots'?'Slot Machine':entityType==='metrology'?'CVT Record':entityType==='companies'?'Company':entityType==='locations'?'Location':entityType==='providers'?'Provider':entityType==='cabinets'?'Cabinet':entityType==='gamemixes'?'Game Mix':entityType==='jackpots'?'Jackpot':entityType==='invoices'?'Invoice':entityType==='onjn'?'ONJN Report':entityType==='legal'?'Legal Document':entityType==='users'?'User':'Record'),style:{fontSize:'12px',padding:'2px 4px',display:'inline-flex',alignItems:'center',justifyContent:'center',width:'32px',height:'32px',backgroundColor:'#d1e7ff',borderRadius:'50%',color:'#1e3a8a',border:'none',cursor:'pointer'},children:\"\\u270F\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-delete\",onClick:e=>{e.preventDefault();e.stopPropagation();handleDeleteEntity(item.id,entityType);},title:\"Delete \".concat(entityType==='slots'?'Slot Machine':entityType==='metrology'?'CVT Record':entityType==='companies'?'Company':entityType==='locations'?'Location':entityType==='providers'?'Provider':entityType==='cabinets'?'Cabinet':entityType==='gamemixes'?'Game Mix':entityType==='jackpots'?'Jackpot':entityType==='invoices'?'Invoice':entityType==='onjn'?'ONJN Report':entityType==='legal'?'Legal Document':entityType==='users'?'User':'Record'),style:{fontSize:'12px',padding:'2px 4px',display:'inline-flex',alignItems:'center',justifyContent:'center',width:'32px',height:'32px',border:'none',backgroundColor:'#d1e7ff',borderRadius:'50%',color:'#1e3a8a',cursor:'pointer'},children:\"\\uD83D\\uDDD1\\uFE0F\"}),entityType==='slots'?/*#__PURE__*/_jsx(AttachmentIndicator,{slotId:item.id,onClick:()=>handleOpenSlotAttachments(item.id)}):entityType==='onjn'&&item.type==='comision_date'?/*#__PURE__*/_jsx(GenericAttachmentIndicator,{entityType:\"comision_dates\",entityId:item.id,onClick:()=>handleOpenEntityAttachments(\"comision_dates\",item.id)}):/*#__PURE__*/_jsx(GenericAttachmentIndicator,{entityType:entityType,entityId:item.id,onClick:()=>handleOpenEntityAttachments(entityType,item.id)}),entityType==='slots'&&/*#__PURE__*/_jsx(\"button\",{className:\"btn-timer\",onClick:()=>{console.log('Timer button clicked for:',item.id,entityType);showCustomNotification(\"Timer clicked for slot: \".concat(item.id),'info');handleEditEntity(item,entityType);},title:\"Schedule Changes for Slot Machine\",style:{fontSize:'14px',padding:'6px',display:'inline-block',width:'32px',height:'32px',backgroundColor:'#ff4757',borderRadius:'50%',color:'#ffffff',border:'2px solid #ff0000',cursor:'pointer',marginLeft:'4px',marginRight:'4px',textAlign:'center',lineHeight:'20px',zIndex:9999,position:'relative'},children:\"\\u23F1\\uFE0F\"})]})})]},item.id))})]})]})]});};const renderDashboard=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-overview\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"dashboard-header\"}),stats&&/*#__PURE__*/_jsxs(\"div\",{className:\"stats-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card clickable\",onClick:()=>{if(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}setActiveView('companies');},children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",style:{backgroundColor:'#3182ce'},children:\"\\uD83D\\uDCCA\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Companies\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.total_companies})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card clickable\",onClick:()=>{if(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}setActiveView('locations');},children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",style:{backgroundColor:'#3182ce'},children:\"\\uD83D\\uDCCD\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Locations\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.total_locations})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card clickable\",onClick:()=>{if(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}setActiveView('providers');},children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",style:{backgroundColor:'#3182ce'},children:\"\\uD83C\\uDFAE\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Gaming Providers\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.total_providers})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card clickable\",onClick:()=>{if(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}setActiveView('cabinets');},children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",style:{backgroundColor:'#ef4444'},children:\"\\uD83C\\uDFB0\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Gaming Cabinets\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.total_cabinets})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card clickable\",onClick:()=>{if(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}setActiveView('slots');},children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",style:{backgroundColor:'#8b5cf6'},children:\"\\uD83C\\uDFAF\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Slot Machines\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.total_slot_machines})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card clickable\",onClick:()=>{if(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}setActiveView('dashboard');},children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",style:{backgroundColor:'#06b6d4'},children:\"\\u26A1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Active Equipment\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.active_equipment})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card clickable\",onClick:()=>{if(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}setActiveView('invoices');},children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",style:{backgroundColor:'#3182ce'},children:\"\\uD83D\\uDCB0\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Invoices\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.total_invoices})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card clickable\",onClick:()=>{if(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}setActiveView('onjn');},children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",style:{backgroundColor:'#3182ce'},children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"ONJN Reports\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.total_onjn_reports})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card clickable\",onClick:()=>{if(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}setActiveView('legal');},children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",style:{backgroundColor:'#ef4444'},children:\"\\uD83D\\uDCC4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Legal Documents\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.total_legal_documents})]})]}),(user===null||user===void 0?void 0:user.role)==='admin'&&/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card clickable\",onClick:()=>{if(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}setActiveView('users');},children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",style:{backgroundColor:'#8b5cf6'},children:\"\\uD83D\\uDC65\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Users\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.total_users})]})]})]}),stats&&stats.recent_activities.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"recent-activities\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Recent Activities\"}),/*#__PURE__*/_jsx(\"div\",{className:\"activities-list\",children:stats.recent_activities.map((activity,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"activity-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"activity-icon\",children:[activity.type==='company'&&'🏢',activity.type==='location'&&'📍',activity.type==='provider'&&'🎮',activity.type==='cabinet'&&'🎰']}),/*#__PURE__*/_jsxs(\"div\",{className:\"activity-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:activity.name}),\" was \",activity.action]}),/*#__PURE__*/_jsx(\"p\",{className:\"activity-date\",children:formatDateDDMMYYYY(activity.date)})]})]},index))})]})]});// Invoice Popup Component\nconst InvoicePopup=_ref17=>{let{invoice,onClose}=_ref17;if(!invoice)return null;// Find location, buyer and seller based on invoice data\nconst location=locations.find(location=>location.id===invoice.location_id);const buyer=companies.find(company=>company.id===invoice.buyer_id);const seller=providers.find(provider=>provider.id===invoice.seller_id);// Format amount in Romanian format (15.00,68)\nconst formatAmount=amount=>{if(!amount)return'0,00';const num=parseFloat(amount);if(isNaN(num))return'0,00';// Convert to string with 2 decimal places\nconst formatted=num.toFixed(2);// Split by decimal point\nconst parts=formatted.split('.');// Add thousands separator (.) and replace decimal point with comma\nconst integerPart=parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g,'.');return\"\".concat(integerPart,\",\").concat(parts[1]);};// Remove euro symbol from Denomin and Maxbet\nconst cleanDescription=description=>{if(!description)return'No description';return description.replace(/€/g,'')// Remove euro symbol\n.replace(/EUR/g,'')// Remove EUR text\n.replace(/\\s+/g,' ')// Remove extra spaces\n.trim();};return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content invoice-popup\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Invoice Details - \",invoice.invoice_number]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"invoice-details\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Invoice Number:\"}),/*#__PURE__*/_jsx(\"span\",{children:invoice.invoice_number})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Issue Date:\"}),/*#__PURE__*/_jsx(\"span\",{children:formatDateDDMMYYYY(invoice.issue_date)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Due Date:\"}),/*#__PURE__*/_jsx(\"span\",{children:formatDateDDMMYYYY(invoice.due_date)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[formatAmount(invoice.amount),\" \",invoice.currency||'EUR']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description:\"}),/*#__PURE__*/_jsx(\"span\",{children:cleanDescription(invoice.description)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge \".concat(invoice.status||'pending'),children:invoice.status||'Pending'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Serial Numbers:\"}),/*#__PURE__*/_jsx(\"span\",{children:invoice.serial_numbers||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Location:\"}),/*#__PURE__*/_jsx(\"span\",{children:location?location.name:'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Customer:\"}),/*#__PURE__*/_jsx(\"span\",{children:buyer?buyer.name:'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Seller:\"}),/*#__PURE__*/_jsx(\"span\",{children:seller?seller.name:'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Customer Contact Person:\"}),/*#__PURE__*/_jsx(\"span\",{children:buyer?buyer.contact_person:'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{marginRight:'8px',fontSize:'16px'},children:\"\\uD83D\\uDCE7\"}),buyer?buyer.email:'N/A']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{marginRight:'8px',fontSize:'16px'},children:\"\\uD83D\\uDCDE\"}),buyer?buyer.phone:'N/A']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Created At:\"}),/*#__PURE__*/_jsx(\"span\",{children:invoice.created_at?new Date(invoice.created_at).toLocaleString():'N/A'})]})]})})]})});};// Jackpot Popup Component\nconst JackpotPopup=_ref18=>{let{jackpots,onClose}=_ref18;return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Jackpot Details\"}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#3182ce',color:'white',borderRadius:'50%',width:'28px',height:'28px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'14px',fontWeight:'bold',minWidth:'28px'},children:jackpots.length})]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:jackpots.map((jackpot,index)=>{var _jackpot$jackpot_type;return/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:jackpot.jackpot_name||'No Name'}),/*#__PURE__*/_jsx(\"span\",{className:\"jackpot-type \".concat((_jackpot$jackpot_type=jackpot.jackpot_type)===null||_jackpot$jackpot_type===void 0?void 0:_jackpot$jackpot_type.toLowerCase()),children:jackpot.jackpot_type||'Unknown'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-details\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Serial Numbers\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:jackpot.serial_number||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Increment Percentage\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:typeof jackpot.increment_rate==='number'?\"\".concat(jackpot.increment_rate,\"%\"):'N/A'})]}),jackpot.level_1&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Level 1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:jackpot.level_1})]}),jackpot.level_2&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Level 2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:jackpot.level_2})]}),jackpot.level_3&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Level 3\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:jackpot.level_3})]}),jackpot.level_4&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Level 4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:jackpot.level_4})]}),jackpot.level_5&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Level 5\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:jackpot.level_5})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Created Date\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:jackpot.created_at?formatDateDDMMYYYY(jackpot.created_at):'N/A'})]})]}),(jackpot.description||jackpot.details)&&/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-description\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Description\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:jackpot.description||jackpot.details})]})]},jackpot.id);})})]})});};// Invoice Slots Popup Component\nconst InvoiceSlotsPopup=_ref19=>{let{slots,onClose}=_ref19;return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Invoice Slot Details\"}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#3182ce',color:'white',borderRadius:'50%',width:'28px',height:'28px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'14px',fontWeight:'bold',minWidth:'28px'},children:slots.length})]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:slots.map((slot,index)=>{var _slot$status;return/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-header\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Slot: \",slot.serial_number||'Unknown Serial']}),/*#__PURE__*/_jsx(\"span\",{className:\"jackpot-type \".concat((_slot$status=slot.status)===null||_slot$status===void 0?void 0:_slot$status.toLowerCase()),children:slot.status||'Unknown Status'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-details\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Provider\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:(()=>{const provider=providers.find(p=>p.id===slot.provider_id);return provider?provider.name:'Unknown Provider';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Location\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:(()=>{const location=locations.find(l=>l.id===slot.location_id);return location?location.name:'Unknown Location';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:(()=>{const gameMix=gameMixes.find(gm=>gm.id===slot.game_mix_id);return gameMix?gameMix.name:'Unknown Game Mix';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:(()=>{const cabinet=cabinets.find(c=>c.id===slot.cabinet_id);return cabinet?cabinet.name:'Unknown Cabinet';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Production Year\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:slot.production_year||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"RTP\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:slot.rtp?\"\".concat(slot.rtp,\"%\"):'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Max Bet\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:slot.max_bet||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Denomination\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:slot.denomination||'N/A'})]})]})]},slot.id);})})]})});};// Metrology Popup Component\nconst MetrologyPopup=_ref20=>{var _metrology$certificat;let{metrology,onClose}=_ref20;if(!metrology)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px'},children:/*#__PURE__*/_jsx(\"h2\",{children:\"Metrology Details\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-header\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Certificate: \",metrology.certificate_number||'No Certificate Number']}),/*#__PURE__*/_jsx(\"span\",{className:\"jackpot-type \".concat((_metrology$certificat=metrology.certificate_type)===null||_metrology$certificat===void 0?void 0:_metrology$certificat.toLowerCase()),children:metrology.certificate_type||'Unknown Type'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-details\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Serial Numbers\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:metrology.serial_number||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Issue Date\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:metrology.issue_date?formatDateDDMMYYYY(metrology.issue_date):'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Expiry Date\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:metrology.expiry_date?formatDateDDMMYYYY(metrology.expiry_date):'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Issuing Authority\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:metrology.issuing_authority||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Calibration Interval\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:\"N/A\"})]}),metrology.cvt_type&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"CVT Type\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:metrology.cvt_type})]}),metrology.cvt_expiry_date&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"CVT Expiry Date\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:formatDateDDMMYYYY(metrology.cvt_expiry_date)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Status\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:metrology.status||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Created Date\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:metrology.created_at?formatDateDDMMYYYY(metrology.created_at):'N/A'})]})]}),metrology.description&&/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-description\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-label\",children:\"Description\"}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-value\",children:metrology.description})]})]})})]})});};// Add CVT Date Popup Component\nconst AddCvtDatePopup=_ref21=>{let{onClose}=_ref21;const[formData,setFormData]=useState({serial_numbers:'',cvt_date:'',cvt_end_date:'',cvt_type:'periodic',provider_filter:'',cabinet_filter:'',game_mix_filter:'',license_date_filter:'',search_term:''});const[filteredSlots,setFilteredSlots]=useState([]);const[isSubmitting,setIsSubmitting]=useState(false);const[validationErrors,setValidationErrors]=useState({});const handleChange=(field,value)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));// Clear validation error when user starts typing\nif(validationErrors[field]){setValidationErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:null}));}};const validateForm=()=>{const errors={};const serialNumbers=formData.serial_numbers.split(' ').filter(sn=>sn.trim());if(!formData.serial_numbers.trim()){errors.serial_numbers='Serial numbers are required';}else if(serialNumbers.length===0){errors.serial_numbers='Please enter at least one valid serial number';}if(!formData.cvt_date){errors.cvt_date='CVT date is required';}if(!formData.cvt_end_date){errors.cvt_end_date='CVT end date is required';}else if(formData.cvt_date&&formData.cvt_end_date&&formData.cvt_end_date<=formData.cvt_date){errors.cvt_end_date='End date must be after start date';}setValidationErrors(errors);return Object.keys(errors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm()){return;}setIsSubmitting(true);try{const token=localStorage.getItem('token');const serialNumbers=formData.serial_numbers.split(' ').filter(sn=>sn.trim());// Create metrology records for each serial number\nconst promises=serialNumbers.map(async serialNumber=>{const metrologyData={serial_number:serialNumber.trim(),certificate_number:\"CVT-\".concat(serialNumber,\"-\").concat(new Date().getFullYear()),certificate_type:'calibration',issue_date:formData.cvt_date,issuing_authority:'ANM',cvt_expiry_date:formData.cvt_end_date,cvt_type:formData.cvt_type,status:'active',description:\"CVT \".concat(formData.cvt_type,\" certificate for \").concat(serialNumber)};const response=await fetch(\"\".concat(API,\"/metrology\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify(metrologyData)});if(!response.ok){throw new Error(\"Failed to create CVT for \".concat(serialNumber));}return response.json();});await Promise.all(promises);showCustomNotification(\"\\u2705 Successfully created CVT records for \".concat(serialNumbers.length,\" slot(s)!\"),'success');onClose();fetchDashboardData();// Refresh data\n}catch(error){console.error('Error creating CVT records:',error);showCustomNotification(\"\\u274C Error creating CVT records: \".concat(error.message),'error');}finally{setIsSubmitting(false);}};// Filter slots based on search criteria\nuseEffect(()=>{let filtered=slotMachines.filter(slot=>slot.status==='active');if(formData.provider_filter){filtered=filtered.filter(slot=>slot.provider_id===formData.provider_filter);}if(formData.cabinet_filter){filtered=filtered.filter(slot=>slot.cabinet_id===formData.cabinet_filter);}if(formData.game_mix_filter){filtered=filtered.filter(slot=>slot.game_mix_id===formData.game_mix_filter);}if(formData.license_date_filter){filtered=filtered.filter(slot=>slot.commission_date===formData.license_date_filter);}if(formData.search_term){const searchLower=formData.search_term.toLowerCase();filtered=filtered.filter(slot=>slot.serial_number.toLowerCase().includes(searchLower));}setFilteredSlots(filtered);},[formData,slotMachines]);const selectedSerials=formData.serial_numbers.split(' ').filter(sn=>sn.trim());return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",style:{maxWidth:'1000px',width:'95vw',maxHeight:'90vh',overflow:'auto',background:'var(--bg-secondary)',borderRadius:'16px',boxShadow:'0 25px 50px rgba(0,0,0,0.4)',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",style:{background:'linear-gradient(135deg, var(--bg-primary) 0%, var(--accent-color) 100%)',borderBottom:'2px solid var(--border-color)',padding:'24px 32px',borderRadius:'16px 16px 0 0',display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,color:'var(--text-primary)',fontSize:'1.8rem',fontWeight:'bold',textShadow:'0 2px 4px rgba(0,0,0,0.3)'},children:\"\\uD83D\\uDD27 CVT Metrology Administration\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,style:{background:'rgba(255,255,255,0.1)',border:'1px solid rgba(255,255,255,0.2)',fontSize:'1.8rem',cursor:'pointer',color:'var(--text-primary)',padding:'8px 12px',borderRadius:'8px',transition:'all 0.3s ease',backdropFilter:'blur(10px)'},onMouseOver:e=>{e.target.style.background='rgba(255,255,255,0.2)';e.target.style.transform='scale(1.1)';},onMouseOut:e=>{e.target.style.background='rgba(255,255,255,0.1)';e.target.style.transform='scale(1)';},children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"modal-form\",style:{padding:'32px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%)',padding:'24px',borderRadius:'12px',marginBottom:'24px',border:'2px solid var(--border-color)',boxShadow:'0 4px 12px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 16px 0',color:'var(--text-primary)',fontSize:'1.3rem',fontWeight:'bold',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u26A1 Quick Actions\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'16px',flexWrap:'wrap',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>{const allSerials=filteredSlots.map(slot=>slot.serial_number).join(' ');handleChange('serial_numbers',allSerials);},style:{background:'linear-gradient(135deg, var(--accent-color) 0%, #0056b3 100%)',color:'white',border:'none',padding:'12px 20px',borderRadius:'8px',cursor:'pointer',fontSize:'1rem',fontWeight:'bold',transition:'all 0.3s ease',boxShadow:'0 4px 8px rgba(0,0,0,0.2)'},onMouseOver:e=>{e.target.style.transform='translateY(-2px)';e.target.style.boxShadow='0 6px 12px rgba(0,0,0,0.3)';},onMouseOut:e=>{e.target.style.transform='translateY(0)';e.target.style.boxShadow='0 4px 8px rgba(0,0,0,0.2)';},children:[\"\\uD83D\\uDCCB Select All (\",filteredSlots.length,\")\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleChange('serial_numbers',''),style:{background:'linear-gradient(135deg, var(--danger-color) 0%, #c53030 100%)',color:'white',border:'none',padding:'12px 20px',borderRadius:'8px',cursor:'pointer',fontSize:'1rem',fontWeight:'bold',transition:'all 0.3s ease',boxShadow:'0 4px 8px rgba(0,0,0,0.2)'},onMouseOver:e=>{e.target.style.transform='translateY(-2px)';e.target.style.boxShadow='0 6px 12px rgba(0,0,0,0.3)';},onMouseOut:e=>{e.target.style.transform='translateY(0)';e.target.style.boxShadow='0 4px 8px rgba(0,0,0,0.2)';},children:\"\\uD83D\\uDDD1\\uFE0F Clear All\"}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',padding:'12px 16px',borderRadius:'8px',border:'1px solid var(--border-color)',display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'1.2rem'},children:\"\\uD83C\\uDFAF\"}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'var(--text-primary)',fontSize:'1rem',fontWeight:'bold'},children:[\"Selected: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--accent-color)'},children:selectedSerials.length}),\" slot(s)\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%)',padding:'24px',borderRadius:'12px',marginBottom:'24px',border:'2px solid var(--border-color)',boxShadow:'0 4px 12px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 20px 0',color:'var(--text-primary)',fontSize:'1.3rem',fontWeight:'bold',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDD0D Advanced Filters\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(250px, 1fr))',gap:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'var(--text-primary)',marginBottom:'8px',display:'block',fontSize:'1rem',fontWeight:'bold'},children:\"\\uD83C\\uDFE2 Provider\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.provider_filter,onChange:e=>handleChange('provider_filter',e.target.value),style:{width:'100%',padding:'14px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'1rem',transition:'all 0.3s ease',cursor:'pointer'},onFocus:e=>{e.target.style.borderColor='var(--accent-color)';e.target.style.boxShadow='0 0 0 3px rgba(0, 212, 255, 0.1)';},onBlur:e=>{e.target.style.borderColor='var(--border-color)';e.target.style.boxShadow='none';},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uD83C\\uDF10 All Providers\"}),providers.map(provider=>/*#__PURE__*/_jsxs(\"option\",{value:provider.id,children:[\"\\uD83C\\uDFE2 \",provider.name]},provider.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'var(--text-primary)',marginBottom:'8px',display:'block',fontSize:'1rem',fontWeight:'bold'},children:\"\\uD83C\\uDFB0 Cabinet\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.cabinet_filter,onChange:e=>handleChange('cabinet_filter',e.target.value),style:{width:'100%',padding:'14px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'1rem',transition:'all 0.3s ease',cursor:'pointer'},onFocus:e=>{e.target.style.borderColor='var(--accent-color)';e.target.style.boxShadow='0 0 0 3px rgba(0, 212, 255, 0.1)';},onBlur:e=>{e.target.style.borderColor='var(--border-color)';e.target.style.boxShadow='none';},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uD83C\\uDFB0 All Cabinets\"}),cabinets.map(cabinet=>/*#__PURE__*/_jsxs(\"option\",{value:cabinet.id,children:[\"\\uD83C\\uDFB0 \",cabinet.name]},cabinet.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'var(--text-primary)',marginBottom:'8px',display:'block',fontSize:'1rem',fontWeight:'bold'},children:\"\\uD83C\\uDFAE Game Mix\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.game_mix_filter,onChange:e=>handleChange('game_mix_filter',e.target.value),style:{width:'100%',padding:'14px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'1rem',transition:'all 0.3s ease',cursor:'pointer'},onFocus:e=>{e.target.style.borderColor='var(--accent-color)';e.target.style.boxShadow='0 0 0 3px rgba(0, 212, 255, 0.1)';},onBlur:e=>{e.target.style.borderColor='var(--border-color)';e.target.style.boxShadow='none';},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uD83C\\uDFAE All Game Mixes\"}),gameMixes.map(gameMix=>/*#__PURE__*/_jsxs(\"option\",{value:gameMix.id,children:[\"\\uD83C\\uDFAE \",gameMix.name]},gameMix.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'var(--text-primary)',marginBottom:'8px',display:'block',fontSize:'1rem',fontWeight:'bold'},children:\"\\uD83D\\uDCC5 License Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.license_date_filter,onChange:e=>handleChange('license_date_filter',e.target.value),style:{width:'100%',padding:'14px 16px',border:'2px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'1rem',transition:'all 0.3s ease'},onFocus:e=>{e.target.style.borderColor='var(--accent-color)';e.target.style.boxShadow='0 0 0 3px rgba(0, 212, 255, 0.1)';},onBlur:e=>{e.target.style.borderColor='var(--border-color)';e.target.style.boxShadow='none';}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginTop:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'var(--text-primary)',marginBottom:'8px',display:'block',fontSize:'1rem',fontWeight:'bold'},children:\"\\uD83D\\uDD0D Search Serial Numbers\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.search_term,onChange:e=>handleChange('search_term',e.target.value),placeholder:\"\\uD83D\\uDD0D Enter serial numbers to search...\",style:{width:'100%',padding:'16px 20px',border:'2px solid var(--border-color)',borderRadius:'10px',background:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'1.1rem',transition:'all 0.3s ease'},onFocus:e=>{e.target.style.borderColor='var(--accent-color)';e.target.style.boxShadow='0 0 0 3px rgba(0, 212, 255, 0.1)';e.target.style.transform='scale(1.02)';},onBlur:e=>{e.target.style.borderColor='var(--border-color)';e.target.style.boxShadow='none';e.target.style.transform='scale(1)';}})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%)',padding:'24px',borderRadius:'12px',marginBottom:'24px',border:'2px solid var(--border-color)',boxShadow:'0 4px 12px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 20px 0',color:'var(--text-primary)',fontSize:'1.3rem',fontWeight:'bold',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDCCB CVT Information\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(280px, 1fr))',gap:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'var(--text-primary)',marginBottom:'8px',display:'block',fontSize:'1rem',fontWeight:'bold'},children:\"\\uD83C\\uDFB0 Slot Serial Numbers *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.serial_numbers,onChange:e=>handleChange('serial_numbers',e.target.value),placeholder:\"\\uD83C\\uDFB0 Enter serial numbers separated by spaces (e.g., SN001 SN002 SN003)\",rows:\"4\",required:true,style:{width:'100%',padding:'16px 20px',border:validationErrors.serial_numbers?'3px solid #ff4444':'2px solid var(--border-color)',borderRadius:'10px',background:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'1.1rem',resize:'vertical',transition:'all 0.3s ease',fontFamily:'monospace'},onFocus:e=>{if(!validationErrors.serial_numbers){e.target.style.borderColor='var(--accent-color)';e.target.style.boxShadow='0 0 0 3px rgba(0, 212, 255, 0.1)';}},onBlur:e=>{if(!validationErrors.serial_numbers){e.target.style.borderColor='var(--border-color)';e.target.style.boxShadow='none';}}}),validationErrors.serial_numbers&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#ff4444',fontSize:'0.9rem',marginTop:'8px',padding:'8px 12px',background:'rgba(255, 68, 68, 0.1)',borderRadius:'6px',border:'1px solid rgba(255, 68, 68, 0.3)'},children:[\"\\u26A0\\uFE0F \",validationErrors.serial_numbers]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'8px',padding:'8px 12px',background:'var(--bg-primary)',borderRadius:'6px',border:'1px solid var(--border-color)'},children:/*#__PURE__*/_jsxs(\"small\",{style:{color:'var(--text-secondary)',fontSize:'0.9rem',fontWeight:'bold'},children:[\"\\uD83D\\uDCCA Available slots: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--accent-color)'},children:filteredSlots.length})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'var(--text-primary)',marginBottom:'8px',display:'block',fontSize:'1rem',fontWeight:'bold'},children:\"\\uD83D\\uDCC5 CVT Start Date *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.cvt_date,onChange:e=>handleChange('cvt_date',e.target.value),required:true,style:{width:'100%',padding:'16px 20px',border:validationErrors.cvt_date?'3px solid #ff4444':'2px solid var(--border-color)',borderRadius:'10px',background:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'1.1rem',transition:'all 0.3s ease'},onFocus:e=>{if(!validationErrors.cvt_date){e.target.style.borderColor='var(--accent-color)';e.target.style.boxShadow='0 0 0 3px rgba(0, 212, 255, 0.1)';}},onBlur:e=>{if(!validationErrors.cvt_date){e.target.style.borderColor='var(--border-color)';e.target.style.boxShadow='none';}}}),validationErrors.cvt_date&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#ff4444',fontSize:'0.9rem',marginTop:'8px',padding:'8px 12px',background:'rgba(255, 68, 68, 0.1)',borderRadius:'6px',border:'1px solid rgba(255, 68, 68, 0.3)'},children:[\"\\u26A0\\uFE0F \",validationErrors.cvt_date]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'var(--text-primary)',marginBottom:'8px',display:'block',fontSize:'1rem',fontWeight:'bold'},children:\"\\uD83D\\uDCC5 CVT End Date *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.cvt_end_date,onChange:e=>handleChange('cvt_end_date',e.target.value),required:true,style:{width:'100%',padding:'16px 20px',border:validationErrors.cvt_end_date?'3px solid #ff4444':'2px solid var(--border-color)',borderRadius:'10px',background:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'1.1rem',transition:'all 0.3s ease'},onFocus:e=>{if(!validationErrors.cvt_end_date){e.target.style.borderColor='var(--accent-color)';e.target.style.boxShadow='0 0 0 3px rgba(0, 212, 255, 0.1)';}},onBlur:e=>{if(!validationErrors.cvt_end_date){e.target.style.borderColor='var(--border-color)';e.target.style.boxShadow='none';}}}),validationErrors.cvt_end_date&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#ff4444',fontSize:'0.9rem',marginTop:'8px',padding:'8px 12px',background:'rgba(255, 68, 68, 0.1)',borderRadius:'6px',border:'1px solid rgba(255, 68, 68, 0.3)'},children:[\"\\u26A0\\uFE0F \",validationErrors.cvt_end_date]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'var(--text-primary)',marginBottom:'8px',display:'block',fontSize:'1rem',fontWeight:'bold'},children:\"\\uD83D\\uDD27 CVT Type *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.cvt_type,onChange:e=>handleChange('cvt_type',e.target.value),required:true,style:{width:'100%',padding:'16px 20px',border:'2px solid var(--border-color)',borderRadius:'10px',background:'var(--bg-secondary)',color:'var(--text-primary)',fontSize:'1.1rem',transition:'all 0.3s ease',cursor:'pointer'},onFocus:e=>{e.target.style.borderColor='var(--accent-color)';e.target.style.boxShadow='0 0 0 3px rgba(0, 212, 255, 0.1)';},onBlur:e=>{e.target.style.borderColor='var(--border-color)';e.target.style.boxShadow='none';},children:[/*#__PURE__*/_jsx(\"option\",{value:\"periodic\",children:\"\\uD83D\\uDD04 Periodic Verification\"}),/*#__PURE__*/_jsx(\"option\",{value:\"reparation\",children:\"\\uD83D\\uDD27 Reparation Verification\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%)',padding:'24px',borderRadius:'12px',marginBottom:'24px',border:'2px solid var(--border-color)',boxShadow:'0 4px 12px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 20px 0',color:'var(--text-primary)',fontSize:'1.3rem',fontWeight:'bold',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83C\\uDFB0 Available Slots\"}),/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'300px',overflow:'auto',border:'2px solid var(--border-color)',padding:'20px',borderRadius:'10px',background:'var(--bg-secondary)',boxShadow:'inset 0 2px 4px rgba(0,0,0,0.1)'},children:filteredSlots.length===0?/*#__PURE__*/_jsxs(\"div\",{style:{color:'var(--text-secondary)',fontStyle:'italic',textAlign:'center',padding:'40px 20px',background:'var(--bg-primary)',borderRadius:'8px',border:'2px dashed var(--border-color)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'3rem',marginBottom:'16px'},children:\"\\uD83D\\uDD0D\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'1.2rem',fontWeight:'bold',marginBottom:'8px'},children:\"No slots match the current filters\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'1rem'},children:\"Try adjusting your search criteria\"})]}):/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(160px, 1fr))',gap:'12px'},children:filteredSlots.map(slot=>/*#__PURE__*/_jsx(\"div\",{style:{padding:'12px 16px',border:selectedSerials.includes(slot.serial_number)?'3px solid var(--accent-color)':'2px solid var(--border-color)',borderRadius:'10px',fontSize:'1rem',cursor:'pointer',backgroundColor:selectedSerials.includes(slot.serial_number)?'var(--accent-color)':'var(--bg-primary)',color:selectedSerials.includes(slot.serial_number)?'white':'var(--text-primary)',transition:'all 0.3s ease',textAlign:'center',fontWeight:selectedSerials.includes(slot.serial_number)?'bold':'normal',boxShadow:selectedSerials.includes(slot.serial_number)?'0 4px 12px rgba(0, 212, 255, 0.3)':'0 2px 4px rgba(0,0,0,0.1)',transform:selectedSerials.includes(slot.serial_number)?'scale(1.05)':'scale(1)'},onClick:()=>{const currentSerials=formData.serial_numbers.split(' ').filter(sn=>sn.trim());if(currentSerials.includes(slot.serial_number)){// Remove if already selected\nconst newSerials=currentSerials.filter(sn=>sn!==slot.serial_number);handleChange('serial_numbers',newSerials.join(' '));}else{// Add if not selected\nconst newSerials=[...currentSerials,slot.serial_number];handleChange('serial_numbers',newSerials.join(' '));}},onMouseOver:e=>{if(!selectedSerials.includes(slot.serial_number)){e.target.style.background='var(--bg-hover)';e.target.style.transform='scale(1.02)';e.target.style.boxShadow='0 4px 8px rgba(0,0,0,0.2)';}},onMouseOut:e=>{if(!selectedSerials.includes(slot.serial_number)){e.target.style.background='var(--bg-primary)';e.target.style.transform='scale(1)';e.target.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)';}},children:slot.serial_number},slot.id))})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'16px',justifyContent:'flex-end',padding:'24px 0 0 0',borderTop:'2px solid var(--border-color)',marginTop:'24px'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,style:{background:'linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%)',color:'var(--text-primary)',border:'2px solid var(--border-color)',padding:'16px 32px',borderRadius:'10px',cursor:'pointer',fontSize:'1.1rem',fontWeight:'bold',transition:'all 0.3s ease',boxShadow:'0 4px 8px rgba(0,0,0,0.1)'},onMouseOver:e=>{e.target.style.background='linear-gradient(135deg, var(--bg-hover) 0%, var(--bg-secondary) 100%)';e.target.style.transform='translateY(-2px)';e.target.style.boxShadow='0 6px 12px rgba(0,0,0,0.2)';},onMouseOut:e=>{e.target.style.background='linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%)';e.target.style.transform='translateY(0)';e.target.style.boxShadow='0 4px 8px rgba(0,0,0,0.1)';},children:\"\\u274C Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isSubmitting,style:{background:isSubmitting?'linear-gradient(135deg, var(--text-secondary) 0%, #666 100%)':'linear-gradient(135deg, var(--accent-color) 0%, #0056b3 100%)',color:'white',border:'none',padding:'16px 32px',borderRadius:'10px',cursor:isSubmitting?'not-allowed':'pointer',fontSize:'1.1rem',fontWeight:'bold',transition:'all 0.3s ease',opacity:isSubmitting?0.7:1,boxShadow:isSubmitting?'0 2px 4px rgba(0,0,0,0.1)':'0 4px 12px rgba(0, 212, 255, 0.3)'},onMouseOver:e=>{if(!isSubmitting){e.target.style.transform='translateY(-2px)';e.target.style.boxShadow='0 6px 16px rgba(0, 212, 255, 0.4)';}},onMouseOut:e=>{if(!isSubmitting){e.target.style.transform='translateY(0)';e.target.style.boxShadow='0 4px 12px rgba(0, 212, 255, 0.3)';}},children:isSubmitting?'⏳ Creating CVT Records...':'✅ Create CVT Records'})]})]})]})});};// Report Details Modal Component\nconst ReportDetailsModal=_ref22=>{let{report,onClose}=_ref22;if(!report)return null;const renderCommissionDateDetails=()=>{const serials=report.serial_numbers?report.serial_numbers.split(/\\s+/).filter(s=>s.trim()):[];const associatedSlots=slotMachines.filter(slot=>serials.includes(slot.serial_number));// Funcție pentru a găsi informațiile asociate\nconst getSlotDetails=slot=>{const location=locations.find(loc=>loc.id===slot.location_id);const provider=providers.find(prov=>prov.id===slot.provider_id);const cabinet=cabinets.find(cab=>cab.id===slot.cabinet_id);const gameMix=gameMixes.find(gm=>gm.id===slot.game_mix_id);const metrology=metrologyData.find(met=>met.serial_number===slot.serial_number);const jackpot=jackpots.find(jp=>jp.serial_number===slot.serial_number);return{location:(location===null||location===void 0?void 0:location.name)||'N/A',provider:(provider===null||provider===void 0?void 0:provider.name)||'N/A',cabinet:(cabinet===null||cabinet===void 0?void 0:cabinet.name)||'N/A',gameMix:(gameMix===null||gameMix===void 0?void 0:gameMix.name)||'N/A',gamingPlaces:slot.gaming_places||'N/A',cvtDate:metrology!==null&&metrology!==void 0&&metrology.expiry_date?formatDateDDMMYYYY(metrology.expiry_date):'N/A',jackpot:jackpot?\"\".concat(jackpot.jackpot_name,\" (\").concat(jackpot.jackpot_type,\")\"):'N/A'};};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{color:'#3182ce',marginBottom:'20px',borderBottom:'2px solid #3182ce',paddingBottom:'10px'},children:[\"\\uD83D\\uDCC5 Commission Date Details: \",report.event_name||'Unnamed Event']}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'20px',marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83D\\uDCC5 Commission Date:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:formatDateDDMMYYYY(report.commission_date)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83D\\uDCCA Number of Slots:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:serials.length})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83D\\uDCDD Created:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:formatDateDDMMYYYY(report.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83D\\uDC64 Created by:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:(()=>{const user=Array.isArray(users)?users.find(u=>u.id===report.created_by||u.username===report.created_by):null;return user?\"\".concat(user.first_name,\" \").concat(user.last_name):report.created_by||'Unknown';})()})]})]}),associatedSlots.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{style:{color:'#3182ce',marginBottom:'15px'},children:\"\\uD83C\\uDFB0 Slot Details for Each Serial Number\"}),/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'400px',overflowY:'auto',border:'1px solid #e5e7eb',borderRadius:'8px',padding:'10px'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',fontSize:'13px'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:'#f1f5f9',borderBottom:'2px solid #e2e8f0'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px 6px',textAlign:'left',fontWeight:'bold',color:'var(--text-primary)',borderBottom:'1px solid #e2e8f0',fontSize:'12px'},children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px 6px',textAlign:'left',fontWeight:'bold',color:'var(--text-primary)',borderBottom:'1px solid #e2e8f0',fontSize:'12px'},children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px 6px',textAlign:'left',fontWeight:'bold',color:'var(--text-primary)',borderBottom:'1px solid #e2e8f0',fontSize:'12px'},children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px 6px',textAlign:'left',fontWeight:'bold',color:'var(--text-primary)',borderBottom:'1px solid #e2e8f0',fontSize:'12px'},children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px 6px',textAlign:'left',fontWeight:'bold',color:'var(--text-primary)',borderBottom:'1px solid #e2e8f0',fontSize:'12px'},children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px 6px',textAlign:'left',fontWeight:'bold',color:'var(--text-primary)',borderBottom:'1px solid #e2e8f0',fontSize:'12px'},children:\"Gaming Places\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px 6px',textAlign:'left',fontWeight:'bold',color:'var(--text-primary)',borderBottom:'1px solid #e2e8f0',fontSize:'12px'},children:\"CVT Date of End\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'10px 6px',textAlign:'left',fontWeight:'bold',color:'var(--text-primary)',borderBottom:'1px solid #e2e8f0',fontSize:'12px'},children:\"Jackpots\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:associatedSlots.map((slot,index)=>{const details=getSlotDetails(slot);return/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:index%2===0?'#ffffff':'#f8fafc',borderBottom:'1px solid #e2e8f0'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px 6px',fontWeight:'normal',color:'var(--text-primary)',fontSize:'12px'},children:slot.serial_number}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px 6px',color:'var(--text-secondary)',fontSize:'12px'},children:details.location}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px 6px',color:'var(--text-secondary)',fontSize:'12px'},children:details.provider}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px 6px',color:'var(--text-secondary)',fontSize:'12px'},children:details.cabinet}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px 6px',color:'var(--text-secondary)',fontSize:'12px'},children:details.gameMix}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px 6px',color:'var(--text-secondary)',fontSize:'12px'},children:details.gamingPlaces}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px 6px',color:'var(--text-secondary)',fontSize:'12px'},children:details.cvtDate}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px 6px',color:'var(--text-secondary)',fontSize:'12px'},children:details.jackpot})]},slot.id);})})]})})]})]});};const renderOnjnReportDetails=()=>{const serials=report.serial_numbers?report.serial_numbers.split(/\\s+/).filter(s=>s.trim()):[];return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{color:'#3182ce',marginBottom:'20px',borderBottom:'2px solid #3182ce',paddingBottom:'10px'},children:\"\\uD83D\\uDCCB ONJN Report Details\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'20px',marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83D\\uDCCB Event Name:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:report.report_number})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83D\\uDCC4 Report Type:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:report.report_type})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83D\\uDC64 Persona de care a fost creat:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:(()=>{const user=Array.isArray(users)?users.find(u=>u.id===report.created_by||u.username===report.created_by):null;return user?\"\".concat(user.first_name,\" \").concat(user.last_name):report.created_by||'N/A';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83D\\uDCBC Transaction Type:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:report.transaction_type||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83D\\uDCC5 Report Date:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:formatDateDDMMYYYY(report.report_date)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\u23F3 Status:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:report.submission_date?\"\\u2705 Submitted: \".concat(formatDateDDMMYYYY(report.submission_date)):'⏳ Not submitted'})]}),report.serial_numbers&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83C\\uDFB0 Serial Numbers:\"}),/*#__PURE__*/_jsx(\"p\",{style:{wordBreak:'break-all',color:'var(--text-secondary)'},children:report.serial_numbers})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:\"\\uD83D\\uDCCA Number of Slots:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)'},children:serials.length})]})]})]})]});};return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{color:'var(--text-primary)'},children:report.type==='comision_date'?'Commission Date Details':'ONJN Report Details'}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#3182ce',color:'white',borderRadius:'50%',width:'28px',height:'28px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'14px',fontWeight:'bold',minWidth:'28px'},children:report.type==='comision_date'?'📅':'📋'})]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,style:{background:'none',border:'none',fontSize:'24px',cursor:'pointer',color:'#666'},children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:report.type==='comision_date'?renderCommissionDateDetails():renderOnjnReportDetails()}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-footer\",children:/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{backgroundColor:'#3182ce',color:'white',border:'none',padding:'10px 20px',borderRadius:'6px',cursor:'pointer',fontWeight:'bold'},children:\"Close\"})})]})});};// Commission Date Details Page Component\nconst CommissionDateDetailsPage=_ref23=>{let{commissionDate,onClose}=_ref23;if(!commissionDate)return null;const serials=commissionDate.serial_numbers?commissionDate.serial_numbers.split(/\\s+/).filter(s=>s.trim()):[];const associatedSlots=slotMachines.filter(slot=>serials.includes(slot.serial_number));// Funcție pentru a găsi informațiile asociate\nconst getSlotDetails=slot=>{const location=locations.find(loc=>loc.id===slot.location_id);const provider=providers.find(prov=>prov.id===slot.provider_id);const cabinet=cabinets.find(cab=>cab.id===slot.cabinet_id);const gameMix=gameMixes.find(gm=>gm.id===slot.game_mix_id);const metrologyItem=metrology.find(met=>met.serial_number===slot.serial_number);const jackpot=jackpots.find(jp=>jp.serial_number===slot.serial_number);const user=Array.isArray(users)?users.find(u=>u.username===commissionDate.created_by):null;return{location:(location===null||location===void 0?void 0:location.name)||'N/A',provider:(provider===null||provider===void 0?void 0:provider.name)||'N/A',cabinet:(cabinet===null||cabinet===void 0?void 0:cabinet.name)||'N/A',gameMix:(gameMix===null||gameMix===void 0?void 0:gameMix.name)||'N/A',gamingPlaces:slot.gaming_places||'N/A',cvtDate:metrologyItem!==null&&metrologyItem!==void 0&&metrologyItem.expiry_date?formatDateDDMMYYYY(metrologyItem.expiry_date):'N/A',jackpot:jackpot?\"\".concat(jackpot.jackpot_name,\" (\").concat(jackpot.jackpot_type,\")\"):'N/A',createdBy:user?\"\".concat(user.first_name,\" \").concat(user.last_name):commissionDate.created_by||'Unknown'};};return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:[\"\\uD83D\\uDCC5 \",commissionDate.event_name||'Unnamed Event']}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCC5 Commission Date:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:formatDateDDMMYYYY(commissionDate.commission_date)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCCA Number of Slots:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:serials.length})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFAE Total Gaming Places:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:associatedSlots.reduce((total,slot)=>total+(parseInt(slot.gaming_places)||0),0)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCDD Created:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:formatDateDDMMYYYY(commissionDate.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDC64 Created by:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:getSlotDetails({}).createdBy})]})]})]}),associatedSlots.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0'},children:\"\\uD83C\\uDFB0 Slot Details for Each Serial Number\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('Export button clicked');console.log('Associated slots:',associatedSlots);if(!associatedSlots||associatedSlots.length===0){console.log('No slots to export');return;}const data=associatedSlots.map((slot,index)=>{const details=getSlotDetails(slot);console.log('Slot details:',details);return{'ID':index+1,'Serial Number':slot.serial_number||'N/A','Location':details.location||'N/A','Provider':details.provider||'N/A','Cabinet':details.cabinet||'N/A','Game Mix':details.gameMix||'N/A','Gaming Places':details.gamingPlaces||'N/A','CVT Date of End':details.cvtDate||'N/A','Jackpots':details.jackpot||'N/A'};});console.log('Export data:',data);// Create CSV content\nconst headers=Object.keys(data[0]||{});const csvContent=[headers.join(','),...data.map(row=>headers.map(header=>\"\\\"\".concat(row[header],\"\\\"\")).join(','))].join('\\n');console.log('CSV content:',csvContent);// Create and download file\nconst blob=new Blob([csvContent],{type:'text/csv;charset=utf-8;'});const link=document.createElement('a');const url=URL.createObjectURL(blob);link.setAttribute('href',url);link.setAttribute('download',\"\".concat(commissionDate.event_name||'Commission_Date',\"_\").concat(formatDateDDMMYYYY(commissionDate.commission_date),\".csv\"));link.style.visibility='hidden';document.body.appendChild(link);link.click();document.body.removeChild(link);console.log('Export completed');},style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDCCA Export to XLS\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'600px',overflowY:'auto',border:'1px solid var(--border-color)',borderRadius:'8px'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:'var(--bg-tertiary)',borderBottom:'2px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Gaming Places\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"CVT Date of End\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Jackpots\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:associatedSlots.map((slot,index)=>{const details=getSlotDetails(slot);return/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:index%2===0?'var(--bg-secondary)':'var(--bg-tertiary)',borderBottom:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontWeight:'normal',color:'var(--text-primary)',fontSize:'13px'},children:index+1}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontWeight:'normal',color:'var(--text-primary)',fontSize:'13px'},children:slot.serial_number}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',color:'var(--text-secondary)',fontSize:'13px'},children:details.location}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',color:'var(--text-secondary)',fontSize:'13px'},children:details.provider}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',color:'var(--text-secondary)',fontSize:'13px'},children:details.cabinet}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',color:'var(--text-secondary)',fontSize:'13px'},children:details.gameMix}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',color:'var(--text-secondary)',fontSize:'13px'},children:details.gamingPlaces}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',color:'var(--text-secondary)',fontSize:'13px'},children:details.cvtDate}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',color:'var(--text-secondary)',fontSize:'13px'},children:details.jackpot})]},slot.id);})})]})})]})]})})})})});};// Game Table Page Component\nconst GameTablePage=_ref24=>{let{onClose,gamesData,theme,fetchGamesData}=_ref24;const[searchTerm,setSearchTerm]=useState('');// Debug logging\nconsole.log('🔍 GameTablePage render - searchTerm:',searchTerm);console.log('🔍 GameTablePage render - gamesData:',gamesData);if(!gamesData||!gamesData.gamesDatabase){return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:\"\\uD83D\\uDCCA Game Table\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>fetchGamesData&&fetchGamesData(true),style:{background:'var(--gradient-accent)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDD04 Refresh\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]})]}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'0'},children:\"Loading games data...\"})]})})})})})});}const games=gamesData.gamesDatabase;// Filter games based on search term\nconst filteredGames=searchTerm.trim()===''?games:games.filter(game=>{var _game$game_name,_game$provider,_game$game_type,_game$theme,_game$game_mechanic,_game$volatility,_game$product,_game$classification,_game$layout,_game$lines,_game$id,_game$game_provider_i,_game$game_type_sub_c;const searchLower=searchTerm.toLowerCase();console.log('🔍 Filtering games with search term:',searchTerm,'lowercase:',searchLower);return((_game$game_name=game.game_name)===null||_game$game_name===void 0?void 0:_game$game_name.toLowerCase().includes(searchLower))||((_game$provider=game.provider)===null||_game$provider===void 0?void 0:_game$provider.toLowerCase().includes(searchLower))||((_game$game_type=game.game_type)===null||_game$game_type===void 0?void 0:_game$game_type.toLowerCase().includes(searchLower))||((_game$theme=game.theme)===null||_game$theme===void 0?void 0:_game$theme.toLowerCase().includes(searchLower))||((_game$game_mechanic=game.game_mechanic)===null||_game$game_mechanic===void 0?void 0:_game$game_mechanic.toLowerCase().includes(searchLower))||((_game$volatility=game.volatility)===null||_game$volatility===void 0?void 0:_game$volatility.toLowerCase().includes(searchLower))||((_game$product=game.product)===null||_game$product===void 0?void 0:_game$product.toLowerCase().includes(searchLower))||((_game$classification=game.classification)===null||_game$classification===void 0?void 0:_game$classification.toLowerCase().includes(searchLower))||((_game$layout=game.layout)===null||_game$layout===void 0?void 0:_game$layout.toLowerCase().includes(searchLower))||((_game$lines=game.lines)===null||_game$lines===void 0?void 0:_game$lines.toString().includes(searchLower))||((_game$id=game.id)===null||_game$id===void 0?void 0:_game$id.toLowerCase().includes(searchLower))||((_game$game_provider_i=game.game_provider_id)===null||_game$game_provider_i===void 0?void 0:_game$game_provider_i.toLowerCase().includes(searchLower))||((_game$game_type_sub_c=game.game_type_sub_category)===null||_game$game_type_sub_c===void 0?void 0:_game$game_type_sub_c.toLowerCase().includes(searchLower));});console.log('🔍 Filtered games count:',filteredGames.length,'of',games.length);return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:\"\\uD83D\\uDCCA Game Table\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>fetchGamesData&&fetchGamesData(true),style:{background:'var(--gradient-accent)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDD04 Refresh\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]})]}),/*#__PURE__*/_jsxs(\"p\",{style:{color:'var(--text-secondary)',margin:'0',marginBottom:'16px'},children:[\"Total Games: \",filteredGames.length,\" of \",games.length]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative',flex:'1',maxWidth:'400px'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uD83D\\uDD0D Search games by name, provider, theme, type, etc...\",value:searchTerm,onChange:e=>{console.log('🔍 Search input changed:',e.target.value);setSearchTerm(e.target.value);},style:{width:'100%',padding:'12px 16px 12px 44px',border:'1px solid var(--border-color)',borderRadius:'8px',background:'var(--bg-primary)',color:'var(--text-primary)',fontSize:'14px',outline:'none'}}),/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:'16px',top:'50%',transform:'translateY(-50%)',color:'var(--text-secondary)',fontSize:'16px'},children:\"\\uD83D\\uDD0D\"})]}),searchTerm&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSearchTerm(''),style:{background:'var(--bg-primary)',color:'var(--text-secondary)',border:'1px solid var(--border-color)',borderRadius:'8px',padding:'8px 12px',cursor:'pointer',fontSize:'14px',fontWeight:'500'},children:\"Clear\"})]}),searchTerm&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px',color:'var(--text-secondary)',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDD0D\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Showing \",filteredGames.length,\" of \",games.length,\" games\"]}),filteredGames.length!==games.length&&/*#__PURE__*/_jsxs(\"span\",{style:{color:'var(--accent-color)'},children:[\"(filtered by \\\"\",searchTerm,\"\\\")\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)'},children:/*#__PURE__*/_jsx(\"div\",{style:{overflowX:'auto'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',color:'var(--text-primary)'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{background:'var(--bg-primary)',borderBottom:'2px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Game ID\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Game Name\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Game Provider ID\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Game Type Sub Category\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Game Type\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Product\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Classification\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Game Mechanic\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Theme\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Volatility\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Lines\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Layout\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Link\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredGames.map((game,index)=>/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)',background:index%2===0?'var(--bg-primary)':'var(--bg-secondary)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.id}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px',fontWeight:'500'},children:game.game_name}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.provider}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.game_provider_id}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.game_type_sub_category}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.game_type}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.product}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.classification}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.game_mechanic}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.theme}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.volatility}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.lines}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:game.layout}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'13px'},children:/*#__PURE__*/_jsx(\"a\",{href:game.link,target:\"_blank\",rel:\"noopener noreferrer\",style:{color:'var(--accent-color)',textDecoration:'underline',wordBreak:'break-all'},children:\"View Image\"})})]},game.id||index))})]})})})]})})})})});};// Game Mix Games Page Component\nconst GameMixGamesPage=_ref25=>{let{gameMix,onClose,gamesData,gameAvatars,setSelectedGameForDetails,setShowGameDetailsPage,setShowGameMixGamesPage}=_ref25;if(!gameMix)return null;// Funcție pentru a obține jocurile din Game Mix\nconst getGames=()=>{if(!gameMix.games)return[];if(Array.isArray(gameMix.games))return gameMix.games;return gameMix.games.split(',').map(g=>g.trim());};const games=getGames();const provider=useMemo(()=>providers.find(p=>p.id===gameMix.provider_id),[providers,gameMix.provider_id]);return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:[\"\\uD83C\\uDFAE \",gameMix.name||'Unnamed Game Mix']}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFAF Number of Games:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:games.length})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFE2 Provider:\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px',marginTop:'4px'},children:[(()=>{// Pentru EGT, folosește logo-ul online direct\nif((provider===null||provider===void 0?void 0:provider.name)==='EGT'){return/*#__PURE__*/_jsx(\"img\",{src:\"https://www.egt-bg.ro/images/logo-egt-nou-cropped.svg\",alt:\"EGT Logo\",style:{width:'40px',height:'40px',borderRadius:'50%',objectFit:'cover',border:'2px solid var(--border-color)'}});}// Pentru restul providerilor, folosește logica normală\nconst[providerAvatar,setProviderAvatar]=useState(null);useEffect(()=>{if(gameMix.provider_id&&!providerAvatar){const fetchProviderAvatar=async()=>{try{const response=await fetch(\"\".concat(API,\"/attachments/providers/\").concat(gameMix.provider_id),{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const attachments=await response.json();const avatarAttachment=attachments.find(att=>att.mime_type.startsWith('image/')&&(att.filename.includes('avatar')||att.filename.includes('custom_avatar')));if(avatarAttachment){setProviderAvatar(avatarAttachment);}}}catch(error){console.error('Error fetching provider avatar:',error);}};fetchProviderAvatar();}},[]);if(providerAvatar){return/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(providerAvatar.mime_type,\";base64,\").concat(providerAvatar.file_data),alt:\"Provider Avatar\",style:{width:'40px',height:'40px',borderRadius:'50%',objectFit:'cover',border:'2px solid var(--border-color)'}});}return/*#__PURE__*/_jsx(\"div\",{style:{width:'40px',height:'40px',borderRadius:'50%',background:'#3182ce',color:'white',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'12px',fontWeight:'normal',border:'2px solid var(--border-color)'},children:provider!==null&&provider!==void 0&&provider.name?provider.name.substring(0,2).toUpperCase():'PR'});})(),/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--text-secondary)'},children:(provider===null||provider===void 0?void 0:provider.name)||'Unknown Provider'})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0 0 20px 0'},children:[\"\\uD83C\\uDFB0 Games (\",games.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(200px, 1fr))',gap:'20px'},children:games.map((gameName,index)=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>{setSelectedGameForDetails(gameName);setShowGameDetailsPage(true);setShowGameMixGamesPage(false);// Add breadcrumb for game details from game mix\naddBreadcrumb(gameName,'🎯',()=>{setShowGameDetailsPage(true);setSelectedGameForDetails(gameName);});},style:{background:'var(--bg-primary)',borderRadius:'12px',padding:'16px',border:'1px solid var(--border-color)',cursor:'pointer',transition:'transform 0.2s ease-in-out'},onMouseEnter:e=>e.target.style.transform='scale(1.02)',onMouseLeave:e=>e.target.style.transform='scale(1)',children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'191.844px',height:'277.094px',margin:'0 auto 12px auto',display:'flex',alignItems:'center',justifyContent:'center',overflow:'hidden',borderRadius:'8px'},children:(()=>{// Use smart matching system like in GamesPage\nconst gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;if(gameData&&gameData.link){console.log(\"\\u2705 Found logo for \".concat(gameName,\" via smart matching:\"),gameData.link);return/*#__PURE__*/_jsx(\"img\",{src:gameData.link,alt:\"\".concat(gameName,\" Logo\"),style:{width:'100%',height:'100%',objectFit:'cover'},onError:e=>{console.log(\"\\u274C Image failed to load for \".concat(gameName));if(e.target&&e.target.style){e.target.style.display='none';}if(e.target&&e.target.nextSibling&&e.target.nextSibling.style){e.target.nextSibling.style.display='flex';}}});}console.log(\"\\u274C No logo found for \".concat(gameName,\" via smart matching\"));// Fallback to gameAvatars if available\nif(gameAvatars[gameName]){return/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(gameAvatars[gameName].mime_type,\";base64,\").concat(gameAvatars[gameName].file_data),alt:\"\".concat(gameName,\" Avatar\"),style:{width:'100%',height:'100%',objectFit:'cover'}});}// Default emoji if no image available\nreturn/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'48px'},children:\"\\uD83C\\uDFB0\"});})()}),/*#__PURE__*/_jsx(\"h3\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'16px',fontWeight:'600',textAlign:'center'},children:gameName})]},index))})]})]})})})})});};// Jackpot Details Page Component\nconst JackpotDetailsPage=_ref26=>{let{jackpot,onClose}=_ref26;if(!jackpot)return null;// Funcție pentru a găsi toate sloturile asociate cu acest jackpot\nconst getAssociatedSlots=()=>{return slotMachines.filter(slot=>slot.serial_number===jackpot.serial_number);};// Funcție pentru a obține detaliile unui slot\nconst getSlotDetails=slot=>{const location=locations.find(loc=>loc.id===(slot===null||slot===void 0?void 0:slot.location_id));const provider=providers.find(prov=>prov.id===(slot===null||slot===void 0?void 0:slot.provider_id));const cabinet=cabinets.find(cab=>cab.id===(slot===null||slot===void 0?void 0:slot.cabinet_id));const gameMix=gameMixes.find(gm=>gm.id===(slot===null||slot===void 0?void 0:slot.game_mix_id));return{id:slot.id||slot._id,serialNumber:slot.serial_number||'N/A',location:(location===null||location===void 0?void 0:location.name)||'N/A',provider:(provider===null||provider===void 0?void 0:provider.name)||'N/A',cabinet:(cabinet===null||cabinet===void 0?void 0:cabinet.name)||'N/A',gameMix:(gameMix===null||gameMix===void 0?void 0:gameMix.name)||'N/A',gamingPlaces:(slot===null||slot===void 0?void 0:slot.gaming_places)||'N/A',cvtEndDate:slot!==null&&slot!==void 0&&slot.cvt_end_date?formatDateDDMMYYYY(slot.cvt_end_date):'N/A'};};const associatedSlots=getAssociatedSlots();const slotDetails=associatedSlots.map(getSlotDetails);// Funcție pentru export XLS\nconst handleExportToXLS=()=>{const data=slotDetails.map((slot,index)=>({'ID':index+1,'Serial Number':slot.serialNumber,'Location':slot.location,'Provider':slot.provider,'Cabinet':slot.cabinet,'Game Mix':slot.gameMix,'Gaming Places':slot.gamingPlaces,'CVT Date of End':slot.cvtEndDate,'Jackpots':jackpot.jackpot_name}));const ws=XLSX.utils.json_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'Jackpot Slots');const fileName=\"jackpot_\".concat(jackpot.jackpot_name,\"_slots_\").concat(formatDateDDMMYYYY(new Date()),\".xlsx\");XLSX.writeFile(wb,fileName);};return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:[\"\\uD83C\\uDFB0 \",jackpot.jackpot_name||'Unnamed Jackpot']}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFB0 Jackpot Type:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:jackpot.jackpot_type})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCCA Increment Rate:\"}),/*#__PURE__*/_jsxs(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:[jackpot.increment_rate,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFAF Serial Number:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:jackpot.serial_number})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCDD Created:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:formatDateDDMMYYYY(jackpot.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDC64 Created by:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const user=Array.isArray(users)?users.find(u=>u.username===jackpot.created_by):null;return user?\"\".concat(user.first_name,\" \").concat(user.last_name):jackpot.created_by||'Unknown';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\u23F0 Last Reset:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:formatDateDDMMYYYY(jackpot.last_reset_date)})]})]})]}),(jackpot.level_1||jackpot.level_2||jackpot.level_3||jackpot.level_4||jackpot.level_5)&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0 0 20px 0'},children:\"\\uD83C\\uDFC6 Jackpot Levels\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(150px, 1fr))',gap:'16px'},children:[jackpot.level_1&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',background:'var(--bg-tertiary)',borderRadius:'8px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'12px'},children:\"Level 1:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0',fontSize:'14px'},children:jackpot.level_1})]}),jackpot.level_2&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',background:'var(--bg-tertiary)',borderRadius:'8px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'12px'},children:\"Level 2:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0',fontSize:'14px'},children:jackpot.level_2})]}),jackpot.level_3&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',background:'var(--bg-tertiary)',borderRadius:'8px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'12px'},children:\"Level 3:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0',fontSize:'14px'},children:jackpot.level_3})]}),jackpot.level_4&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',background:'var(--bg-tertiary)',borderRadius:'8px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'12px'},children:\"Level 4:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0',fontSize:'14px'},children:jackpot.level_4})]}),jackpot.level_5&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',background:'var(--bg-tertiary)',borderRadius:'8px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'12px'},children:\"Level 5:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0',fontSize:'14px'},children:jackpot.level_5})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0'},children:\"\\uD83C\\uDFB0 Slot Details for Each Serial Number\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleExportToXLS,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDCCA Export to XLS\"})]}),slotDetails.length>0?/*#__PURE__*/_jsx(\"div\",{style:{overflowX:'auto'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',color:'var(--text-primary)'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{background:'var(--bg-tertiary)',borderBottom:'2px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Gaming Places\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"CVT Date of End\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Jackpots\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:slotDetails.map((slot,index)=>/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)',background:index%2===0?'var(--bg-secondary)':'var(--bg-tertiary)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:index+1}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.serialNumber}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.location}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.provider}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.cabinet}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.gameMix}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.gamingPlaces}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.cvtEndDate}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:jackpot.jackpot_name})]},slot.id))})]})}):/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-secondary)',fontSize:'16px'},children:\"No associated slots found for this jackpot.\"})]})]})})})})});};// Metrology Details Page Component\nconst MetrologyDetailsPage=_ref27=>{let{metrology,onClose}=_ref27;if(!metrology)return null;// Funcție pentru a găsi toate sloturile asociate cu acest CVT\nconst getAssociatedSlots=()=>{if(!metrology.serial_number)return[];// Try both newline and space separation\nconst serialNumbersNewline=metrology.serial_number.split('\\n').filter(s=>s.trim());const serialNumbersSpace=metrology.serial_number.split(' ').filter(s=>s.trim());// Use the one that has more items (more likely to be correct)\nconst serialNumbers=serialNumbersNewline.length>serialNumbersSpace.length?serialNumbersNewline:serialNumbersSpace;return slotMachines.filter(slot=>serialNumbers.includes(slot.serial_number));};// Funcție pentru a obține detaliile unui slot\nconst getSlotDetails=slot=>{const location=locations.find(loc=>loc.id===(slot===null||slot===void 0?void 0:slot.location_id));const provider=providers.find(prov=>prov.id===(slot===null||slot===void 0?void 0:slot.provider_id));const cabinet=cabinets.find(cab=>cab.id===(slot===null||slot===void 0?void 0:slot.cabinet_id));const gameMix=gameMixes.find(gm=>gm.id===(slot===null||slot===void 0?void 0:slot.game_mix_id));return{id:slot.id||slot._id,serialNumber:slot.serial_number||'N/A',location:(location===null||location===void 0?void 0:location.name)||'N/A',provider:(provider===null||provider===void 0?void 0:provider.name)||'N/A',cabinet:(cabinet===null||cabinet===void 0?void 0:cabinet.name)||'N/A',gameMix:(gameMix===null||gameMix===void 0?void 0:gameMix.name)||'N/A',gamingPlaces:(slot===null||slot===void 0?void 0:slot.gaming_places)||'N/A',cvtEndDate:metrology!==null&&metrology!==void 0&&metrology.cvt_expiry_date?formatDateDDMMYYYY(metrology.cvt_expiry_date):'N/A'};};const associatedSlots=getAssociatedSlots();const slotDetails=associatedSlots.map(getSlotDetails);// Funcție pentru export XLS\nconst handleExportToXLS=()=>{const data=slotDetails.map((slot,index)=>({'ID':index+1,'Serial Number':slot.serialNumber,'Location':slot.location,'Provider':slot.provider,'Cabinet':slot.cabinet,'Game Mix':slot.gameMix,'Gaming Places':slot.gamingPlaces,'CVT Date of End':slot.cvtEndDate,'CVT Certificate':metrology.certificate_number}));const ws=XLSX.utils.json_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'CVT Slots');const fileName=\"cvt_\".concat(metrology.certificate_number,\"_slots_\").concat(formatDateDDMMYYYY(new Date()),\".xlsx\");XLSX.writeFile(wb,fileName);};return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:[\"\\uD83D\\uDCCB \",metrology.certificate_number||'Unnamed CVT Certificate']}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCCB Certificate Number:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:metrology.certificate_number})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCC5 Issue Date:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:formatDateDDMMYYYY(metrology.issue_date)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFE2 Issuing Authority:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:metrology.issuing_authority})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCDD Status:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:metrology.status})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDC64 Created by:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const user=Array.isArray(users)?users.find(u=>u.username===metrology.created_by):null;return user?\"\".concat(user.first_name,\" \").concat(user.last_name):metrology.created_by||'Unknown';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCC5 Created:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:formatDateDDMMYYYY(metrology.created_at)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0'},children:\"\\uD83C\\uDFB0 Slot Details for Each Serial Number\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleExportToXLS,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDCCA Export to XLS\"})]}),slotDetails.length>0?/*#__PURE__*/_jsx(\"div\",{style:{overflowX:'auto'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',color:'var(--text-primary)'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{background:'var(--bg-tertiary)',borderBottom:'2px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"Gaming Places\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"CVT Date of End\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',fontWeight:'600',fontSize:'14px',borderBottom:'1px solid var(--border-color)'},children:\"CVT Certificate\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:slotDetails.map((slot,index)=>/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)',background:index%2===0?'var(--bg-secondary)':'var(--bg-tertiary)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:index+1}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.serialNumber}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.location}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.provider}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.cabinet}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.gameMix}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.gamingPlaces}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:slot.cvtEndDate}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px',fontSize:'14px',color:'var(--text-secondary)'},children:metrology.certificate_number})]},slot.id))})]})}):/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-secondary)',fontSize:'16px'},children:\"No associated slots found for this CVT certificate.\"})]})]})})})})});};// Location Details Page Component\nconst LocationDetailsPage=_ref28=>{let{location,onClose}=_ref28;if(!location)return null;// Funcție pentru a găsi toate sloturile din această sală\nconst getLocationSlots=()=>{return slotMachines.filter(slot=>slot.location_id===location.id);};// Funcție pentru a obține detaliile unui slot\nconst getSlotDetails=slot=>{const provider=providers.find(prov=>prov.id===(slot===null||slot===void 0?void 0:slot.provider_id));const cabinet=cabinets.find(cab=>cab.id===(slot===null||slot===void 0?void 0:slot.cabinet_id));const gameMix=gameMixes.find(gm=>gm.id===(slot===null||slot===void 0?void 0:slot.game_mix_id));const company=companies.find(comp=>comp.id===(slot===null||slot===void 0?void 0:slot.owner_company_id));const creator=users.find(u=>u.id===(slot===null||slot===void 0?void 0:slot.created_by)||u.username===(slot===null||slot===void 0?void 0:slot.created_by));const modifier=users.find(u=>u.id===(slot===null||slot===void 0?void 0:slot.updated_by)||u.username===(slot===null||slot===void 0?void 0:slot.updated_by));return{id:slot.id||slot._id,serialNumber:slot.serial_number||'N/A',location:(location===null||location===void 0?void 0:location.name)||'N/A',provider:(provider===null||provider===void 0?void 0:provider.name)||'N/A',cabinet:(cabinet===null||cabinet===void 0?void 0:cabinet.name)||'N/A',gameMix:(gameMix===null||gameMix===void 0?void 0:gameMix.name)||'N/A',gamingPlaces:(slot===null||slot===void 0?void 0:slot.gaming_places)||'N/A',ownershipType:(slot===null||slot===void 0?void 0:slot.ownership_type)||'N/A',productionYear:(slot===null||slot===void 0?void 0:slot.production_year)||'N/A',rtp:(slot===null||slot===void 0?void 0:slot.rtp)||'N/A',cvtEndDate:(()=>{const associatedMetrology=metrology.filter(mt=>{if(!mt.serial_number)return false;const metrologySerialNumbers=mt.serial_number.split(/\\s+/).filter(s=>s.trim());return metrologySerialNumbers.includes(slot.serial_number);});if(associatedMetrology.length===0)return'No CVT';if(associatedMetrology.length===1){return associatedMetrology[0].cvt_expiry_date?formatDateDDMMYYYY(associatedMetrology[0].cvt_expiry_date):'No End Date';}return\"Multiple CVT (\".concat(associatedMetrology.length,\")\");})(),jackpotName:(()=>{const associatedJackpots=jackpots.filter(jp=>{if(!jp.serial_number)return false;const jackpotSerialNumbers=jp.serial_number.split(/\\s+/).filter(s=>s.trim());return jackpotSerialNumbers.includes(slot.serial_number);});if(associatedJackpots.length===0)return'No Jackpot';if(associatedJackpots.length===1){return associatedJackpots[0].jackpot_name||'No Name';}return\"Multiple Jackpots (\".concat(associatedJackpots.length,\")\");})(),commissionDate:(()=>{const associatedComisionDates=comisionDates.filter(cd=>{if(!cd.serial_numbers)return false;const comisionSerialNumbers=cd.serial_numbers.split(/\\s+/).filter(s=>s.trim());return comisionSerialNumbers.includes(slot.serial_number);});if(associatedComisionDates.length===0)return'No Commission Date';if(associatedComisionDates.length===1){return formatDateDDMMYYYY(associatedComisionDates[0].commission_date);}return\"Multiple Dates (\".concat(associatedComisionDates.length,\")\");})(),createdBy:creator&&creator.first_name&&creator.last_name?\"\".concat(creator.first_name,\" \").concat(creator.last_name):creator?creator.username:(slot===null||slot===void 0?void 0:slot.created_by)||'Unknown',modifiedBy:modifier&&modifier.first_name&&modifier.last_name?\"\".concat(modifier.first_name,\" \").concat(modifier.last_name):modifier?modifier.username:(slot===null||slot===void 0?void 0:slot.updated_by)||'N/A',createdAt:slot!==null&&slot!==void 0&&slot.created_at?formatDateDDMMYYYY(slot.created_at):'N/A'};};const locationSlots=getLocationSlots();const slotDetails=locationSlots.map(getSlotDetails);// Funcție pentru export XLS\nconst handleExportToXLS=()=>{const data=slotDetails.map((slot,index)=>({'ID':index+1,'Serial Number':slot.serialNumber,'Location':slot.location,'Provider':slot.provider,'Cabinet':slot.cabinet,'Game Mix':slot.gameMix,'Gaming Places':slot.gamingPlaces,'Ownership Type':slot.ownershipType,'Production Year':slot.productionYear,'RTP':slot.rtp,'CVT End Date':slot.cvtEndDate,'Jackpot Name':slot.jackpotName,'Commission Date':slot.commissionDate,'Created By':slot.createdBy,'Modified By':slot.modifiedBy,'Created At':slot.createdAt}));const ws=XLSX.utils.json_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'Location Slots');const fileName=\"location_\".concat(location.name,\"_slots_\").concat(formatDateDDMMYYYY(new Date()),\".xlsx\");XLSX.writeFile(wb,fileName);};return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:[\"\\uD83C\\uDFE2 \",location.name||'Unnamed Location']}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFE2 Location Name:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:location.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCCD Address:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:location.address||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCCA Number of Slots:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:locationSlots.length})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFAE Total Gaming Places:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:locationSlots.reduce((total,slot)=>total+(parseInt(slot.gaming_places)||0),0)})]})]})]}),locationSlots.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0'},children:[\"\\uD83C\\uDFB0 All Slots in \",location.name]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleExportToXLS,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDCCA Export to XLS\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Gaming Places\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ownership Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Production Year\"}),/*#__PURE__*/_jsx(\"th\",{children:\"RTP\"}),/*#__PURE__*/_jsx(\"th\",{children:\"CVT End Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Jackpot Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Commission Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Created By\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Modified By\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Created At\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:slotDetails.map((slot,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:slot.serialNumber}),/*#__PURE__*/_jsx(\"td\",{children:slot.provider}),/*#__PURE__*/_jsx(\"td\",{children:slot.cabinet}),/*#__PURE__*/_jsx(\"td\",{children:slot.gameMix}),/*#__PURE__*/_jsx(\"td\",{children:slot.gamingPlaces}),/*#__PURE__*/_jsx(\"td\",{children:slot.ownershipType}),/*#__PURE__*/_jsx(\"td\",{children:slot.productionYear}),/*#__PURE__*/_jsx(\"td\",{children:slot.rtp}),/*#__PURE__*/_jsx(\"td\",{children:slot.cvtEndDate}),/*#__PURE__*/_jsx(\"td\",{children:slot.jackpotName}),/*#__PURE__*/_jsx(\"td\",{children:slot.commissionDate}),/*#__PURE__*/_jsx(\"td\",{children:slot.createdBy}),/*#__PURE__*/_jsx(\"td\",{children:slot.modifiedBy}),/*#__PURE__*/_jsx(\"td\",{children:slot.createdAt})]},index))})]})})]})]})})})})});};// Invoice Details Page Component\nconst InvoiceDetailsPage=_ref29=>{let{invoice,onClose}=_ref29;if(!invoice)return null;// Funcție pentru a găsi toate sloturile asociate cu acest invoice\nconst getAssociatedSlots=()=>{if(!invoice.serial_numbers)return[];// Try both newline and space separation\nconst serialNumbersNewline=invoice.serial_numbers.split('\\n').filter(s=>s.trim());const serialNumbersSpace=invoice.serial_numbers.split(' ').filter(s=>s.trim());// Use the one that has more items (more likely to be correct)\nconst serialNumbers=serialNumbersNewline.length>serialNumbersSpace.length?serialNumbersNewline:serialNumbersSpace;return slotMachines.filter(slot=>serialNumbers.includes(slot.serial_number));};// Funcție pentru a obține detaliile unui slot\nconst getSlotDetails=slot=>{const location=locations.find(loc=>loc.id===(slot===null||slot===void 0?void 0:slot.location_id));const provider=providers.find(prov=>prov.id===(slot===null||slot===void 0?void 0:slot.provider_id));const cabinet=cabinets.find(cab=>cab.id===(slot===null||slot===void 0?void 0:slot.cabinet_id));const gameMix=gameMixes.find(gm=>gm.id===(slot===null||slot===void 0?void 0:slot.game_mix_id));return{id:slot.id||slot._id,serialNumber:slot.serial_number||'N/A',location:(location===null||location===void 0?void 0:location.name)||'N/A',provider:(provider===null||provider===void 0?void 0:provider.name)||'N/A',cabinet:(cabinet===null||cabinet===void 0?void 0:cabinet.name)||'N/A',gameMix:(gameMix===null||gameMix===void 0?void 0:gameMix.name)||'N/A',gamingPlaces:(slot===null||slot===void 0?void 0:slot.gaming_places)||'N/A',invoiceNumber:(invoice===null||invoice===void 0?void 0:invoice.invoice_number)||'N/A'};};const associatedSlots=getAssociatedSlots();const slotDetails=associatedSlots.map(getSlotDetails);// Funcție pentru export XLS\nconst handleExportToXLS=()=>{const data=slotDetails.map((slot,index)=>({'ID':index+1,'Serial Number':slot.serialNumber,'Location':slot.location,'Provider':slot.provider,'Cabinet':slot.cabinet,'Game Mix':slot.gameMix,'Gaming Places':slot.gamingPlaces,'Invoice Number':slot.invoiceNumber}));const ws=XLSX.utils.json_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'Invoice Slots');const fileName=\"invoice_\".concat(invoice.invoice_number,\"_slots_\").concat(formatDateDDMMYYYY(new Date()),\".xlsx\");XLSX.writeFile(wb,fileName);};return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:[\"\\uD83D\\uDCC4 \",invoice.invoice_number||'Unnamed Invoice']}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCC4 Invoice Number:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:invoice.invoice_number})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFE2 Company:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:invoice.company_name||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCC5 Issue Date:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:invoice.issue_date?formatDateDDMMYYYY(invoice.issue_date):'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCC5 Due Date:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:invoice.due_date?formatDateDDMMYYYY(invoice.due_date):'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCB0 Amount:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:invoice.amount?\"\".concat(invoice.amount,\" RON\"):'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCCA Status:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:invoice.status||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCDD Description:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:invoice.description||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDC64 Created by:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:(()=>{const user=Array.isArray(users)?users.find(u=>u.username===invoice.created_by):null;return user?\"\".concat(user.first_name,\" \").concat(user.last_name):invoice.creator_name||'Unknown';})()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCBC Transaction Type:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:invoice.transaction_type||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCC5 Created:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:invoice.created_at?formatDateDDMMYYYY(invoice.created_at):'N/A'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'20px',fontWeight:'600'},children:[\"\\uD83C\\uDFB0 Slot Details for Each Serial Number (\",slotDetails.length,\")\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleExportToXLS,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDCCA Export to XLS\"})]}),slotDetails.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Gaming Places\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Invoice Number\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:slotDetails.map((slot,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:slot.serialNumber}),/*#__PURE__*/_jsx(\"td\",{children:slot.location}),/*#__PURE__*/_jsx(\"td\",{children:slot.provider}),/*#__PURE__*/_jsx(\"td\",{children:slot.cabinet}),/*#__PURE__*/_jsx(\"td\",{children:slot.gameMix}),/*#__PURE__*/_jsx(\"td\",{children:slot.gamingPlaces}),/*#__PURE__*/_jsx(\"td\",{children:slot.invoiceNumber})]},slot.id))})]})}):/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-secondary)',fontSize:'16px'},children:\"No associated slots found for this invoice.\"})]})]})})})})});};// Provider Details Page Component\nconst ProviderDetailsPage=_ref30=>{let{provider,onClose}=_ref30;if(!provider)return null;// Find all slots associated with this provider\nconst associatedSlots=slotMachines.filter(slot=>slot.provider_id===provider.id);// Find all game mixes associated with this provider\nconst associatedGameMixes=gameMixes.filter(mix=>mix.provider_id===provider.id);return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:[\"\\uD83C\\uDFE2 \",provider.name||'Unnamed Provider']}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFE2 Provider Name:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:provider.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCE7 Email:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:provider.email||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCF1 Phone:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:provider.phone||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDF0D Country:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:provider.country||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCC5 Created:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:provider.created_at?formatDateDDMMYYYY(provider.created_at):'N/A'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',margin:'0 0 20px 0',fontSize:'20px',fontWeight:'600'},children:[\"\\uD83C\\uDFB0 Associated Slots (\",associatedSlots.length,\")\"]}),associatedSlots.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Gaming Places\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:associatedSlots.map(slot=>{const location=locations.find(loc=>loc.id===slot.location_id);const gameMix=gameMixes.find(gm=>gm.id===slot.game_mix_id);const cabinet=cabinets.find(cab=>cab.id===slot.cabinet_id);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:slot.serial_number}),/*#__PURE__*/_jsx(\"td\",{children:(location===null||location===void 0?void 0:location.name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:(gameMix===null||gameMix===void 0?void 0:gameMix.name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:(cabinet===null||cabinet===void 0?void 0:cabinet.name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:slot.gaming_places||'N/A'})]},slot.id);})})]})}):/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-secondary)',fontSize:'16px'},children:\"No slots found for this provider.\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',margin:'0 0 20px 0',fontSize:'20px',fontWeight:'600'},children:[\"\\uD83C\\uDFAE Associated Game Mixes (\",associatedGameMixes.length,\")\"]}),associatedGameMixes.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Game Mix Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Games Count\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Created\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:associatedGameMixes.map(mix=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:mix.name}),/*#__PURE__*/_jsx(\"td\",{children:mix.games?Array.isArray(mix.games)?mix.games.length:mix.games.split(',').length:0}),/*#__PURE__*/_jsx(\"td\",{children:mix.created_at?formatDateDDMMYYYY(mix.created_at):'N/A'})]},mix.id))})]})}):/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-secondary)',fontSize:'16px'},children:\"No game mixes found for this provider.\"})]})]})})})})});};// Game Mix Details Page Component\nconst GameMixDetailsPage=_ref31=>{let{gameMix,onClose,gamesData,gameAvatars,theme,gamesViewMode,setGamesViewMode,addBreadcrumb}=_ref31;if(!gameMix)return null;// Function to get all slots that use this game mix\nconst getAssociatedSlots=()=>{return slotMachines.filter(slot=>slot.game_mix_id===gameMix.id);};// Function to get games in this mix\nconst getGamesInMix=()=>{if(!gameMix.games)return[];if(Array.isArray(gameMix.games)){return gameMix.games;}else if(typeof gameMix.games==='string'){return gameMix.games.split(',').map(g=>g.trim()).filter(g=>g);}return[];};const associatedSlots=getAssociatedSlots();const gamesInMix=getGamesInMix();// Use games view mode from props with default fallback\nconst currentViewMode=gamesViewMode||'grid';return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'24px'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',fontSize:'24px',fontWeight:'600',margin:'0',display:'flex',alignItems:'center',gap:'8px'},children:[\"\\uD83C\\uDFB2 \",gameMix.name,\" - Game Mix Details\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--primary-color)',color:'white',border:'none',borderRadius:'8px',padding:'10px 16px',fontSize:'14px',fontWeight:'500',cursor:'pointer',display:'flex',alignItems:'center',gap:'6px',transition:'all 0.2s ease'},onMouseEnter:e=>e.target.style.opacity='0.9',onMouseLeave:e=>e.target.style.opacity='1',children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',border:'1px solid var(--border-color)',marginBottom:'24px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",style:{width:'100%'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{width:'80px',textAlign:'center',padding:'16px 8px'},children:\"\\uD83C\\uDFB0\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'120px',padding:'16px 12px'},children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'150px',padding:'16px 12px'},children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'150px',padding:'16px 12px'},children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'150px',padding:'16px 12px'},children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'120px',padding:'16px 12px'},children:\"Gaming Places\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'100px',padding:'16px 12px'},children:\"Status\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:associatedSlots.length>0?associatedSlots.map((slot,index)=>{const location=locations.find(l=>l.id===slot.location_id);const provider=providers.find(p=>p.id===slot.provider_id);const cabinet=cabinets.find(c=>c.id===slot.cabinet_id);return/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)',transition:'background-color 0.2s ease'},onMouseEnter:e=>e.target.parentElement.style.backgroundColor='var(--bg-primary)',onMouseLeave:e=>e.target.parentElement.style.backgroundColor='transparent',children:[/*#__PURE__*/_jsx(\"td\",{style:{textAlign:'center',padding:'12px 8px',verticalAlign:'middle'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:'60px',height:'60px',margin:'0 auto',display:'flex',alignItems:'center',justifyContent:'center',background:'var(--bg-primary)',borderRadius:'8px',border:'1px solid var(--border-color)'},children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'24px'},children:\"\\uD83C\\uDFB0\"})})}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',fontWeight:'500',color:'var(--text-primary)',fontFamily:'monospace',fontSize:'13px'},children:slot.serial_number||'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:location?location.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:provider?provider.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:cabinet?cabinet.name:'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)',textAlign:'center'},children:slot.gaming_places||'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',textAlign:'center'},children:/*#__PURE__*/_jsx(\"span\",{style:{background:'var(--success-color)',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'12px',fontWeight:'500'},children:\"Active\"})})]},slot.id||index);}):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\",style:{textAlign:'center',padding:'40px 20px',color:'var(--text-secondary)',fontSize:'16px'},children:\"No slots found using this game mix.\"})})})]})})}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',margin:'0'},children:[\"\\uD83C\\uDFAE Games in \",gameMix.name]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setGamesViewMode('grid'),style:{background:currentViewMode==='grid'?'var(--primary-color)':'var(--bg-primary)',color:currentViewMode==='grid'?'white':'var(--text-secondary)',border:'1px solid var(--border-color)',borderRadius:'6px',padding:'8px 12px',fontSize:'12px',fontWeight:'500',cursor:'pointer',transition:'all 0.2s ease'},children:\"\\uD83D\\uDDBC\\uFE0F Grid\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setGamesViewMode('list'),style:{background:currentViewMode==='list'?'var(--primary-color)':'var(--bg-primary)',color:currentViewMode==='list'?'white':'var(--text-secondary)',border:'1px solid var(--border-color)',borderRadius:'6px',padding:'8px 12px',fontSize:'12px',fontWeight:'500',cursor:'pointer',transition:'all 0.2s ease'},children:\"\\uD83D\\uDCCB List\"})]})]}),gamesInMix.length>0?currentViewMode==='grid'?/*#__PURE__*/// Grid View - Original layout\n_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(250px, 1fr))',gap:'16px'},children:gamesInMix.map((gameName,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-primary)',borderRadius:'12px',padding:'16px',border:'1px solid var(--border-color)',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'100px',height:'140px',margin:'0 auto 12px auto',display:'flex',alignItems:'center',justifyContent:'center',overflow:'hidden',borderRadius:'8px',background:'var(--bg-secondary)',border:'1px solid var(--border-color)'},children:(()=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;if(gameData&&gameData.link){return/*#__PURE__*/_jsx(\"img\",{src:gameData.link,alt:\"\".concat(gameName,\" Logo\"),style:{width:'100%',height:'100%',objectFit:'contain'},onError:e=>{e.target.style.display='none';if(e.target&&e.target.nextSibling&&e.target.nextSibling.style){e.target.nextSibling.style.display='flex';}}});}return/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'24px'},children:\"\\uD83C\\uDFB0\"});})()}),/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'14px',fontWeight:'600',color:'var(--text-primary)',margin:'0',textAlign:'center'},children:gameName})]},index))}):/*#__PURE__*/// List View - Table format\n_jsx(\"div\",{style:{background:'var(--bg-primary)',borderRadius:'8px',border:'1px solid var(--border-color)',overflow:'hidden'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{background:'var(--bg-secondary)',borderBottom:'2px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"th\",{style:{width:'80px',textAlign:'center',padding:'16px 8px',color:'var(--text-primary)',fontWeight:'600'},children:\"\\uD83C\\uDFB0\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'16px 12px',textAlign:'left',color:'var(--text-primary)',fontWeight:'600'},children:\"Game Name\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'16px 12px',textAlign:'left',color:'var(--text-primary)',fontWeight:'600'},children:\"Classification\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'16px 12px',textAlign:'left',color:'var(--text-primary)',fontWeight:'600'},children:\"Theme\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'16px 12px',textAlign:'left',color:'var(--text-primary)',fontWeight:'600'},children:\"Volatility\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:gamesInMix.map((gameName,index)=>{const gameData=gamesData.findGameBySmartMatching?gamesData.findGameBySmartMatching(gameName):gamesData.gamesMap?gamesData.gamesMap[gameName]:null;return/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)',transition:'background-color 0.2s ease'},onMouseEnter:e=>e.target.parentElement.style.backgroundColor='var(--bg-secondary)',onMouseLeave:e=>e.target.parentElement.style.backgroundColor='transparent',children:[/*#__PURE__*/_jsx(\"td\",{style:{textAlign:'center',padding:'12px 8px',verticalAlign:'middle'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:'60px',height:'60px',margin:'0 auto',display:'flex',alignItems:'center',justifyContent:'center',background:'var(--bg-secondary)',borderRadius:'8px',border:'1px solid var(--border-color)',overflow:'hidden'},children:gameData&&gameData.link?/*#__PURE__*/_jsx(\"img\",{src:gameData.link,alt:\"\".concat(gameName,\" Logo\"),style:{width:'100%',height:'100%',objectFit:'contain'},onError:e=>{e.target.style.display='none';if(e.target&&e.target.nextSibling&&e.target.nextSibling.style){e.target.nextSibling.style.display='flex';}}}):/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'20px'},children:\"\\uD83C\\uDFB0\"})})}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-primary)',fontWeight:'500'},children:gameName}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:gameData?gameData.classification||'N/A':'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:gameData?gameData.theme||'N/A':'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 12px',color:'var(--text-secondary)'},children:gameData?gameData.volatility||'N/A':'N/A'})]},index);})})]})}):/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-secondary)',fontSize:'16px'},children:\"No games found in this mix.\"})]})]})})})})});};// Cabinet Details Page Component\nconst CabinetDetailsPage=_ref32=>{let{cabinet,onClose}=_ref32;if(!cabinet)return null;// Find all slots associated with this cabinet\nconst associatedSlots=slotMachines.filter(slot=>slot.cabinet_id===cabinet.id);return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:[\"\\uD83D\\uDDA5\\uFE0F \",cabinet.name||'Unnamed Cabinet']}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDDA5\\uFE0F Cabinet Name:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:cabinet.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFED Model:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:cabinet.model||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFE2 Manufacturer:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:cabinet.manufacturer||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCC5 Production Year:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:cabinet.production_year||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCC5 Created:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:cabinet.created_at?formatDateDDMMYYYY(cabinet.created_at):'N/A'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',margin:'0 0 20px 0',fontSize:'20px',fontWeight:'600'},children:[\"\\uD83C\\uDFB0 Associated Slots (\",associatedSlots.length,\")\"]}),associatedSlots.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Gaming Places\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:associatedSlots.map(slot=>{const location=locations.find(loc=>loc.id===slot.location_id);const provider=providers.find(prov=>prov.id===slot.provider_id);const gameMix=gameMixes.find(gm=>gm.id===slot.game_mix_id);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:slot.serial_number}),/*#__PURE__*/_jsx(\"td\",{children:(location===null||location===void 0?void 0:location.name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:(provider===null||provider===void 0?void 0:provider.name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:(gameMix===null||gameMix===void 0?void 0:gameMix.name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:slot.gaming_places||'N/A'})]},slot.id);})})]})}):/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-secondary)',fontSize:'16px'},children:\"No slots found for this cabinet.\"})]})]})})})})});};// Slots Details Page Component (for filtered results)\nconst SlotsDetailsPage=_ref33=>{let{slots,filterType,filterValue,onClose}=_ref33;if(!slots||slots.length===0)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:[\"\\uD83C\\uDFB0 Slots Filtered by \",filterType,\": \",filterValue]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\u2190 Back\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDD0D Filter Type:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:filterType})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83D\\uDCCA Filter Value:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:filterValue})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"\\uD83C\\uDFB0 Total Slots:\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',margin:'4px 0 0 0'},children:slots.length})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{color:'var(--text-primary)',margin:'0 0 20px 0',fontSize:'20px',fontWeight:'600'},children:[\"\\uD83C\\uDFB0 Filtered Slots (\",slots.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Gaming Places\"}),/*#__PURE__*/_jsx(\"th\",{children:\"RTP\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:slots.map(slot=>{const location=locations.find(loc=>loc.id===slot.location_id);const provider=providers.find(prov=>prov.id===slot.provider_id);const gameMix=gameMixes.find(gm=>gm.id===slot.game_mix_id);const cabinet=cabinets.find(cab=>cab.id===slot.cabinet_id);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:slot.serial_number}),/*#__PURE__*/_jsx(\"td\",{children:(location===null||location===void 0?void 0:location.name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:(provider===null||provider===void 0?void 0:provider.name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:(gameMix===null||gameMix===void 0?void 0:gameMix.name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:(cabinet===null||cabinet===void 0?void 0:cabinet.name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:slot.gaming_places||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:slot.rtp?\"\".concat(slot.rtp,\"%\"):'N/A'})]},slot.id);})})]})})]})]})})})})});};// History Changes Page Component\nconst HistoryChangesPage=/*#__PURE__*/React.memo(_ref34=>{let{onClose}=_ref34;const[historyData,setHistoryData]=useState([]);const[loading,setLoading]=useState(true);const[authError,setAuthError]=useState(false);const hasFetchedRef=React.useRef(false);const cacheRef=React.useRef(null);const[filters,setFilters]=useState({dateFrom:'',dateTo:'',location:'',provider:'',gameMix:''});const[multiFilters,setMultiFilters]=useState({locations:[],providers:[],gameMixes:[]});const[openDropdown,setOpenDropdown]=useState(null);const[globalQuery,setGlobalQuery]=useState('');const[dropdownQuery,setDropdownQuery]=useState({locations:'',providers:'',gameMixes:''});// Date range filter (with presets)\nconst[dateRange,setDateRange]=useState(()=>{const now=new Date();const startMonth=new Date(now.getFullYear(),now.getMonth(),1,0,0,0,0);const endMonth=new Date(now.getFullYear(),now.getMonth()+1,0,23,59,59,999);return{from:startMonth,to:endMonth,preset:'this_month'};});const startOfDay=d=>new Date(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0,0);const endOfDay=d=>new Date(d.getFullYear(),d.getMonth(),d.getDate(),23,59,59,999);const startOfWeekMonday=d=>{const day=d.getDay();// 0=Sun ... 6=Sat\nconst diff=day===0?-6:1-day;// shift to Monday\nconst res=new Date(d);res.setDate(d.getDate()+diff);return startOfDay(res);};const endOfWeekSunday=d=>{const start=startOfWeekMonday(d);const res=new Date(start);res.setDate(start.getDate()+6);return endOfDay(res);};const applyPreset=preset=>{const now=new Date();let from=null;let to=null;if(preset==='today'){from=startOfDay(now);to=endOfDay(now);}else if(preset==='this_week'){from=startOfWeekMonday(now);to=endOfWeekSunday(now);}else if(preset==='this_month'){from=new Date(now.getFullYear(),now.getMonth(),1,0,0,0,0);to=new Date(now.getFullYear(),now.getMonth()+1,0,23,59,59,999);}else if(preset==='last_month'){const last=new Date(now.getFullYear(),now.getMonth()-1,1);from=new Date(last.getFullYear(),last.getMonth(),1,0,0,0,0);to=new Date(last.getFullYear(),last.getMonth()+1,0,23,59,59,999);}else if(preset==='this_year'){from=new Date(now.getFullYear(),0,1,0,0,0,0);to=new Date(now.getFullYear(),11,31,23,59,59,999);}else if(preset==='prev_year'){const y=now.getFullYear()-1;from=new Date(y,0,1,0,0,0,0);to=new Date(y,11,31,23,59,59,999);}else if(preset==='all_time'){from=null;to=null;}setDateRange({from,to,preset});};const formatDateTimeDDMMYYYYHHMM=value=>{if(!value)return'';const d=new Date(value);if(Number.isNaN(d.getTime()))return'';const dd=String(d.getDate()).padStart(2,'0');const mm=String(d.getMonth()+1).padStart(2,'0');const yyyy=d.getFullYear();const hh=String(d.getHours()).padStart(2,'0');const mi=String(d.getMinutes()).padStart(2,'0');return\"\".concat(dd,\".\").concat(mm,\".\").concat(yyyy,\" \").concat(hh,\":\").concat(mi);};// Helpers to parse Calendar (yyyy-mm-dd) to Date at day bounds\nconst parseYMDToStart=val=>{if(!val)return null;const[y,m,d]=String(val).split('-').map(Number);if(!y||!m||!d)return null;return new Date(y,m-1,d,0,0,0,0);};const parseYMDToEnd=val=>{if(!val)return null;const[y,m,d]=String(val).split('-').map(Number);if(!y||!m||!d)return null;return new Date(y,m-1,d,23,59,59,999);};// Fetch history data\nconst fetchHistoryData=async()=>{if(hasFetchedRef.current&&cacheRef.current){setHistoryData(cacheRef.current);setLoading(false);return;}try{setLoading(true);const response=await fetch(\"\".concat(API,\"/change-history/slots/all\"),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const data=await response.json();// Fallback: if backend 'all' endpoint returns empty, aggregate per-entity\nif(Array.isArray(data)&&data.length===0){try{const token=localStorage.getItem('token');const slotsRes=await fetch(\"\".concat(API,\"/slot-machines\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(slotsRes.ok){const slots=await slotsRes.json();const slotIds=(Array.isArray(slots)?slots:[]).map(s=>s.id).filter(Boolean).slice(0,150);const results=await Promise.all(slotIds.map(id=>fetch(\"\".concat(API,\"/change-history/slots/\").concat(id),{headers:{'Authorization':\"Bearer \".concat(token)}}).then(r=>r.ok?r.json():[]).catch(()=>[])));const merged=results.flat().sort((a,b)=>new Date(b.created_at||b.scheduled_datetime||0)-new Date(a.created_at||a.scheduled_datetime||0)).slice(0,500);cacheRef.current=merged;hasFetchedRef.current=true;setHistoryData(merged);}else{cacheRef.current=[];hasFetchedRef.current=true;setHistoryData([]);}}catch(e){cacheRef.current=[];hasFetchedRef.current=true;setHistoryData([]);}}else{cacheRef.current=data;hasFetchedRef.current=true;setHistoryData(data);}}else{if(response.status===401||response.status===403){setAuthError(true);showCustomNotification('Not authenticated. Please login again.','error');}else{console.error('Failed to fetch history data');showCustomNotification('Failed to fetch history data','error');}}}catch(error){console.error('Error fetching history data:',error);showCustomNotification('Error fetching history data','error');}finally{setLoading(false);}};// Fetch only once on mount\nuseEffect(()=>{fetchHistoryData();},[]);// ok to run once; fetchHistoryData uses stable API/constants\n// Enrichment helper (must be defined BEFORE using in memos)\nconst getContextForItem=item=>{var _find,_find2,_find3;const slot=(Array.isArray(slotMachines)?slotMachines:[]).find(s=>s.id===item.entity_id);const serial=(slot===null||slot===void 0?void 0:slot.serial_number)||item.serial_number||'N/A';const locationName=((_find=(Array.isArray(locations)?locations:[]).find(l=>l.id===(slot===null||slot===void 0?void 0:slot.location_id)))===null||_find===void 0?void 0:_find.name)||item.location_name||'N/A';const providerName=((_find2=(Array.isArray(providers)?providers:[]).find(p=>p.id===(slot===null||slot===void 0?void 0:slot.provider_id)))===null||_find2===void 0?void 0:_find2.name)||item.provider_name||'N/A';const gameMixName=((_find3=(Array.isArray(gameMixes)?gameMixes:[]).find(g=>g.id===(slot===null||slot===void 0?void 0:slot.game_mix_id)))===null||_find3===void 0?void 0:_find3.name)||item.game_mix_name||'N/A';const modifiedBy=item.modified_by||item.user_name||'N/A';return{serial,locationName,providerName,gameMixName,modifiedBy};};// Keep inputs controlled locally without format flips on each change\nconst setDateFrom=useCallback(val=>{setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{dateFrom:val}));},[]);const setDateTo=useCallback(val=>{setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{dateTo:val}));},[]);// Parse dd.mm.yyyy into a Date (start or end of day)\nconst parseDateDDMMYYYY=function(value){let endOfDay=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!value||typeof value!=='string')return null;const match=value.match(/^(\\d{1,2})\\.(\\d{1,2})\\.(\\d{4})$/);if(!match)return null;const day=parseInt(match[1],10);const monthIndex=parseInt(match[2],10)-1;// 0-based\nconst year=parseInt(match[3],10);const date=new Date(year,monthIndex,day);if(Number.isNaN(date.getTime()))return null;if(endOfDay){date.setHours(23,59,59,999);}else{date.setHours(0,0,0,0);}return date;};// Options for multi-select dropdowns\nconst locationOptions=React.useMemo(()=>{const set=new Set();(historyData||[]).forEach(it=>set.add(getContextForItem(it).locationName));set.delete('N/A');return Array.from(set).sort();},[historyData]);const providerOptions=React.useMemo(()=>{const set=new Set();(historyData||[]).forEach(it=>set.add(getContextForItem(it).providerName));set.delete('N/A');return Array.from(set).sort();},[historyData]);const gameMixOptions=React.useMemo(()=>{const set=new Set();(historyData||[]).forEach(it=>set.add(getContextForItem(it).gameMixName));set.delete('N/A');return Array.from(set).sort();},[historyData]);// Filter history data (multiselect OR within group, AND across groups)\nconst filteredData=historyData.filter(item=>{const ctx=getContextForItem(item);if(multiFilters.locations.length&&!multiFilters.locations.includes(ctx.locationName))return false;if(multiFilters.providers.length&&!multiFilters.providers.includes(ctx.providerName))return false;if(multiFilters.gameMixes.length&&!multiFilters.gameMixes.includes(ctx.gameMixName))return false;if(dateRange&&(dateRange.from||dateRange.to)){const when=new Date(item.created_at||item.applied_datetime||item.scheduled_datetime||0);if(dateRange.from&&when<dateRange.from)return false;if(dateRange.to&&when>dateRange.to)return false;}if(globalQuery){const q=globalQuery.toLowerCase();const hay=[ctx.serial,ctx.locationName,ctx.providerName,ctx.gameMixName,item.field_name,item.old_value,item.new_value,item.modified_by||item.user_name,item.modification_type||item.change_type,item.created_at,item.scheduled_datetime,item.applied_datetime].filter(Boolean).join(' | ').toLowerCase();if(!hay.includes(q))return false;}return true;});// Handle date input click to prevent calendar from closing\nconst handleDateInputClick=e=>{var _e$target$showPicker,_e$target;e.preventDefault();e.stopPropagation();(_e$target$showPicker=(_e$target=e.target).showPicker)===null||_e$target$showPicker===void 0?void 0:_e$target$showPicker.call(_e$target);};// (moved earlier to avoid temporal dead-zone)\n// Export to XLS\nconst handleExportToXLS=()=>{const data=filteredData.map((item,index)=>_objectSpread(_objectSpread({'ID':index+1},(()=>{const c=getContextForItem(item);return{'Serial Number':c.serial,'Location':c.locationName,'Provider':c.providerName,'Game Mix':c.gameMixName};})()),{},{'Field Modified':item.field_name||'N/A','Old Value':item.old_value||'N/A','New Value':item.new_value||'N/A','Modified By':getContextForItem(item).modifiedBy,'Modified At':item.created_at?formatDateDDMMYYYY(item.created_at):'N/A','Modification Type':item.modification_type||'Manual'}));const ws=XLSX.utils.json_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'History Changes');const fileName=\"history_changes_\".concat(formatDateDDMMYYYY(new Date()),\".xlsx\");XLSX.writeFile(wb,fileName);};return/*#__PURE__*/_jsx(\"div\",{className:\"app-layout\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(\"div\",{className:\"layout-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-body\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'24px'},children:[/*#__PURE__*/_jsx(\"h1\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'24px',fontWeight:'700'},children:\"\\uD83D\\uDCCA All History Changes\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'10px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleExportToXLS,style:{background:'var(--gradient-primary)',color:'white',border:'none',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600',display:'flex',alignItems:'center',gap:'8px'},children:\"\\uD83D\\uDCE5 Export XLS\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'var(--bg-secondary)',color:'var(--text-primary)',border:'1px solid var(--border-color)',borderRadius:'8px',padding:'8px 16px',cursor:'pointer',fontSize:'14px',fontWeight:'600'},children:\"\\u2715 Close\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-secondary)',borderRadius:'12px',padding:'20px',marginBottom:'24px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{color:'var(--text-primary)',margin:'0 0 16px 0',fontSize:'18px',fontWeight:'600'},children:\"\\uD83D\\uDD0D Filters\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(\"div\",{style:{flex:'1 1 240px'},children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search in any column...\",value:globalQuery,onChange:e=>setGlobalQuery(e.target.value),style:{width:'100%',padding:'8px 12px',border:'1px solid var(--border-color)',borderRadius:6,background:'var(--bg-primary)',color:'var(--text-primary)'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:6,alignItems:'center',flexWrap:'wrap'},children:[[{k:'today',t:'Today'},{k:'this_week',t:'This week'},{k:'this_month',t:'This month'},{k:'last_month',t:'Last month'},{k:'this_year',t:'This year'},{k:'prev_year',t:'Previous year'},{k:'all_time',t:'All time'}].map(p=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>applyPreset(p.k),style:{background:dateRange.preset===p.k?'var(--gradient-primary)':'transparent',color:dateRange.preset===p.k?'#fff':'var(--text-primary)',border:'1px solid var(--border-color)',borderRadius:6,padding:'6px 10px',height:32,fontSize:12,cursor:'pointer'},children:p.t},p.k)),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:6,alignItems:'center',marginLeft:8},children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:dateRange.from?\"\".concat(dateRange.from.getFullYear(),\"-\").concat(String(dateRange.from.getMonth()+1).padStart(2,'0'),\"-\").concat(String(dateRange.from.getDate()).padStart(2,'0')):'',onChange:e=>setDateRange(prev=>_objectSpread(_objectSpread({},prev),{},{from:parseYMDToStart(e.target.value),preset:'custom'})),style:{height:32,padding:'6px 8px',border:'1px solid var(--border-color)',borderRadius:6,background:'var(--bg-primary)',color:'var(--text-primary)'}}),/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--text-secondary)',fontSize:12},children:\"to\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:dateRange.to?\"\".concat(dateRange.to.getFullYear(),\"-\").concat(String(dateRange.to.getMonth()+1).padStart(2,'0'),\"-\").concat(String(dateRange.to.getDate()).padStart(2,'0')):'',onChange:e=>setDateRange(prev=>_objectSpread(_objectSpread({},prev),{},{to:parseYMDToEnd(e.target.value),preset:'custom'})),style:{height:32,padding:'6px 8px',border:'1px solid var(--border-color)',borderRadius:6,background:'var(--bg-primary)',color:'var(--text-primary)'}}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>applyPreset('all_time'),style:{background:'transparent',color:'var(--text-primary)',border:'1px solid var(--border-color)',borderRadius:6,padding:'6px 10px',height:32,fontSize:12,cursor:'pointer'},children:\"Clear\"})]})]}),[{key:'locations',label:'Location',options:locationOptions},{key:'providers',label:'Provider',options:providerOptions},{key:'gameMixes',label:'Game Mix',options:gameMixOptions}].map(group=>/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setOpenDropdown(openDropdown===group.key?null:group.key),\"aria-expanded\":openDropdown===group.key,className:\"btn-secondary\",style:{minWidth:180,display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"span\",{children:group.label}),/*#__PURE__*/_jsx(\"span\",{style:{opacity:0.7},children:multiFilters[group.key].length||0})]}),openDropdown===group.key&&/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',zIndex:10,top:'calc(100% + 6px)',left:0,width:260,background:'var(--bg-primary)',border:'1px solid var(--border-color)',borderRadius:8,padding:10,boxShadow:'0 8px 24px rgba(0,0,0,0.3)'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search \".concat(group.label.toLowerCase(),\"...\"),value:dropdownQuery[group.key]||'',onChange:e=>setDropdownQuery(prev=>_objectSpread(_objectSpread({},prev),{},{[group.key]:e.target.value})),style:{width:'100%',padding:'6px 10px',border:'1px solid var(--border-color)',borderRadius:6,background:'var(--bg-primary)',color:'var(--text-primary)'}}),/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:220,overflowY:'auto',marginTop:6},children:group.options.filter(o=>dropdownQuery[group.key]?o.toLowerCase().includes((dropdownQuery[group.key]||'').toLowerCase()):true).map(opt=>{const checked=multiFilters[group.key].includes(opt);return/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',gap:8,padding:'6px 4px',cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:checked,onChange:e=>{setMultiFilters(prev=>{const next=new Set(prev[group.key]);if(e.target.checked)next.add(opt);else next.delete(opt);return _objectSpread(_objectSpread({},prev),{},{[group.key]:Array.from(next)});});}}),/*#__PURE__*/_jsx(\"span\",{children:opt})]},opt);})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'flex-end',gap:6,marginTop:8},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setMultiFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[group.key]:group.options.slice(0,2000)})),style:{background:'transparent',border:'1px solid var(--border-color)',color:'var(--text-primary)',padding:'6px 10px',height:32,borderRadius:6,fontSize:12,cursor:'pointer'},children:\"Select all\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setMultiFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[group.key]:[]})),style:{background:'transparent',border:'1px solid var(--border-color)',color:'var(--text-primary)',padding:'6px 10px',height:32,borderRadius:6,fontSize:12,cursor:'pointer'},children:\"Clear\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setOpenDropdown(null),style:{background:'transparent',border:'1px solid var(--border-color)',color:'var(--text-primary)',padding:'6px 10px',height:32,borderRadius:6,fontSize:12,cursor:'pointer'},children:\"Apply\"})]})]})]},group.key))]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-primary)',borderRadius:'12px',padding:'20px',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:/*#__PURE__*/_jsxs(\"h3\",{style:{color:'var(--text-primary)',margin:'0',fontSize:'18px',fontWeight:'600'},children:[\"\\uD83D\\uDCCB History Records (\",filteredData.length,\")\"]})}),authError?/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-secondary)',fontSize:'16px'},children:[\"Not authenticated. Please login.\",/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'12px'},children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>{localStorage.removeItem('token');window.location.reload();},style:{background:'var(--gradient-primary)',color:'#fff',border:'none',borderRadius:'6px',padding:'8px 12px',cursor:'pointer'},children:\"Re-login\"})})]}):loading?/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-secondary)',fontSize:'16px'},children:\"Loading history data...\"}):filteredData.length>0?/*#__PURE__*/_jsx(\"div\",{style:{overflowX:'auto'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:'var(--bg-secondary)',borderBottom:'2px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Serial Number\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Provider\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Field Modified\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Old Value\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"New Value\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Modified By\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Modified At\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px 8px',textAlign:'left',fontWeight:'normal',color:'var(--text-primary)',borderBottom:'1px solid var(--border-color)',fontSize:'13px'},children:\"Type\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredData.map((item,index)=>/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)',background:index%2===0?'var(--bg-secondary)':'var(--bg-tertiary)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)'},children:index+1}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)',fontWeight:'bold'},children:getContextForItem(item).serial}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)'},children:getContextForItem(item).locationName}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)'},children:getContextForItem(item).providerName}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)'},children:getContextForItem(item).gameMixName}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)',fontWeight:'bold'},children:item.field_name||'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)',maxWidth:'150px',wordBreak:'break-word'},children:item.old_value||'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)',maxWidth:'150px',wordBreak:'break-word'},children:item.new_value||'N/A'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)'},children:(()=>{const type=(item.modification_type||item.change_type||'').toLowerCase();const isTimer=type==='scheduled'||!!item.applied_datetime||!!item.scheduled_datetime;const name=item.modified_by||item.user_name||(isTimer?'Timer':'N/A');return name;})()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)'},children:(()=>{const when=item.applied_datetime||item.created_at||item.scheduled_datetime;return when?formatDateTimeDDMMYYYYHHMM(when):'N/A';})()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'12px 8px',fontSize:'13px',color:'var(--text-secondary)'},children:(()=>{const raw=(item.change_type||item.modification_type||'').toLowerCase();const isTimer=raw==='scheduled';const label=isTimer?'Timer':'Manual';const bg=isTimer?'#ffd700':'#4caf50';const color=isTimer?'#000':'#fff';return/*#__PURE__*/_jsx(\"span\",{style:{padding:'4px 8px',borderRadius:'4px',fontSize:'11px',fontWeight:'bold',backgroundColor:bg,color},children:label});})()})]},item.id||index))})]})}):/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-secondary)',fontSize:'16px'},children:\"No history changes found.\"})]})]})})})})});});const renderContent=()=>{// Render Commission Date Details Page if active\nif(showCommissionDateDetailsPage&&selectedCommissionDate){return/*#__PURE__*/_jsx(CommissionDateDetailsPage,{commissionDate:selectedCommissionDate,onClose:handleCloseCommissionDateDetails});}// Render Game Mix Games Page if active\nif(showGameMixGamesPage&&selectedGameMix){return/*#__PURE__*/_jsx(GameMixGamesPage,{gameMix:selectedGameMix,onClose:()=>setShowGameMixGamesPage(false),gamesData:gamesData,gameAvatars:gameAvatars,setSelectedGameForDetails:setSelectedGameForDetails,setShowGameDetailsPage:setShowGameDetailsPage,setShowGameMixGamesPage:setShowGameMixGamesPage});}// Render Game Mix Details Page if active\nif(showGameMixDetailsPage&&selectedGameMixForDetails){return/*#__PURE__*/_jsx(GameMixDetailsPage,{gameMix:selectedGameMixForDetails,onClose:()=>setShowGameMixDetailsPage(false),slotMachines:slotMachines,locations:locations,providers:providers,cabinets:cabinets,theme:theme,gamesData:gamesData,gamesViewMode:gamesViewMode,setGamesViewMode:setGamesViewMode,addBreadcrumb:addBreadcrumb});}// Render Game Details Page if active\nif(showGameDetailsPage&&selectedGameForDetails){return/*#__PURE__*/_jsx(GameDetailsPage,{gameName:selectedGameForDetails,onClose:()=>setShowGameDetailsPage(false),gameMixes:gameMixes,slotMachines:slotMachines,locations:locations,providers:providers,cabinets:cabinets,theme:theme,gamesData:gamesData,setGamesData:setGamesData,setSelectedGameMixForDetails:setSelectedGameMixForDetails,setShowGameMixDetailsPage:setShowGameMixDetailsPage,setShowGameDetailsPage:setShowGameDetailsPage,addBreadcrumb:addBreadcrumb,gamesViewMode:gamesViewMode,setGamesViewMode:setGamesViewMode});}// Render Game Table Page if active\nif(showGameTablePage){return/*#__PURE__*/_jsx(GameTablePage,{onClose:()=>setShowGameTablePage(false),gamesData:gamesData,theme:theme,fetchGamesData:fetchGamesData});}// Render Jackpot Details Page if active\nif(showJackpotDetailsPage&&selectedJackpot){return/*#__PURE__*/_jsx(JackpotDetailsPage,{jackpot:selectedJackpot,onClose:handleCloseJackpotDetails});}// Render Metrology Details Page if active\nif(showMetrologyDetailsPage&&selectedMetrology){return/*#__PURE__*/_jsx(MetrologyDetailsPage,{metrology:selectedMetrology,onClose:handleCloseMetrologyDetails});}// Render Invoice Details Page if active\nif(showLocationDetailsPage&&selectedLocation){return/*#__PURE__*/_jsx(LocationDetailsPage,{location:selectedLocation,onClose:handleCloseLocationDetails});}if(showInvoiceDetailsPage&&selectedInvoice){return/*#__PURE__*/_jsx(InvoiceDetailsPage,{invoice:selectedInvoice,onClose:handleCloseInvoiceDetails});}// Render Provider Details Page if active\nif(showProviderDetailsPage&&selectedProvider){return/*#__PURE__*/_jsx(ProviderDetailsPage,{provider:selectedProvider,onClose:handleCloseProviderDetails});}// Render Game Mix Details Page if active\nif(showGameMixDetailsPage&&selectedGameMixForDetails){return/*#__PURE__*/_jsx(GameMixDetailsPage,{gameMix:selectedGameMixForDetails,onClose:handleCloseGameMixDetails,slotMachines:slotMachines,locations:locations,providers:providers,cabinets:cabinets,theme:theme,gamesData:gamesData,gameAvatars:gameAvatars,gamesViewMode:gamesViewMode,setGamesViewMode:setGamesViewMode,addBreadcrumb:addBreadcrumb});}// Render Cabinet Details Page if active\nif(showCabinetDetailsPage&&selectedCabinet){return/*#__PURE__*/_jsx(CabinetDetailsPage,{cabinet:selectedCabinet,onClose:handleCloseCabinetDetails});}// Render Slots Details Page if active (for filtered results)\nif(showSlotsDetailsPage&&selectedSlotsForDetails.length>0){return/*#__PURE__*/_jsx(SlotsDetailsPage,{slots:selectedSlotsForDetails,filterType:selectedSlotsFilterType,filterValue:selectedSlotsFilterValue,onClose:handleCloseSlotsDetails});}// Render History Changes Page if active\nif(showHistoryChangesPage){return/*#__PURE__*/_jsx(HistoryChangesPage,{onClose:handleCloseHistoryChanges});}// Define slotColumns at the beginning to be accessible in both 'slots' and 'warehouse' cases\nconst slotColumns=[{key:'serial_number',label:'Serial Number',render:item=>{const location=locations.find(l=>l.id===item.location_id);return/*#__PURE__*/_jsxs(\"div\",{className:\"serial-cell\",style:{maxWidth:'120px'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"serial-primary clickable-filter\",onClick:()=>{// Deschide pagina cu toate sloturile cu același serial number\nconst slotsWithSameSerial=slotMachines.filter(slot=>slot.serial_number===item.serial_number);setSelectedSlotsForDetails(slotsWithSameSerial);setShowSlotsDetailsPage(true);setSelectedSlotsFilterType('Serial Number');setSelectedSlotsFilterValue(item.serial_number||'N/A');},style:{cursor:'pointer',fontSize:'0.9em'},children:/*#__PURE__*/_jsx(\"strong\",{children:item.serial_number||'N/A'})}),/*#__PURE__*/_jsx(\"div\",{className:\"serial-secondary\",children:/*#__PURE__*/_jsx(\"small\",{className:\"location-info clickable-filter\",onClick:()=>handleShowLocationDetails(location),style:{fontSize:'0.8em',cursor:'pointer'},children:location?location.name:'N/A'})})]});}},{key:'provider_id',label:'Provider',render:item=>{const provider=providers.find(p=>p.id===item.provider_id);const cabinet=cabinets.find(c=>c.id===item.cabinet_id);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"clickable-filter\",onClick:()=>handleShowProviderDetails(provider),style:{cursor:'pointer',fontWeight:'bold'},children:provider?provider.name:'N/A'}),/*#__PURE__*/_jsx(\"div\",{className:\"clickable-filter\",onClick:()=>handleShowCabinetDetails(cabinet),style:{fontSize:12,cursor:'pointer'},children:cabinet?cabinet.name:'No Cabinet'})]});}},{key:'game_mix_id',label:'Game Mix',render:item=>{const gameMix=gameMixes.find(gm=>gm.id===item.game_mix_id);const cabinet=cabinets.find(c=>c.id===item.cabinet_id);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"clickable-filter\",onClick:()=>handleShowGameMixDetails(gameMix),style:{cursor:'pointer',fontWeight:'bold'},children:gameMix?gameMix.name:'N/A'}),/*#__PURE__*/_jsx(\"div\",{className:\"clickable-filter\",onClick:()=>handleShowCabinetDetails(cabinet),style:{fontSize:12,cursor:'pointer'},children:cabinet&&cabinet.model?cabinet.model:'No Model'})]});}},{key:'property_details',label:'Property',render:item=>{// 1. Dacă ownership_type este 'rent', afișează providerul de închiriere și contractul\nif(item.ownership_type==='rent'){const rentProvider=providers.find(p=>p.id===item.lease_provider_id);const contractNumber=item.lease_contract_number||(item.serial_number?\"RENT-\".concat(item.serial_number,\"-\").concat(new Date().getFullYear()):'No Contract');return/*#__PURE__*/_jsxs(\"div\",{className:\"property-cell\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"property-primary clickable-filter\",onClick:()=>handleShowProviderDetails(rentProvider),style:{cursor:'pointer'},children:/*#__PURE__*/_jsx(\"strong\",{children:rentProvider?rentProvider.company_name:'No Provider Selected'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"property-secondary\",children:[/*#__PURE__*/_jsx(\"small\",{className:\"clickable-filter\",onClick:()=>{// Deschide pagina cu toate sloturile cu același contract\nconst slotsWithSameContract=slotMachines.filter(slot=>slot.lease_contract_number===contractNumber);setSelectedSlotsForDetails(slotsWithSameContract);setShowSlotsDetailsPage(true);setSelectedSlotsFilterType('Contract');setSelectedSlotsFilterValue(contractNumber);},title:\"Click to view all slots with contract: \".concat(contractNumber),children:contractNumber}),item.production_year&&/*#__PURE__*/_jsx(\"small\",{style:{display:'block',marginTop:'2px',color:'var(--accent-color)',fontWeight:'bold'},children:item.production_year}),(()=>{const associatedInvoices=invoices.filter(inv=>inv.serial_numbers&&inv.serial_numbers.includes(item.serial_number));if(associatedInvoices.length>0){return/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'4px'},children:associatedInvoices.map((invoice,index)=>/*#__PURE__*/_jsx(\"small\",{className:\"clickable-filter\",onClick:()=>handleShowInvoiceDetails(invoice),style:{display:'block',marginTop:'2px',color:'var(--text-secondary)',cursor:'pointer',fontSize:'0.8em'},title:\"Click to view invoice details: \".concat(invoice.invoice_number),children:invoice.invoice_number},invoice.id))});}return null;})()]})]});}// 2. Dacă ownership_type este 'property', afișează compania proprietar\nif(item.ownership_type==='property'){const company=companies.find(c=>c.id===item.owner_company_id);return/*#__PURE__*/_jsxs(\"div\",{className:\"property-cell\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"property-primary clickable-filter\",onClick:()=>{// Deschide pagina cu toate sloturile cu aceeași companie\nconst slotsWithSameCompany=slotMachines.filter(slot=>slot.owner_company_id===item.owner_company_id);setSelectedSlotsForDetails(slotsWithSameCompany);setShowSlotsDetailsPage(true);setSelectedSlotsFilterType('Company');setSelectedSlotsFilterValue(company?company.name:'No Company Selected');},style:{cursor:'pointer'},children:/*#__PURE__*/_jsx(\"strong\",{children:company?company.name:'No Company Selected'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"property-secondary\",children:[/*#__PURE__*/_jsx(\"small\",{children:\"Property Owned\"}),item.production_year&&/*#__PURE__*/_jsx(\"small\",{style:{display:'block',marginTop:'2px',color:'var(--accent-color)',fontWeight:'bold'},children:item.production_year}),(()=>{const associatedInvoices=invoices.filter(inv=>inv.serial_numbers&&inv.serial_numbers.includes(item.serial_number));if(associatedInvoices.length>0){return/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'4px'},children:associatedInvoices.map((invoice,index)=>/*#__PURE__*/_jsx(\"small\",{className:\"clickable-filter\",onClick:()=>handleShowInvoiceDetails(invoice),style:{display:'block',marginTop:'2px',color:'var(--text-secondary)',cursor:'pointer',fontSize:'0.8em'},title:\"Click to view invoice details: \".concat(invoice.invoice_number),children:invoice.invoice_number},invoice.id))});}return null;})()]})]});}// 3. Dacă nu există ownership_type, caută factura și afișează buyer/seller\nconst invoice=invoices.find(inv=>inv.serial_numbers&&inv.serial_numbers.includes(item.serial_number));if(invoice){const buyer=companies.find(c=>c.id===invoice.buyer_id);const seller=companies.find(c=>c.id===invoice.seller_id);return/*#__PURE__*/_jsxs(\"div\",{className:\"property-cell\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"property-primary clickable-filter \".concat(selectedCompanyFilter===invoice.buyer_id?'active-filter':''),onClick:()=>toggleCompanyFilter(invoice.buyer_id),style:{cursor:'pointer'},children:/*#__PURE__*/_jsx(\"strong\",{children:buyer?buyer.name:'Unknown Customer'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"property-secondary\",children:[/*#__PURE__*/_jsx(\"small\",{className:\"clickable-filter \".concat(selectedInvoiceFilter===invoice.invoice_number?'active-filter':''),onClick:()=>toggleInvoiceFilter(invoice.invoice_number),title:\"Click to filter by invoice: \".concat(invoice.invoice_number),children:invoice.invoice_number}),seller&&/*#__PURE__*/_jsxs(\"small\",{style:{marginLeft:'8px',color:'var(--text-secondary)'},children:[\"\\u2192 \",seller.name]}),item.production_year&&/*#__PURE__*/_jsx(\"small\",{style:{display:'block',marginTop:'2px',color:'var(--accent-color)',fontWeight:'bold'},children:item.production_year})]})]});}// 4. Dacă nu există nimic, fallback la Unknown\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"property-cell\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"property-primary\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"No Owner Info\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"property-secondary\",children:[/*#__PURE__*/_jsxs(\"small\",{children:[\"Serial: \",item.serial_number||'N/A']}),item.production_year&&/*#__PURE__*/_jsx(\"small\",{style:{display:'block',marginTop:'2px',color:'var(--accent-color)',fontWeight:'bold'},children:item.production_year}),(()=>{const associatedInvoices=invoices.filter(inv=>inv.serial_numbers&&inv.serial_numbers.includes(item.serial_number));if(associatedInvoices.length>0){return/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'4px'},children:associatedInvoices.map((invoice,index)=>/*#__PURE__*/_jsx(\"small\",{className:\"clickable-filter\",onClick:()=>handleShowInvoiceDetails(invoice),style:{display:'block',marginTop:'2px',color:'var(--text-secondary)',cursor:'pointer',fontSize:'0.8em'},title:\"Click to view invoice details: \".concat(invoice.invoice_number),children:invoice.invoice_number},invoice.id))});}return null;})()]})]});}},{key:'technical_specs',label:'Technical Specs',render:item=>{const formatAmount=amount=>{if(!amount)return'0,00';const num=parseFloat(amount);if(isNaN(num))return'0,00';const formatted=num.toFixed(2);const parts=formatted.split('.');const integerPart=parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g,'.');return\"\".concat(integerPart,\",\").concat(parts[1]);};return/*#__PURE__*/_jsxs(\"div\",{className:\"tech-specs-cell\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"spec-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"spec-label\",children:\"Denom:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"spec-value\",children:item.denomination?formatAmount(item.denomination):'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"spec-label\",children:\"Max Bet:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"spec-value\",children:item.max_bet?formatAmount(item.max_bet):'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"spec-label\",children:\"RTP:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"spec-value clickable-filter\",onClick:()=>{// Deschide pagina cu toate sloturile cu același RTP\nconst slotsWithSameRTP=slotMachines.filter(slot=>slot.rtp===item.rtp);setSelectedSlotsForDetails(slotsWithSameRTP);setShowSlotsDetailsPage(true);setSelectedSlotsFilterType('RTP');setSelectedSlotsFilterValue(item.rtp?\"\".concat(item.rtp,\"%\"):'N/A');},style:{cursor:'pointer'},children:item.rtp?\"\".concat(item.rtp,\"%\"):'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"spec-label\",children:\"Places:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"spec-value clickable-filter\",onClick:()=>{// Deschide pagina cu toate sloturile cu același număr de places\nconst slotsWithSamePlaces=slotMachines.filter(slot=>slot.gaming_places===item.gaming_places);setSelectedSlotsForDetails(slotsWithSamePlaces);setShowSlotsDetailsPage(true);setSelectedSlotsFilterType('Gaming Places');setSelectedSlotsFilterValue(item.gaming_places||'N/A');},style:{cursor:'pointer'},children:item.gaming_places||'N/A'})]})]});}},// Add CVT Information column to slot machines table\n{key:'cvt_information',label:'CVT Information',render:item=>{// Find metrology record for this slot with proper multi-serial handling\nconst metrologyItem=metrology.find(m=>{if(!m.serial_number){return false;}// Try both newline and space separation\nconst serialNumbersNewline=m.serial_number.split('\\n').filter(s=>s.trim());const serialNumbersSpace=m.serial_number.split(' ').filter(s=>s.trim());// Use the one that has more items (more likely to be correct)\nconst serialNumbers=serialNumbersNewline.length>serialNumbersSpace.length?serialNumbersNewline:serialNumbersSpace;return serialNumbers.includes(item.serial_number);});const cvtDate=metrologyItem===null||metrologyItem===void 0?void 0:metrologyItem.cvt_expiry_date;const cvtType=metrologyItem===null||metrologyItem===void 0?void 0:metrologyItem.cvt_type;if(!cvtDate&&!cvtType){return/*#__PURE__*/_jsx(\"span\",{style:{color:'#6b7280',fontStyle:'italic'},children:\"No CVT Data\"});}// Calculate days remaining\nlet daysLeft=null;if(cvtDate){const cvtExpiryDate=new Date(cvtDate);const now=new Date();const diff=Math.floor((cvtExpiryDate-now)/(1000*60*60*24));daysLeft=diff>0?diff:0;}// Color coding for days remaining\nlet daysColor='#10b981';// Green for > 90 days\nif(daysLeft!==null){if(daysLeft<=30){daysColor='#ef4444';// Red for ≤ 30 days\n}else if(daysLeft<=90){daysColor='#f59e0b';// Yellow for 31-90 days\n}}// Type colors\nconst typeColors={'periodic':{bg:'#dbeafe',text:'#1e40af',icon:''},'reparation':{bg:'#fef3c7',text:'#d97706',icon:''}};const colorScheme=typeColors[cvtType]||{bg:'#f3f4f6',text:'#6b7280',icon:'❓'};return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:'8px'},children:[cvtType&&/*#__PURE__*/_jsx(\"div\",{onClick:()=>handleMetrologyClick([metrologyItem]),style:{display:'inline-flex',alignItems:'center',gap:'4px',padding:'4px 8px',borderRadius:'12px',backgroundColor:colorScheme.bg,color:colorScheme.text,fontSize:'0.85em',fontWeight:'500',width:'fit-content',cursor:'pointer',transition:'all 0.2s'},onMouseEnter:e=>{e.target.style.opacity='0.8';e.target.style.transform='scale(1.05)';},onMouseLeave:e=>{e.target.style.opacity='1';e.target.style.transform='scale(1)';},title:\"Click to view all metrology details\",children:/*#__PURE__*/_jsx(\"span\",{style:{textTransform:'capitalize'},children:cvtType})}),cvtDate&&/*#__PURE__*/_jsx(\"div\",{className:\"clickable-filter\",onClick:()=>handleShowMetrologyDetails([metrologyItem]),style:{fontSize:'0.9em',fontWeight:'500',cursor:'pointer',padding:'2px 4px',borderRadius:'4px',transition:'background-color 0.2s'},children:formatDateDDMMYYYY(cvtDate)}),daysLeft!==null&&/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',color:daysColor,fontWeight:'bold',fontSize:'1.1em',padding:'4px 8px',borderRadius:'4px',backgroundColor:daysColor==='#ef4444'?'rgba(239, 68, 68, 0.1)':daysColor==='#f59e0b'?'rgba(245, 158, 11, 0.1)':'rgba(16, 185, 129, 0.1)',width:'fit-content'},children:[daysLeft,\" days left\"]})]});}},{key:'comision_date',label:'Comision Date',render:item=>{// Caută toate comision dates care conțin serialul slotului\nconst associatedComisionDates=comisionDates.filter(cd=>{if(!cd.serial_numbers)return false;// Verifică dacă serial_number-ul slotului este conținut în serial_numbers-ul comision date\nconst comisionSerialNumbers=cd.serial_numbers.split(/\\s+/).filter(s=>s.trim());return comisionSerialNumbers.includes(item.serial_number);});if(associatedComisionDates.length===0){return/*#__PURE__*/_jsx(\"span\",{style:{color:'#aaa',fontStyle:'italic'},children:\"No Comision Date\"});}// Dacă este o singură comision date, afișează data\nif(associatedComisionDates.length===1){const comisionDate=associatedComisionDates[0];return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'4px'},children:/*#__PURE__*/_jsx(\"span\",{style:{color:'#059669',cursor:'pointer',textDecoration:'underline',fontWeight:'500'},onClick:()=>{// Deschide pagina full render pentru comision date\nsetSelectedCommissionDate(comisionDate);setShowCommissionDateDetailsPage(true);},children:formatDateDDMMYYYY(comisionDate.commission_date)})});}// Dacă sunt multiple comision dates, afișează \"Multiple Comision Dates\" clicabil cu bulină\nreturn/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'0px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'#059669',cursor:'pointer',textDecoration:'underline',fontWeight:'500'},onClick:()=>{// Deschide pagina full render pentru comision dates\nsetSelectedCommissionDate(associatedComisionDates[0]);setShowCommissionDateDetailsPage(true);},children:\"Multiple Comision Dates\"}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#059669',color:'white',borderRadius:'50%',width:'18px',height:'18px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'11px',fontWeight:'bold',minWidth:'18px',marginLeft:'0px'},children:associatedComisionDates.length})]});}},// Jackpots Column\n{key:'jackpot_information',label:'Jackpots',render:item=>{// Find associated jackpots for this slot\nconst associatedJackpots=jackpots.filter(j=>j.serial_number===item.serial_number);if(associatedJackpots.length===0){return/*#__PURE__*/_jsx(\"span\",{style:{color:'#aaa',fontStyle:'italic'},children:\"No Jackpots\"});}// If single jackpot, show jackpot name\nif(associatedJackpots.length===1){const jackpot=associatedJackpots[0];return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:'4px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'#3182ce',cursor:'pointer',textDecoration:'underline',fontWeight:'500'},onClick:()=>handleShowJackpotDetails(jackpot),children:jackpot.jackpot_name||'No Name'}),/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:'0.8em',color:'var(--text-secondary)',display:'flex',alignItems:'center',gap:'4px'},children:[jackpot.jackpot_type==='progressive'&&'📈',jackpot.jackpot_type==='fixed'&&'💰',jackpot.jackpot_type==='mystery'&&'🎭',jackpot.jackpot_type||'Unknown']})]});}// If multiple jackpots, show \"Multiple Jackpots\" with count\nreturn/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'#3182ce',cursor:'pointer',textDecoration:'underline',fontWeight:'500'},onClick:()=>setSelectedJackpots(associatedJackpots),children:\"Multiple Jackpots\"}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#3182ce',color:'white',borderRadius:'50%',width:'18px',height:'18px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'11px',fontWeight:'bold',minWidth:'18px'},children:associatedJackpots.length})]});}},{key:'created_by',label:'Created By',render:item=>{const creator=users.find(u=>u.id===item.created_by||u.username===item.created_by);return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:'4px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.9em',color:'var(--text-primary)',fontWeight:'500'},children:creator&&creator.first_name&&creator.last_name?\"\".concat(creator.first_name,\" \").concat(creator.last_name):creator?creator.username:item.created_by||'Unknown'}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.8em',color:'var(--text-secondary)',fontStyle:'italic'},children:item.created_at?formatDateDDMMYYYY(item.created_at):'N/A'})]});}},{key:'updated_by',label:'Modified By',render:item=>{const modifier=users.find(u=>u.id===item.updated_by||u.username===item.updated_by);return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:'4px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.9em',color:'var(--text-primary)',fontWeight:'500'},children:modifier&&modifier.first_name&&modifier.last_name?\"\".concat(modifier.first_name,\" \").concat(modifier.last_name):modifier?modifier.username:item.updated_by||'N/A'}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.8em',color:'var(--text-secondary)',fontStyle:'italic'},children:item.updated_at?formatDateDDMMYYYY(item.updated_at):'N/A'})]});}}];switch(activeView){case'dashboard':return renderDashboard();case'companies':return renderTable('Companies',companies,[{key:'avatar',label:'Logo',render:item=>/*#__PURE__*/_jsx(AvatarDisplay,{entityType:\"companies\",entityId:item.id,size:50,entityName:item.name})},{key:'name',label:'Company Name'},{key:'registration_number',label:'Registration'},{key:'contact_person',label:'Contact Person'},{key:'email',label:'Email',render:item=>/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:/*#__PURE__*/_jsx(\"span\",{children:item.email||'N/A'})})},{key:'phone',label:'Phone',render:item=>/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:/*#__PURE__*/_jsx(\"span\",{children:item.phone||'N/A'})})}],{onAdd:()=>handleAddEntity('companies'),onEdit:item=>handleEditEntity(item,'companies'),onDelete:id=>handleDeleteEntity(id,'companies'),onBulkEdit:()=>handleBulkEdit('companies'),onBulkDelete:()=>handleBulkDelete('companies'),onExport:()=>handleExport('companies'),onImport:()=>handleImport('companies')},'companies');case'locations':return renderTable('Locations',locations,[{key:'name',label:'Location Name'},{key:'address',label:'Address'},{key:'city',label:'City'},{key:'county',label:'County'},{key:'coordinates',label:'Coordinates',render:item=>item.latitude&&item.longitude?\"\".concat(item.latitude.toFixed(4),\", \").concat(item.longitude.toFixed(4)):'N/A'},{key:'contact_person',label:'Contact Person',render:item=>{// Dacă contact_person_id există, caută user-ul\nif(item.contact_person_id){const contactUser=Array.isArray(users)?users.find(u=>u.id===item.contact_person_id):null;if(contactUser){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold'},children:contactUser.first_name&&contactUser.last_name?\"\".concat(contactUser.first_name,\" \").concat(contactUser.last_name):contactUser.username}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'0.8em',color:'var(--text-secondary)'},children:[contactUser.email||'N/A',\" | \",contactUser.phone||'N/A']})]});}}// Dacă nu există contact_person_id, afișează contact_person ca text\nreturn item.contact_person?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold'},children:item.contact_person}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'0.8em',color:'var(--text-secondary)'},children:[item.contact_email||'N/A',\" | \",item.contact_phone||'N/A']})]}):'No contact person';}}],{onAdd:()=>handleAddEntity('locations'),onEdit:item=>handleEditEntity(item,'locations'),onDelete:id=>handleDeleteEntity(id,'locations'),onBulkEdit:()=>handleBulkEdit('locations'),onBulkDelete:()=>handleBulkDelete('locations'),onExport:()=>handleExport('locations'),onImport:()=>handleImport('locations')},'locations');case'providers':return renderTable('Providers',providers,[{key:'avatar',label:'Avatar',render:item=>/*#__PURE__*/_jsx(\"div\",{className:\"provider-avatar-cell\",style:{display:'flex',alignItems:'center',gap:'12px'},children:/*#__PURE__*/_jsx(AvatarDisplay,{entityType:\"providers\",entityId:item.id,size:50,entityName:item.name||'Unknown Provider'})})},{key:'name',label:'Provider Name'},{key:'company_name',label:'Company'},{key:'property',label:'Property',render:item=>{// Property column: pentru Property type afișează \"Company Name + Invoice Number\"\n// pentru Rent type afișează \"Provider Company Name + Lease Contract Number\"\nif(item.property_type==='property'){return\"\".concat(item.company_name||'N/A',\" + \").concat(item.invoice_number||'N/A');}else if(item.property_type==='rent'){return\"\".concat(item.name||'N/A',\" + \").concat(item.lease_contract_number||'N/A');}else{return'N/A';}}},{key:'contact_person',label:'Contact Person'},{key:'email',label:'Email',render:item=>/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'16px'},children:\"\\uD83D\\uDCE7\"}),/*#__PURE__*/_jsx(\"span\",{children:item.email||'N/A'})]})},{key:'website',label:'Website',render:item=>item.website?/*#__PURE__*/_jsx(\"a\",{href:item.website,target:\"_blank\",rel:\"noopener noreferrer\",className:\"link\",children:item.website}):'N/A'}],{onAdd:()=>handleAddEntity('providers'),onEdit:item=>handleEditEntity(item,'providers'),onDelete:id=>handleDeleteEntity(id,'providers')});case'cabinets':return renderTable('Cabinets',cabinets,[{key:'name',label:'Name'},{key:'model',label:'Model'},{key:'provider_id',label:'Provider',render:item=>{const provider=providers.find(p=>p.id===item.provider_id);return provider?provider.name:'N/A';}}],{onAdd:()=>handleAddEntity('cabinets'),onEdit:item=>handleEditEntity(item,'cabinets'),onDelete:id=>handleDeleteEntity(id,'cabinets'),onBulkEdit:()=>handleBulkEdit('cabinets'),onBulkDelete:()=>handleBulkDelete('cabinets'),onExport:()=>handleExport('cabinets'),onImport:()=>handleImport('cabinets')},'cabinets');case'slots':{// Show only active slots (including those without status set)\nconst activeSlots=slotMachines.filter(s=>s.status!=='inactive');const activeCount=activeSlots.length;return renderTable(\"Slot Machines\",activeSlots,slotColumns,{onAdd:()=>handleAddEntity('slots'),onEdit:item=>handleEditEntity(item,'slots'),onDelete:id=>handleDeleteEntity(id,'slots'),onBulkEdit:()=>handleBulkEdit('slots'),onBulkDelete:()=>handleBulkDelete('slots'),onBulkDuplicate:()=>handleBulkDuplicate('slots'),onExport:()=>handleExport('slots'),onImport:()=>handleImport('slots')},'slots');}case'warehouse':{// Show only inactive slots\nconst warehouseSlots=slotMachines.filter(s=>s.status==='inactive');const warehouseCount=warehouseSlots.length;return renderTable(\"Warehouse\",warehouseSlots,slotColumns,{onAdd:()=>handleAddEntity('slots'),onEdit:item=>handleEditEntity(item,'slots'),onDelete:id=>handleDeleteEntity(id,'slots'),onBulkEdit:()=>handleBulkEdit('slots'),onBulkDelete:()=>handleBulkDelete('slots'),onBulkDuplicate:()=>handleBulkDuplicate('slots'),onExport:()=>handleExport('slots'),onImport:()=>handleImport('slots')},'slots');}case'metrology':{// REDIRECT TO METROLOGY CVT - THE ONLY CORRECT METROLOGY TABLE\nreturn/*#__PURE__*/_jsxs(\"div\",{style:{padding:'40px',textAlign:'center',color:'#666'},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u26A0\\uFE0F Metrology Table Deprecated\"}),/*#__PURE__*/_jsx(\"p\",{children:\"This table has been replaced by Metrology CVT. Please use the Metrology CVT section instead.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:()=>setActiveView('metrology2'),style:{marginTop:'20px'},children:\"Go to Metrology CVT\"})]});}case'metrology2':{const selectedMetrologyItems=selectedItems.filter(id=>metrology.some(item=>(item.id||item._id)===id));const hasSelectedItems=selectedMetrologyItems.length>0;const filteredMetrology=filterData(metrology,metrologySearchTerm);return/*#__PURE__*/_jsxs(\"div\",{className:\"table-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"table-header\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Metrology CVT\"}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#3182ce',color:'white',borderRadius:'50%',width:'28px',height:'28px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'14px',fontWeight:'bold',minWidth:'28px'},children:filteredMetrology.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"table-actions\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:metrologySearchTerm,onChange:e=>setMetrologySearchTerm(e.target.value),placeholder:\"Search...\",style:{padding:'6px 12px',borderRadius:'6px',border:'1px solid var(--border-color)',fontSize:'1em',minWidth:180,marginRight:8}}),hasSelectedItems&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',alignItems:'center',background:'var(--bg-primary)',padding:'8px 12px',borderRadius:'6px',border:'1px solid var(--border-color)',marginRight:'12px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:'0.9rem',color:'var(--text-secondary)'},children:[selectedMetrologyItems.length,\" selected\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:()=>handleBulkEdit('metrology2'),style:{fontSize:'0.85rem',padding:'4px 8px'},children:\"\\u270F\\uFE0F Bulk Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-danger\",onClick:()=>handleBulkDelete('metrology2'),style:{fontSize:'0.85rem',padding:'4px 8px'},children:\"\\uD83D\\uDDD1\\uFE0F Bulk Delete\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-primary\",onClick:()=>handleAddEntity('metrology2'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\u2795\"}),\"Add CVT Date\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-success\",onClick:()=>handleExport('metrology2'),title:\"Export Data\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\uD83D\\uDCE4\"}),\"Export\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-info\",onClick:()=>handleImport('metrology2'),title:\"Import Data\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\uD83D\\uDCE5\"}),\"Import\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"table-wrapper\",children:[/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{width:'40px'},children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:metrology.length>0&&selectedMetrologyItems.length===metrology.length,onChange:e=>handleSelectAll(metrology,e.target.checked),style:{cursor:'pointer'}})}),/*#__PURE__*/_jsx(\"th\",{children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Certificate Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Issue Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Authority\"}),/*#__PURE__*/_jsx(\"th\",{children:\"CVT Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"CVT End Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Number of Slots\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Created At\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Created By\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredMetrology.map((item,index)=>{const createdByUser=Array.isArray(users)?users.find(user=>user.id===item.created_by||user.username===item.created_by):null;const daysUntilExpiry=item.cvt_expiry_date?Math.ceil((new Date(item.cvt_expiry_date)-new Date())/(1000*60*60*24)):null;const isSelected=selectedItems.includes(item.id||item._id);return/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:isSelected?'var(--accent-color)':'transparent',opacity:isSelected?0.9:1},children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isSelected,onChange:e=>handleItemSelection(item.id||item._id,e.target.checked),style:{cursor:'pointer'}})}),/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{onClick:()=>handleShowMetrologyDetails(item),style:{cursor:'pointer',color:'#3182ce',textDecoration:'underline',transition:'all 0.2s'},onMouseEnter:e=>{e.target.style.color='#2c5282';e.target.style.textDecoration='none';},onMouseLeave:e=>{e.target.style.color='#3182ce';e.target.style.textDecoration='underline';},title:\"Click to view all metrology details\",children:item.certificate_number||'N/A'})}),/*#__PURE__*/_jsx(\"td\",{children:item.issue_date?formatDateDDMMYYYY(item.issue_date):'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:'500',color:'var(--text-primary)'},children:item.issuing_authority||'N/A'})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{style:{display:'flex',alignItems:'center',gap:'4px',color:item.cvt_type==='periodic'?'#3182ce':'#dc3545'},children:item.cvt_type||'N/A'})}),/*#__PURE__*/_jsx(\"td\",{children:item.cvt_expiry_date?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold'},children:formatDateDDMMYYYY(item.cvt_expiry_date)}),(()=>{const daysUntilExpiry=Math.ceil((new Date(item.cvt_expiry_date)-new Date())/(1000*60*60*24));return/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.9em',color:daysUntilExpiry<=30?'#dc3545':daysUntilExpiry<=90?'#ffc107':'#28a745',fontWeight:'bold'},children:daysUntilExpiry>0?\"\".concat(daysUntilExpiry,\" days left\"):\"\".concat(Math.abs(daysUntilExpiry),\" days overdue\")});})()]}):'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{style:{backgroundColor:'var(--accent-color)',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold'},children:[item.serial_number?item.serial_number.split('\\n').filter(s=>s.trim()).length:0,\" slots\"]})}),/*#__PURE__*/_jsx(\"td\",{children:item.created_at?formatDateDDMMYYYY(item.created_at):'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:'4px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.9em',color:'var(--text-primary)',fontWeight:'500'},children:item.creator_name||'Unknown User'}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.8em',color:'var(--text-secondary)',fontStyle:'italic'},children:item.updater_name?\"Modified by: \".concat(item.updater_name):''})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(CvtAttachmentIndicator,{cvtId:item.id||item._id,onClick:()=>handleOpenCvtAttachments(item.id||item._id)}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-edit\",onClick:()=>handleEditEntity(item,'metrology2'),title:\"Edit CVT Date\",children:\"\\u270F\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-delete\",onClick:()=>handleDeleteEntity(item.id||item._id,'metrology2'),title:\"Delete CVT Date\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]})})]},item.id||item._id);})})]}),filteredMetrology.length===0&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'40px',textAlign:'center',color:'#666'},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"No CVT Records Found\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Use the \\\"Add CVT Date\\\" button to create your first CVT record.\"})]})]})]});}case'jackpots':{return renderTable('Jackpot Records',jackpots,[{key:'slot_count',label:'NUMBER OF SLOTS',render:item=>{if(!item.serial_number)return/*#__PURE__*/_jsx(\"span\",{style:{backgroundColor:'var(--accent-color)',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold'},children:\"0 slots\"});// Split serial numbers by space and newline, then filter empty strings\nconst serialNumbers=item.serial_number.split(/\\s|\\n/).filter(s=>s.trim());// Count how many slots match these serial numbers\nconst matchingSlots=slotMachines.filter(slot=>serialNumbers.includes(slot.serial_number));const slotCount=matchingSlots.length;return/*#__PURE__*/_jsxs(\"span\",{style:{backgroundColor:slotCount>0?'var(--accent-color)':'#ff6b6b',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold'},children:[slotCount,\" slot\",slotCount!==1?'s':'']});}},{key:'jackpot_name',label:'Jackpot Name',render:item=>/*#__PURE__*/_jsx(\"span\",{style:{color:'#3182ce',cursor:'pointer',textDecoration:'underline',fontWeight:'500'},onClick:()=>handleShowJackpotDetails(item),children:item.jackpot_name||'No Name'})},{key:'jackpot_type',label:'Type',render:item=>{const typeColors={'Progressive':'📈','Fixed':'💰','Mystery':'🎭'};return/*#__PURE__*/_jsxs(\"span\",{style:{display:'flex',alignItems:'center',gap:'4px'},children:[typeColors[item.jackpot_type]||'🎰',\" \",item.jackpot_type]});}},{key:'increment_rate',label:'Increment Rate',render:item=>/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--accent-color)',fontWeight:'bold'},children:item.increment_rate?\"\".concat((item.increment_rate*100).toFixed(1),\"%\"):'N/A'})},{key:'description',label:'Description',render:item=>item.description||'N/A'},{key:'created_by',label:'Created By',render:item=>{const creator=users.find(u=>u.id===item.created_by||u.username===item.created_by);return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:'4px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.9em',color:'var(--text-primary)',fontWeight:'500'},children:creator&&creator.first_name&&creator.last_name?\"\".concat(creator.first_name,\" \").concat(creator.last_name):creator?creator.username:item.created_by||'Unknown'}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.8em',color:'var(--text-secondary)',fontStyle:'italic'},children:item.created_at?formatDateDDMMYYYY(item.created_at):'N/A'})]});}},{key:'updated_by',label:'Modified By',render:item=>{const modifier=users.find(u=>u.id===item.updated_by||u.username===item.updated_by);return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:'4px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.9em',color:'var(--text-primary)',fontWeight:'500'},children:modifier&&modifier.first_name&&modifier.last_name?\"\".concat(modifier.first_name,\" \").concat(modifier.last_name):modifier?modifier.username:item.updated_by||'N/A'}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.8em',color:'var(--text-secondary)',fontStyle:'italic'},children:item.updated_at?formatDateDDMMYYYY(item.updated_at):'N/A'})]});}}],{onAdd:()=>handleAddEntity('jackpots'),onEdit:item=>handleEditEntity(item,'jackpots'),onDelete:id=>handleDeleteEntity(id,'jackpots'),onBulkEdit:()=>handleBulkEdit('jackpots'),onBulkDelete:()=>handleBulkDelete('jackpots'),onExport:()=>handleExport('jackpots'),onImport:()=>handleImport('jackpots')},'jackpots');}case'gamemixes':return renderTable('Game Mixes',gameMixes,[{key:'avatar',label:'Avatar',render:item=>/*#__PURE__*/_jsx(AvatarDisplay,{entityType:\"game_mixes\",entityId:item.id,size:80,rectangular:true,entityName:item.name})},{key:'name',label:'Mix Name',render:item=>/*#__PURE__*/_jsx(\"div\",{style:{cursor:'pointer',color:'var(--accent-color)',fontWeight:'bold',textDecoration:'underline'},onClick:()=>handleShowGameMixDetails(item),children:item.name})},{key:'description',label:'Description'},{key:'provider_id',label:'Provider',render:item=>{const provider=providers.find(p=>p.id===item.provider_id);return provider?provider.name:'Unknown Provider';}},{key:'games',label:'Games',render:item=>{const games=item.games||[];const gameCount=Array.isArray(games)?games.length:typeof games==='string'?games.split(',').length:0;return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#3182ce',color:'white',borderRadius:'12px',padding:'4px 12px',display:'inline-block',fontSize:'12px',fontWeight:'normal',textAlign:'center',cursor:'pointer'},onClick:()=>{setSelectedGameMix(item);setShowGameMixGamesPage(true);},children:[gameCount,\" games\"]});}},{key:'campus_web',label:'Campus Web',render:item=>{if(item.campus_web&&item.campus_web.startsWith('https://')){return/*#__PURE__*/_jsxs(\"a\",{href:item.campus_web,target:\"_blank\",rel:\"noopener noreferrer\",className:\"link\",style:{color:'var(--accent-color)',textDecoration:'underline'},children:[\"\\uD83C\\uDF10 \",item.campus_web]});}return item.campus_web||'N/A';}}],{onAdd:()=>handleAddEntity('gamemixes'),onEdit:item=>handleEditEntity(item,'gamemixes'),onDelete:id=>handleDeleteEntity(id,'gamemixes')});case'games':return/*#__PURE__*/_jsx(GamesPage,{gameMixes:gameMixes,theme:theme,setActiveView:setActiveView,gameAvatars:gameAvatars,setSelectedGameForDetails:setSelectedGameForDetails,setShowGameDetailsPage:setShowGameDetailsPage,gamesData:gamesData,setGamesData:setGamesData,fetchGamesData:fetchGamesData,showCustomNotification:showCustomNotification,setShowGameTablePage:setShowGameTablePage,addBreadcrumb:addBreadcrumb});case'invoices':return renderTable('Invoices',invoices,[{key:'invoice_number',label:'Invoice Number',render:item=>/*#__PURE__*/_jsx(\"span\",{className:\"clickable-invoice-number\",onClick:()=>handleInvoiceClick(item),style:{cursor:'pointer',color:'var(--accent-color)',textDecoration:'underline'},children:item.invoice_number})},{key:'buyer_id',label:'Customer',render:item=>{const buyer=companies.find(c=>c.id===item.buyer_id);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold'},children:buyer?buyer.name:'Unknown Customer'}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.8em',color:'var(--text-secondary)'},children:buyer?buyer.contact_person||'No contact person':'N/A'})]});}},{key:'seller_id',label:'Seller',render:item=>{const seller=providers.find(p=>p.id===item.seller_id);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold'},children:seller?seller.name:'Unknown Seller'}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.8em',color:'var(--text-secondary)'},children:seller?seller.contact_person||'No contact person':'N/A'})]});}},{key:'transaction_type',label:'Transaction Type',render:item=>{const transactionTypeColors={'rent':'🔵','buy':'🟢','sell':'🟡'};const transactionTypeLabels={'rent':'Rent','buy':'Buy','sell':'Sell'};return/*#__PURE__*/_jsxs(\"span\",{style:{display:'flex',alignItems:'center',gap:'4px',fontWeight:'bold'},children:[transactionTypeColors[item.transaction_type]||'⚪',\" \",transactionTypeLabels[item.transaction_type]||'N/A']});}},{key:'location',label:'Location',render:item=>{// Find location based on serial numbers in the invoice\nlet location=null;if(item.serial_numbers){const serialArray=item.serial_numbers.split(' ').filter(s=>s.trim());if(serialArray.length>0){// Find the first slot machine with matching serial number\nconst slotMachine=slotMachines.find(slot=>serialArray.includes(slot.serial_number));if(slotMachine){location=locations.find(l=>l.id===slotMachine.location_id);}}}// Fallback to direct location_id if no slot machine found\nif(!location&&item.location_id){location=locations.find(l=>l.id===item.location_id);}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold'},children:location?location.name:'No location'}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.8em',color:'var(--text-secondary)'},children:location?\"\".concat(location.city,\", \").concat(location.county):'N/A'})]});}},{key:'issue_date',label:'Issue Date',render:item=>formatDateDDMMYYYY(item.issue_date)},{key:'due_date',label:'Due Date',render:item=>formatDateDDMMYYYY(item.due_date)},{key:'amount',label:'Amount',render:item=>{const formatAmount=amount=>{if(!amount)return'0,00';const num=parseFloat(amount);if(isNaN(num))return'0,00';const formatted=num.toFixed(2);const parts=formatted.split('.');const integerPart=parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g,'.');return\"\".concat(integerPart,\",\").concat(parts[1]);};return formatAmount(item.amount);}},{key:'status',label:'Status',render:item=>{const statusColors={'paid':'🟢','pending':'🟡','overdue':'🔴','cancelled':'⚫'};return/*#__PURE__*/_jsxs(\"span\",{style:{display:'flex',alignItems:'center',gap:'4px',fontWeight:'bold'},children:[statusColors[item.status]||'⚪',\" \",item.status||'Unknown']});}},{key:'slot_count',label:'NUMBER OF SLOTS',render:item=>{if(!item.serial_numbers)return/*#__PURE__*/_jsx(\"span\",{style:{backgroundColor:'var(--accent-color)',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold',cursor:'pointer'},onClick:()=>setSelectedInvoiceSlots([]),children:\"0 slots\"});const serials=item.serial_numbers.split(/\\s|\\n/).filter(s=>s.trim());const associatedSlots=slotMachines.filter(slot=>serials.includes(slot.serial_number));return/*#__PURE__*/_jsxs(\"span\",{style:{backgroundColor:'var(--accent-color)',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold',cursor:'pointer'},onClick:()=>setSelectedInvoiceSlots(associatedSlots),title:\"Click to view slot details\",children:[serials.length,\" slots\"]});}},{key:'description',label:'Description',render:item=>{const cleanDescription=description=>{if(!description)return'No description';return description.replace(/€/g,'').replace(/EUR/g,'').replace(/\\s+/g,' ').trim();};return cleanDescription(item.description);}}],{onAdd:()=>handleAddEntity('invoices'),onEdit:item=>handleEditEntity(item,'invoices'),onDelete:id=>handleDeleteEntity(id,'invoices'),onBulkEdit:()=>handleBulkEdit('invoices'),onBulkDelete:()=>handleBulkDelete('invoices'),onExport:()=>handleExport('invoices'),onImport:()=>handleImport('invoices')});case'onjn':// Combină ONJN Reports și Comision Dates într-un singur tabel\nconsole.log('🔄 Creating combinedOnjnData:',{onjnReports:onjnReports.length,comisionDates:comisionDates.length});const combinedOnjnData=[...onjnReports.map(item=>_objectSpread(_objectSpread({},item),{},{type:'onjn_report'})),...comisionDates.map(item=>_objectSpread(_objectSpread({},item),{},{type:'comision_date',report_number:\"COM-\".concat(item.id.slice(0,8)),report_type:'Commission Date',report_date:item.commission_date,submission_date:null,created_by:item.created_by,// Păstrează câmpul created_by original\nentityType:'comision_dates'// Entity type pentru atașamente\n}))];console.log('📋 Combined data length:',combinedOnjnData.length);return renderTable('ONJN Reports',combinedOnjnData,[{key:'report_number',label:'Event Name',render:item=>{if(item.type==='comision_date'){return/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:'bold',color:'var(--text-primary)',cursor:'pointer',textDecoration:'underline',padding:'2px 4px',borderRadius:'4px',transition:'background-color 0.2s'},onMouseEnter:e=>e.target.style.backgroundColor='var(--background-secondary)',onMouseLeave:e=>e.target.style.backgroundColor='transparent',onClick:()=>handleOpenCommissionDateDetails(item),title:\"Click to edit Event Name\",children:item.event_name||\"COM-\".concat(item.id.slice(0,8))});}else{return item.report_number||'N/A';}}},{key:'type',label:'Type',render:item=>{if(item.type==='comision_date'){return/*#__PURE__*/_jsx(\"span\",{style:{backgroundColor:'#3182ce',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.8em',fontWeight:'bold',boxShadow:'0 2px 4px rgba(0, 0, 0, 0.1)'},children:\"\\uD83D\\uDCC5 Commission Date\"});}else{return/*#__PURE__*/_jsx(\"span\",{style:{backgroundColor:'#3182ce',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.8em',fontWeight:'bold',boxShadow:'0 2px 4px rgba(0, 0, 0, 0.1)'},children:\"\\uD83D\\uDCCB ONJN Report\"});}}},{key:'report_date',label:'Report Date',render:item=>formatDateDDMMYYYY(item.report_date)},{key:'slot_count',label:'Number of Slots',render:item=>{if(item.type==='comision_date'&&item.serial_numbers){const serials=item.serial_numbers.split(/\\s+/).filter(s=>s.trim());return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#3182ce',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold',display:'inline-block',minWidth:'60px',textAlign:'center',boxShadow:'0 2px 4px rgba(0, 0, 0, 0.1)'},children:[serials.length,\" slots\"]});}else if(item.type==='onjn_report'){// Pentru ONJN Reports, să calculăm numărul de sloturi din serial_numbers dacă există\nif(item.serial_numbers){const serials=item.serial_numbers.split(/\\s+/).filter(s=>s.trim());return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#3182ce',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold',display:'inline-block',minWidth:'60px',textAlign:'center',boxShadow:'0 2px 4px rgba(0, 0, 0, 0.1)'},children:[serials.length,\" slots\"]});}else{return/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#e5e7eb',color:'#6b7280',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold',display:'inline-block',minWidth:'60px',textAlign:'center'},children:\"0 slots\"});}}return/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#e5e7eb',color:'#6b7280',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold',display:'inline-block',minWidth:'60px',textAlign:'center'},children:\"0 slots\"});}},{key:'gaming_places_count',label:'Number of Gaming Places',render:item=>{if(item.type==='comision_date'&&item.serial_numbers){const serials=item.serial_numbers.split(/\\s+/).filter(s=>s.trim());// Calculate total gaming places from associated slots\nconst associatedSlots=slotMachines.filter(slot=>serials.includes(slot.serial_number));const totalGamingPlaces=associatedSlots.reduce((total,slot)=>total+(parseInt(slot.gaming_places)||0),0);return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#28a745',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold',display:'inline-block',minWidth:'60px',textAlign:'center',boxShadow:'0 2px 4px rgba(0, 0, 0, 0.1)'},children:[totalGamingPlaces,\" places\"]});}else if(item.type==='onjn_report'){// Pentru ONJN Reports, să calculăm numărul de gaming places din serial_numbers dacă există\nif(item.serial_numbers){const serials=item.serial_numbers.split(/\\s+/).filter(s=>s.trim());const associatedSlots=slotMachines.filter(slot=>serials.includes(slot.serial_number));const totalGamingPlaces=associatedSlots.reduce((total,slot)=>total+(parseInt(slot.gaming_places)||0),0);return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#28a745',color:'white',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold',display:'inline-block',minWidth:'60px',textAlign:'center',boxShadow:'0 2px 4px rgba(0, 0, 0, 0.1)'},children:[totalGamingPlaces,\" places\"]});}else{return/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#e5e7eb',color:'#6b7280',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold',display:'inline-block',minWidth:'60px',textAlign:'center'},children:\"0 places\"});}}return/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#e5e7eb',color:'#6b7280',padding:'4px 8px',borderRadius:'12px',fontSize:'0.9em',fontWeight:'bold',display:'inline-block',minWidth:'60px',textAlign:'center'},children:\"0 places\"});}}],{onAdd:()=>handleAddEntity('onjn'),onEdit:item=>{if(item.type==='comision_date'){handleEditEntity(item,'comision_date');}else{handleEditEntity(item,'onjn');}},onDelete:id=>{const item=combinedOnjnData.find(item=>item.id===id);if(item&&item.type==='comision_date'){handleDeleteEntity(id,'comision_date');}else{handleDeleteEntity(id,'onjn');}},onBulkEdit:()=>handleBulkEdit('onjn'),onBulkDelete:()=>handleBulkDelete('onjn'),onExport:()=>handleExport('onjn'),onImport:()=>handleImport('onjn'),additionalButtons:[{label:'Add Comision Date',onClick:()=>handleAddEntity('comision_date'),icon:'📅',style:{backgroundColor:'var(--gradient-primary)',color:'white'}}],entityType:'onjn'},'onjn');case'legal':return renderTable('Legal Documents',legalDocuments,[{key:'title',label:'Document Title'},{key:'document_type',label:'Type'},{key:'issuing_authority',label:'Issuing Authority'},{key:'issue_date',label:'Issue Date',render:item=>new Date(item.issue_date).toLocaleDateString()},{key:'expiry_date',label:'Expiry Date',render:item=>item.expiry_date?new Date(item.expiry_date).toLocaleDateString():'No expiry'}],{onAdd:()=>handleAddEntity('legal'),onEdit:item=>handleEditEntity(item,'legal'),onDelete:id=>handleDeleteEntity(id,'legal'),onBulkEdit:()=>handleBulkEdit('legal'),onBulkDelete:()=>handleBulkDelete('legal'),onExport:()=>handleExport('legal'),onImport:()=>handleImport('legal')});case'users':return renderTable('Users',users,[{key:'avatar',label:'Avatar',render:item=>/*#__PURE__*/_jsx(AvatarDisplay,{entityType:\"users\",entityId:item.id,size:50,entityName:\"\".concat(item.first_name,\" \").concat(item.last_name)})},{key:'username',label:'Name',render:item=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold'},children:item.first_name&&item.last_name?\"\".concat(item.first_name,\" \").concat(item.last_name):item.username||'N/A'}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.8em',color:'var(--text-secondary)'},children:item.username||'No username'})]})},{key:'email',label:'Email',render:item=>/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'16px'},children:\"\\uD83D\\uDCE7\"}),/*#__PURE__*/_jsx(\"span\",{children:item.email||'N/A'})]})},{key:'phone',label:'Phone',render:item=>/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'16px'},children:\"\\uD83D\\uDCDE\"}),/*#__PURE__*/_jsx(\"span\",{children:item.phone||'N/A'})]})},{key:'role',label:'Role'},{key:'assigned_locations',label:'Assigned Locations',render:item=>{if(item.role==='admin')return'All Locations';if(!item.assigned_locations||item.assigned_locations.length===0)return'No Locations';return\"\".concat(item.assigned_locations.length,\" Location(s)\");}},{key:'created_at',label:'Created',render:item=>new Date(item.created_at).toLocaleDateString()},{key:'is_active',label:'Active',render:item=>item.is_active?'Yes':'No'}],{onAdd:()=>{setEditingUser(null);setShowUserForm(true);},onEdit:handleEditUser,onDelete:id=>handleDeleteEntity(id,'users'),onBulkEdit:()=>handleBulkEdit('users'),onBulkDelete:()=>handleBulkDelete('users'),onExport:()=>handleExport('users'),onImport:()=>handleImport('users')});case'comision_date':return renderTable('Comision Dates',comisionDates,[{key:'event_name',label:'Event Name',render:item=>/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold',color:'var(--text-primary)'},children:item.event_name||'Unnamed Event'})},{key:'commission_date',label:'Commission Date',render:item=>new Date(item.commission_date).toLocaleDateString()},{key:'serial_numbers',label:'Serial Numbers',render:item=>{const serials=item.serial_numbers.split(' ').filter(s=>s.trim());return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:'bold'},children:[serials.length,\" slot(s)\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'0.8em',color:'var(--text-secondary)'},children:[serials.slice(0,3).join(', '),serials.length>3&&\" +\".concat(serials.length-3,\" more\")]})]});}},{key:'created_at',label:'Created',render:item=>new Date(item.created_at).toLocaleDateString()}],{onAdd:()=>handleAddEntity('comision_date'),onEdit:item=>handleEditEntity(item,'comision_date'),onDelete:id=>handleDeleteEntity(id,'comision_date'),onBulkEdit:()=>handleBulkEdit('comision_date'),onBulkDelete:()=>handleBulkDelete('comision_date'),onExport:()=>handleExport('comision_date'),onImport:()=>handleImport('comision_date')});default:return renderDashboard();case'marketing':{const marketingColumns=[{key:'name',label:'Name',sortable:true},{key:'type',label:'Type',sortable:true},{key:'description',label:'Description',sortable:true},{key:'locations',label:'Locations',sortable:false,render:value=>{if(!value||value.length===0)return'None';const locationNames=value.map(locId=>{const location=locations.find(l=>l.id===locId);return location?location.name:locId;});return locationNames.join(', ');}},{key:'start_at',label:'Start Date',sortable:true,render:value=>formatDateDDMMYYYY(value)},{key:'end_at',label:'End Date',sortable:true,render:value=>formatDateDDMMYYYY(value)},{key:'status',label:'Status',sortable:true},{key:'payouts',label:'Payouts',sortable:false,render:value=>{if(!value||value.length===0)return'0';const totalAmount=value.reduce((sum,payout)=>sum+(payout.amount||0),0);return\"\".concat(value.length,\" (\").concat(totalAmount.toFixed(2),\" RON)\");}},{key:'created_at',label:'Created',sortable:true,render:value=>formatDateDDMMYYYY(value)},{key:'created_by',label:'Created By',sortable:true}];return renderTable('Marketing Campaigns',marketingCampaigns,marketingColumns,{onAdd:()=>{setMarketingForm(emptyMarketingForm);setShowMarketingForm(true);},onEdit:item=>{setMarketingForm(item);setShowMarketingForm(true);},onDelete:async id=>{if(confirm('Are you sure you want to delete this campaign?')){try{const headers={'Content-Type':'application/json',Authorization:\"Bearer \".concat(localStorage.getItem('token'))};const res=await fetch(\"\".concat(API,\"/marketing/campaigns/\").concat(id),{method:'DELETE',headers});if(res.ok){await fetchMarketingCampaigns();showCustomNotification('Campaign deleted','success');}else{showCustomNotification('Failed to delete campaign','error');}}catch(error){showCustomNotification('Error deleting campaign','error');}}},onBulkEdit:()=>handleBulkEdit('marketing'),onBulkDelete:()=>handleBulkDelete('marketing'),onExport:()=>handleExport('marketing'),onImport:()=>handleImport('marketing')},'marketing');}}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading dashboard...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"app-layout \".concat(theme),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"main-header\",style:{color:theme==='light'?'white':'inherit'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"header-left\",children:/*#__PURE__*/_jsx(\"div\",{className:\"header-logo\",children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px'},children:/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"CASHPOT Logo\",style:{height:'35px',width:'auto',maxWidth:'150px',objectFit:'contain'}})})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-right\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"theme-toggle\",onClick:()=>{const themes=['light','dark','dark-gambling'];const currentIndex=themes.indexOf(theme);const nextIndex=(currentIndex+1)%themes.length;setTheme(themes[nextIndex]);},title:\"Current: \".concat(theme,\". Click to cycle themes\"),children:theme==='light'?'☀️':theme==='dark'?'🌙':'🎰'}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-user-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header-user-avatar\",children:avatar?/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(avatar.mime_type,\";base64,\").concat(avatar.file_data),alt:\"User Avatar\",className:\"user-avatar-img\"}):/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar-placeholder\",children:user===null||user===void 0?void 0:(_user$username=user.username)===null||_user$username===void 0?void 0:_user$username.charAt(0).toUpperCase()})}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-user-details\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"header-user-name\",children:user!==null&&user!==void 0&&user.first_name&&user!==null&&user!==void 0&&user.last_name?\"\".concat(user.first_name,\" \").concat(user.last_name):user===null||user===void 0?void 0:user.username}),/*#__PURE__*/_jsx(\"span\",{className:\"header-user-role\",children:user===null||user===void 0?void 0:user.role})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:logout,className:\"header-logout-btn\",title:\"Logout\",children:\"\\u23FB\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"layout-container\",\"data-sidebar\":isSidebarCollapsed?'collapsed':'expanded',children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar\",\"aria-expanded\":!isSidebarCollapsed,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-header\",style:{display:'flex',alignItems:'center',justifyContent:'space-between',padding:'8px 12px'},children:[/*#__PURE__*/_jsx(\"span\",{className:\"sidebar-title\",style:{opacity:isSidebarCollapsed?0:1,transition:'opacity .15s'},children:\"Menu\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sidebar-toggle\",\"aria-label\":\"Toggle sidebar\",\"aria-pressed\":isSidebarCollapsed,onClick:toggleSidebar,title:isSidebarCollapsed?'Expand sidebar':'Collapse sidebar',children:isSidebarCollapsed?'»':'«'})]}),/*#__PURE__*/_jsx(\"nav\",{className:\"sidebar-nav\",children:navigationItems.map(item=>/*#__PURE__*/_jsxs(\"button\",{className:\"nav-item \".concat(activeView===item.id?'active':''),title:item.label,onClick:()=>{// Close Commission Date Details page when navigating to other modules\nif(showCommissionDateDetailsPage){setShowCommissionDateDetailsPage(false);setSelectedCommissionDate(null);}if(showJackpotDetailsPage){setShowJackpotDetailsPage(false);setSelectedJackpot(null);}if(showMetrologyDetailsPage){setShowMetrologyDetailsPage(false);setSelectedMetrology(null);}if(showLocationDetailsPage){setShowLocationDetailsPage(false);setSelectedLocation(null);}if(showInvoiceDetailsPage){setShowInvoiceDetailsPage(false);setSelectedInvoice(null);}if(showHistoryChangesPage){setShowHistoryChangesPage(false);}if(showGameDetailsPage){setShowGameDetailsPage(false);setSelectedGameForDetails(null);}if(showGameMixDetailsPage){setShowGameMixDetailsPage(false);setSelectedGameMixForDetails(null);}if(showGameMixGamesPage){setShowGameMixGamesPage(false);setSelectedGameMix(null);}// Update breadcrumb when navigating to main sections\nclearBreadcrumb();if(item.id!=='dashboard'){addBreadcrumb(item.label,item.icon,()=>setActiveView(item.id));}else{// Add Home breadcrumb for dashboard\naddBreadcrumb('Home','🏠',()=>{// Close all detail pages when navigating to Home\nsetShowGameMixDetailsPage(false);setShowGameDetailsPage(false);setShowGameMixGamesPage(false);setShowLocationDetailsPage(false);setShowProviderDetailsPage(false);setShowCabinetDetailsPage(false);setShowInvoiceDetailsPage(false);setShowJackpotDetailsPage(false);setShowMetrologyDetailsPage(false);setShowCommissionDateDetailsPage(false);setActiveView('dashboard');});}setActiveView(item.id);},children:[/*#__PURE__*/_jsx(\"span\",{className:\"nav-icon\",children:item.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"nav-label\",children:item.label}),item.count!==undefined&&/*#__PURE__*/_jsx(\"span\",{className:\"nav-count\",children:item.count})]},item.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-footer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar\",children:user===null||user===void 0?void 0:(_user$username2=user.username)===null||_user$username2===void 0?void 0:_user$username2.charAt(0).toUpperCase()}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-details\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"user-name\",children:user!==null&&user!==void 0&&user.first_name&&user!==null&&user!==void 0&&user.last_name?\"\".concat(user.first_name,\" \").concat(user.last_name):user===null||user===void 0?void 0:user.username}),/*#__PURE__*/_jsx(\"span\",{className:\"user-role\",children:user===null||user===void 0?void 0:user.role})]})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"content-body\",children:[/*#__PURE__*/_jsx(Breadcrumb,{breadcrumbPath:breadcrumbPath,onNavigate:navigateToBreadcrumb,theme:theme}),renderContent()]})})]}),\" \",showEntityForm&&/*#__PURE__*/_jsx(EntityForm,{entityType:entityType,entity:editingEntity,onSave:handleSaveEntity,onClose:handleCloseEntityForm,companies:companies,locations:locations,providers:providers,cabinets:cabinets,gameMixes:gameMixes,invoices:invoices,users:users,slotMachines:slotMachines,metrology:metrology,jackpots:jackpots,showCustomNotification:showCustomNotification}),showMarketingForm&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop\",onClick:()=>setShowMarketingForm(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:marketingForm.id?'Edit Campaign':'Create Campaign'}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>setShowMarketingForm(false),children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>e.preventDefault(),className:\"user-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Name *\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-input\",value:marketingForm.name||'',onChange:e=>setMarketingForm(_objectSpread(_objectSpread({},marketingForm),{},{name:e.target.value})),placeholder:\"Campaign name\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Type *\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-input\",value:marketingForm.type||'promotion',onChange:e=>setMarketingForm(_objectSpread(_objectSpread({},marketingForm),{},{type:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"promotion\",children:\"Promotion\"}),/*#__PURE__*/_jsx(\"option\",{value:\"tombola\",children:\"Tombola\"}),/*#__PURE__*/_jsx(\"option\",{value:\"tournament\",children:\"Tournament\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Start Date *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"datetime-local\",className:\"form-input\",value:marketingForm.start_at||'',onChange:e=>setMarketingForm(_objectSpread(_objectSpread({},marketingForm),{},{start_at:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"End Date *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"datetime-local\",className:\"form-input\",value:marketingForm.end_at||'',onChange:e=>setMarketingForm(_objectSpread(_objectSpread({},marketingForm),{},{end_at:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid-span\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Locations *\"}),/*#__PURE__*/_jsx(\"div\",{className:\"checkbox-chips\",children:locations.map(l=>{var _marketingForm$locati;return/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-chip\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:((_marketingForm$locati=marketingForm.locations)===null||_marketingForm$locati===void 0?void 0:_marketingForm$locati.includes(l.id))||false,onChange:e=>{setMarketingForm(prev=>{const set=new Set(prev.locations||[]);if(e.target.checked)set.add(l.id);else set.delete(l.id);return _objectSpread(_objectSpread({},prev),{},{locations:Array.from(set)});});}}),/*#__PURE__*/_jsx(\"span\",{children:l.name})]},l.id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid-span\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-textarea\",rows:3,value:marketingForm.description||'',onChange:e=>setMarketingForm(_objectSpread(_objectSpread({},marketingForm),{},{description:e.target.value})),placeholder:\"Campaign description\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Payouts (explicit dates)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"payouts-add-row\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",id:\"mp_date\",className:\"form-input\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"mp_loc\",className:\"form-input\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Location\"}),locations.map(l=>/*#__PURE__*/_jsx(\"option\",{value:l.id,children:l.name},l.id))]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",step:\"0.01\",id:\"mp_amt\",placeholder:\"Amount (RON)\",className:\"form-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>{const d=document.getElementById('mp_date').value;const loc=document.getElementById('mp_loc').value;const amt=parseFloat(document.getElementById('mp_amt').value||'0');if(!d||!loc||!amt){showCustomNotification('Please fill all payout fields','error');return;}setMarketingForm(prev=>_objectSpread(_objectSpread({},prev),{},{payouts:[...(prev.payouts||[]),{date:new Date(d).toISOString(),location_id:loc,amount:amt}]}));// Clear inputs\ndocument.getElementById('mp_date').value='';document.getElementById('mp_loc').value='';document.getElementById('mp_amt').value='';},children:\"Add Payout\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Amount (RON)\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[(marketingForm.payouts||[]).map((p,idx)=>{const loc=locations.find(l=>l.id===p.location_id);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:formatDateDDMMYYYY(p.date)}),/*#__PURE__*/_jsx(\"td\",{children:loc?loc.name:p.location_id}),/*#__PURE__*/_jsx(\"td\",{children:p.amount.toFixed(2)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-danger\",onClick:()=>{setMarketingForm(prev=>_objectSpread(_objectSpread({},prev),{},{payouts:prev.payouts.filter((_,i)=>i!==idx)}));},style:{padding:'2px 6px',fontSize:'12px'},children:\"\\uD83D\\uDDD1\\uFE0F\"})})]},idx);}),(!marketingForm.payouts||marketingForm.payouts.length===0)&&/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:4,style:{textAlign:'center',padding:'10px',color:'var(--text-secondary)'},children:\"No payouts yet.\"})})]})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowMarketingForm(false),className:\"btn-cancel\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-save\",disabled:savingMarketing,onClick:async()=>{var _marketingForm$locati2;if(!marketingForm.name||!marketingForm.type||!marketingForm.start_at||!marketingForm.end_at||!((_marketingForm$locati2=marketingForm.locations)!==null&&_marketingForm$locati2!==void 0&&_marketingForm$locati2.length)){showCustomNotification('Please fill all required fields','error');return;}setSavingMarketing(true);try{const headers={'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))};const method=marketingForm.id?'PUT':'POST';const url=marketingForm.id?\"\".concat(API,\"/marketing/campaigns/\").concat(marketingForm.id):\"\".concat(API,\"/marketing/campaigns\");const res=await fetch(url,{method,headers,body:JSON.stringify(_objectSpread({},marketingForm))});if(res.ok){setShowMarketingForm(false);setMarketingForm(emptyMarketingForm);await fetchMarketingCampaigns();showCustomNotification(marketingForm.id?'Campaign updated':'Campaign created','success');}else{showCustomNotification('Failed to save campaign','error');}}catch(error){showCustomNotification('Error saving campaign','error');}finally{setSavingMarketing(false);}},children:savingMarketing?'Saving...':marketingForm.id?'Update Campaign':'Create Campaign'})]})]})]})}),showBulkEditForm&&/*#__PURE__*/_jsx(BulkEditForm,{entityType:bulkEditType,selectedItems:selectedItems,onSave:handleBulkEditSave,onClose:()=>setShowBulkEditForm(false),companies:companies,locations:locations,providers:providers,cabinets:cabinets,gameMixes:gameMixes,slotMachines:slotMachines}),showUserForm&&/*#__PURE__*/_jsx(UserEditForm,{user:editingUser,onSave:handleSaveUser,onClose:handleCloseUserForm,companies:companies,locations:locations,showCustomNotification:showCustomNotification}),showInvoicePopup&&!showInvoiceDetailsPage&&/*#__PURE__*/_jsx(InvoicePopup,{invoice:selectedInvoice,onClose:handleCloseInvoicePopup}),showAddCvtDatePopup&&/*#__PURE__*/_jsx(AddCvtDatePopup,{onClose:handleCloseAddCvtDatePopup}),selectedJackpots&&/*#__PURE__*/_jsx(JackpotPopup,{jackpots:selectedJackpots,onClose:handleCloseJackpotPopup}),selectedInvoiceSlots&&/*#__PURE__*/_jsx(InvoiceSlotsPopup,{slots:selectedInvoiceSlots,onClose:handleCloseInvoiceSlotsPopup}),showSlotAttachmentsModal&&selectedSlotId&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:handleCloseSlotAttachments,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Slot Attachments\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:handleCloseSlotAttachments,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsx(FileDisplay,{entityType:\"slots\",entityId:selectedSlotId,showCustomNotification:showCustomNotification,onFileDelete:()=>{// Refresh attachment count after delete\nconsole.log('Slot file deleted, attachment count should refresh');}})})]})}),showEntityAttachmentsModal&&selectedEntityType&&selectedEntityId&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:handleCloseEntityAttachments,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[getEntityDisplayName(selectedEntityType),\" Attachments\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:handleCloseEntityAttachments,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsx(FileDisplay,{entityType:selectedEntityType,entityId:selectedEntityId,showCustomNotification:showCustomNotification,onFileDelete:()=>{// Refresh attachment count after delete\nif(selectedEntityType==='slots'){// For slots, the AttachmentIndicator will refresh automatically\n}else{// For other entities, we might need to trigger a refresh\nconsole.log('File deleted, attachment count should refresh');}}})})]})}),selectedMetrology&&!showMetrologyDetailsPage&&/*#__PURE__*/_jsx(MetrologyPopup,{metrology:selectedMetrology,onClose:handleCloseMetrologyPopup}),showCvtAttachments&&selectedCvtForAttachments&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:handleCloseCvtAttachments,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"CVT Attachments\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:handleCloseCvtAttachments,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsx(FileDisplay,{entityType:\"metrology\",entityId:selectedCvtForAttachments,showCustomNotification:showCustomNotification,onFileDelete:()=>{// Refresh attachment count after delete\nconsole.log('CVT file deleted, attachment count should refresh');}})})]})}),showChangeHistoryModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:handleCloseChangeHistory,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),style:{maxWidth:'900px',width:'90%'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'18px'},children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"Change History for \",selectedHistoryEntityId==='all'?'All Slot Machines':getEntityDisplayName(selectedHistoryEntityType)]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:handleCloseChangeHistory,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:changeHistoryData.length===0?/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'40px 20px',color:'var(--text-secondary)',fontSize:'14px'},children:[\"No changes in history for \",selectedHistoryEntityId==='all'?'any slot machines':\"this \".concat(getEntityDisplayName(selectedHistoryEntityType).toLowerCase())]}):/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'500px',overflowY:'auto',padding:'0 8px'},children:changeHistoryData.map((change,index)=>/*#__PURE__*/_jsx(\"div\",{style:{border:'1px solid var(--border-color)',borderRadius:'8px',padding:'16px',marginBottom:'12px',backgroundColor:index%2===0?'var(--background-primary)':'var(--background-secondary)',fontFamily:'var(--font-family)'},children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'8px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px',marginBottom:'4px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:[change.entity_id,\" - \",change.field_name]}),change.applied_successfully===true?/*#__PURE__*/_jsx(\"span\",{style:{color:'#4caf50',fontWeight:'500',fontSize:'12px'},children:\"\\u2705 Applied\"}):change.applied_successfully===false?/*#__PURE__*/_jsx(\"span\",{style:{color:'#f44336',fontWeight:'500',fontSize:'12px'},children:\"\\u274C Failed\"}):/*#__PURE__*/_jsx(\"span\",{style:{color:'#ff9800',fontWeight:'500',fontSize:'12px'},children:\"\\u23F3 Pending\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'16px',fontSize:'13px',color:'var(--text-secondary)',marginBottom:'8px'},children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Old:\"}),\" \",change.old_value||'-']}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"New:\"}),\" \",change.new_value||'-']})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'16px',fontSize:'12px',color:'var(--text-secondary)'},children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Scheduled:\"}),\" \",new Date(change.scheduled_datetime).toLocaleString()]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"By:\"}),\" \",change.user_name]})]})]})})},change.id))})})]})}),showAllModificationsModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:handleCloseAllModificationsHistory,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),style:{maxWidth:'900px',width:'90%'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'18px'},children:\"\\uD83D\\uDCCA\"}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"All Modifications History for \",selectedAllModificationsEntityId==='all'?'All Slot Machines':getEntityDisplayName(selectedAllModificationsEntityType)]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:handleCloseAllModificationsHistory,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:allModificationsData.length===0?/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'40px 20px',color:'var(--text-secondary)',fontSize:'14px'},children:[\"No modifications in history for \",selectedAllModificationsEntityId==='all'?'any slot machines':\"this \".concat(getEntityDisplayName(selectedAllModificationsEntityType).toLowerCase())]}):/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'500px',overflowY:'auto',padding:'0 8px'},children:allModificationsData.map((modification,index)=>/*#__PURE__*/_jsx(\"div\",{style:{border:'1px solid var(--border-color)',borderRadius:'8px',padding:'16px',marginBottom:'12px',backgroundColor:index%2===0?'var(--background-primary)':'var(--background-secondary)',fontFamily:'var(--font-family)'},children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'8px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px',marginBottom:'4px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:'600',color:'var(--text-primary)',fontSize:'14px'},children:[modification.entity_id,\" - \",modification.field_name]}),/*#__PURE__*/_jsx(\"span\",{style:{color:modification.change_type==='Scheduled'?'#3182ce':'#059669',fontWeight:'500',fontSize:'12px',backgroundColor:modification.change_type==='Scheduled'?'#dbeafe':'#d1fae5',padding:'2px 6px',borderRadius:'4px'},children:modification.change_type}),modification.applied_successfully===true?/*#__PURE__*/_jsx(\"span\",{style:{color:'#4caf50',fontWeight:'500',fontSize:'12px'},children:\"\\u2705 Applied\"}):modification.applied_successfully===false?/*#__PURE__*/_jsx(\"span\",{style:{color:'#f44336',fontWeight:'500',fontSize:'12px'},children:\"\\u274C Failed\"}):/*#__PURE__*/_jsx(\"span\",{style:{color:'#ff9800',fontWeight:'500',fontSize:'12px'},children:\"\\u23F3 Pending\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'16px',fontSize:'13px',color:'var(--text-secondary)',marginBottom:'8px'},children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Old:\"}),\" \",modification.old_value||'-']}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"New:\"}),\" \",modification.new_value||'-']})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'16px',fontSize:'12px',color:'var(--text-secondary)'},children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),\" \",new Date(modification.scheduled_datetime).toLocaleString()]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"By:\"}),\" \",modification.user_name]})]})]})})},modification.id))})})]})}),showNotification&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:'20px',right:'20px',zIndex:10000,fontFamily:'var(--font-family)'},children:/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:notificationType==='success'?'#4caf50':notificationType==='error'?'#f44336':notificationType==='warning'?'#ff9800':'#2196f3',color:'white',padding:'16px 20px',borderRadius:'8px',boxShadow:'0 4px 12px rgba(0, 0, 0, 0.15)',border:'1px solid rgba(255, 255, 255, 0.2)',maxWidth:'400px',wordWrap:'break-word',animation:'slideInRight 0.3s ease-out'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'18px'},children:notificationType==='success'?'✅':notificationType==='error'?'❌':notificationType==='warning'?'⚠️':'ℹ️'}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'14px',fontWeight:'500'},children:notificationMessage})]})})}),showDeleteConfirm&&fileToDelete&&/*#__PURE__*/_jsx(\"div\",{onClick:()=>{console.log('🔥 Individual delete overlay clicked, closing modal');cancelDeleteEntity();},style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.6)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:99999},children:/*#__PURE__*/_jsxs(\"div\",{onClick:e=>{console.log('🔥 Individual delete modal content clicked, preventing close');e.stopPropagation();},style:{backgroundColor:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',maxWidth:'450px',width:'90%',boxShadow:'var(--glass-shadow)',border:'1px solid var(--border-color)',position:'relative',backdropFilter:'var(--glass-blur)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'24px'},children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',fontFamily:'var(--font-family)'},children:\"Delete Confirmation\"})]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0 0 24px 0',color:'var(--text-secondary)',fontSize:'15px',lineHeight:'1.6',fontFamily:'var(--font-family)'},children:[\"Are you sure you want to delete this \",/*#__PURE__*/_jsx(\"strong\",{style:{color:'var(--text-primary)'},children:getEntityDisplayName(fileToDelete.type)}),\"?\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{style:{color:'#ff4757',fontSize:'13px'},children:\"This action cannot be undone.\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',justifyContent:'flex-end'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('🔥 Individual delete cancel button clicked');cancelDeleteEntity();},style:{padding:'10px 20px',border:'1px solid var(--border-color)',borderRadius:'8px',backgroundColor:'transparent',color:'var(--text-primary)',cursor:'pointer',fontSize:'14px',fontWeight:'500',fontFamily:'var(--font-family)',transition:'all 0.2s ease'},onMouseOver:e=>{e.target.style.backgroundColor='var(--bg-tertiary)';},onMouseOut:e=>{e.target.style.backgroundColor='transparent';},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('🔥 Individual delete confirm button clicked');confirmDeleteEntity();},style:{padding:'10px 20px',border:'none',borderRadius:'8px',background:'var(--gradient-danger)',color:'white',cursor:'pointer',fontSize:'14px',fontWeight:'600',fontFamily:'var(--font-family)',transition:'all 0.2s ease'},onMouseOver:e=>{e.target.style.opacity='0.9';},onMouseOut:e=>{e.target.style.opacity='1';},children:\"Delete\"})]})]})}),showBulkDeleteConfirm&&(console.log('🔥 RENDERING BULK DELETE MODAL:',{showBulkDeleteConfirm,bulkDeleteType,selectedItems})||null)&&/*#__PURE__*/_jsx(\"div\",{onClick:()=>{console.log('🔥 Overlay clicked, closing modal');cancelBulkDelete();},style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.6)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:99999},children:/*#__PURE__*/_jsxs(\"div\",{onClick:e=>{console.log('🔥 Modal content clicked, preventing close');e.stopPropagation();},style:{backgroundColor:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',maxWidth:'450px',width:'90%',boxShadow:'var(--glass-shadow)',border:'1px solid var(--border-color)',position:'relative',backdropFilter:'var(--glass-blur)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'24px'},children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',fontFamily:'var(--font-family)'},children:\"Bulk Delete Confirmation\"})]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0 0 24px 0',color:'var(--text-secondary)',fontSize:'15px',lineHeight:'1.6',fontFamily:'var(--font-family)'},children:[\"Are you sure you want to delete \",/*#__PURE__*/_jsxs(\"strong\",{style:{color:'var(--text-primary)'},children:[selectedItems.length,\" \",getEntityDisplayName(bulkDeleteType)]}),\"?\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{style:{color:'#ff4757',fontSize:'13px'},children:\"This action cannot be undone.\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',justifyContent:'flex-end'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('🔥 Cancel button clicked');cancelBulkDelete();},style:{padding:'10px 20px',border:'1px solid var(--border-color)',borderRadius:'8px',backgroundColor:'transparent',color:'var(--text-primary)',cursor:'pointer',fontSize:'14px',fontWeight:'500',fontFamily:'var(--font-family)',transition:'all 0.2s ease'},onMouseOver:e=>{e.target.style.backgroundColor='var(--bg-tertiary)';},onMouseOut:e=>{e.target.style.backgroundColor='transparent';},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('🔥 Delete All button clicked');confirmBulkDelete();},style:{padding:'10px 20px',border:'none',borderRadius:'8px',background:'var(--gradient-danger)',color:'white',cursor:'pointer',fontSize:'14px',fontWeight:'600',fontFamily:'var(--font-family)',transition:'all 0.2s ease'},onMouseOver:e=>{e.target.style.opacity='0.9';},onMouseOut:e=>{e.target.style.opacity='1';},children:\"Delete All\"})]})]})}),showBulkStatusConfirm&&/*#__PURE__*/_jsx(\"div\",{onClick:()=>{console.log('🔥 Status modal overlay clicked, closing modal');cancelBulkStatus();},style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.6)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:99999},children:/*#__PURE__*/_jsxs(\"div\",{onClick:e=>{console.log('🔥 Status modal content clicked, preventing close');e.stopPropagation();},style:{backgroundColor:'var(--bg-secondary)',borderRadius:'12px',padding:'24px',maxWidth:'450px',width:'90%',boxShadow:'var(--glass-shadow)',border:'1px solid var(--border-color)',position:'relative',backdropFilter:'var(--glass-blur)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'24px'},children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,color:'var(--text-primary)',fontSize:'20px',fontWeight:'600',fontFamily:'var(--font-family)'},children:\"Status Change Confirmation\"})]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0 0 24px 0',color:'var(--text-secondary)',fontSize:'15px',lineHeight:'1.6',fontFamily:'var(--font-family)'},children:[\"Are you sure you want to set \",/*#__PURE__*/_jsxs(\"strong\",{style:{color:'var(--text-primary)'},children:[selectedItems.length,\" slots\"]}),\" to \",/*#__PURE__*/_jsx(\"strong\",{style:{color:'#ff4757'},children:\"INACTIVE\"}),\"?\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{style:{color:'#ff4757',fontSize:'13px'},children:\"These slots will disappear from the Slot Machines list and be moved to Warehouse.\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',justifyContent:'flex-end'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('🔥 Cancel status button clicked');cancelBulkStatus();},style:{padding:'10px 20px',border:'1px solid var(--border-color)',borderRadius:'8px',backgroundColor:'transparent',color:'var(--text-primary)',cursor:'pointer',fontSize:'14px',fontWeight:'500',fontFamily:'var(--font-family)',transition:'all 0.2s ease'},onMouseOver:e=>{e.target.style.backgroundColor='var(--bg-tertiary)';},onMouseOut:e=>{e.target.style.backgroundColor='transparent';},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('🔥 Confirm status button clicked');confirmBulkStatus();},style:{padding:'10px 20px',border:'none',borderRadius:'8px',background:'var(--gradient-warning)',color:'white',cursor:'pointer',fontSize:'14px',fontWeight:'600',fontFamily:'var(--font-family)',transition:'all 0.2s ease'},onMouseOver:e=>{e.target.style.opacity='0.9';},onMouseOut:e=>{e.target.style.opacity='1';},children:\"Set Inactive\"})]})]})}),showScheduledChangesModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowScheduledChangesModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),style:{width:'95vw',maxWidth:'1000px',height:'auto',maxHeight:'90vh',overflow:'auto'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u23F1\\uFE0F Scheduled Actions for Provider\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>setShowScheduledChangesModal(false),children:\"\\u2715\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px'},children:scheduledChanges.filter(change=>change.entityType==='providers').length===0?/*#__PURE__*/_jsx(\"p\",{style:{textAlign:'center',color:'var(--text-secondary)',fontSize:'16px'},children:\"No scheduled actions for this provider\"}):/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'16px'},children:scheduledChanges.filter(change=>change.entityType==='providers').map((change,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid var(--border-color)',borderRadius:'8px',padding:'16px',backgroundColor:'var(--bg-secondary)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'12px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h4\",{style:{margin:'0 0 8px 0',color:'var(--text-primary)',fontSize:'16px'},children:[\"Provider ID: \",change.itemId]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0',color:'var(--text-secondary)',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Scheduled for:\"}),\" \",change.scheduledDateTime]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'4px 0 0 0',color:'var(--text-secondary)',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Modified by:\"}),\" \",change.userName]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const historyEntry={id:Date.now(),originalChange:change,cancelledAt:new Date().toISOString(),status:'cancelled',entityType:change.entityType,itemId:change.itemId,userName:change.userName,scheduledDateTime:change.scheduledDateTime,changes:change.changes};setChangeHistory(prev=>[historyEntry,...prev]);setScheduledChanges(prev=>prev.filter(c=>c.id!==change.id));},style:{padding:'4px 8px',backgroundColor:'#dc3545',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'12px'},children:\"Delete\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'12px'},children:[/*#__PURE__*/_jsx(\"h5\",{style:{margin:'0 0 8px 0',color:'var(--text-primary)',fontSize:'14px'},children:\"Scheduled Changes:\"}),/*#__PURE__*/_jsx(\"pre\",{style:{background:'var(--bg-tertiary)',padding:'8px',borderRadius:'4px',fontSize:'13px',color:'var(--text-secondary)'},children:JSON.stringify(change.changes,null,2)})]})]},change.id))})})]})}),showHistoryModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowHistoryModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),style:{width:'95vw',maxWidth:'1000px',height:'auto',maxHeight:'90vh',overflow:'auto'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCCB Change History for Provider\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>setShowHistoryModal(false),children:\"\\u2715\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px'},children:changeHistory.filter(entry=>entry.entityType==='providers').length===0?/*#__PURE__*/_jsx(\"p\",{style:{textAlign:'center',color:'var(--text-secondary)',fontSize:'16px'},children:\"No changes in history for this provider\"}):/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'16px'},children:changeHistory.filter(entry=>entry.entityType==='providers').map((entry,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid var(--border-color)',borderRadius:'8px',padding:'16px',backgroundColor:'var(--bg-secondary)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'12px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h4\",{style:{margin:'0 0 8px 0',color:'var(--text-primary)',fontSize:'16px'},children:[\"Provider ID: \",entry.itemId]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0',color:'var(--text-secondary)',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",entry.status]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'4px 0 0 0',color:'var(--text-secondary)',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Modified by:\"}),\" \",entry.userName]})]}),/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--text-secondary)',fontSize:'12px'},children:entry.appliedAt||entry.cancelledAt})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'12px'},children:[/*#__PURE__*/_jsx(\"h5\",{style:{margin:'0 0 8px 0',color:'var(--text-primary)',fontSize:'14px'},children:\"Applied Changes:\"}),/*#__PURE__*/_jsx(\"pre\",{style:{background:'var(--bg-tertiary)',padding:'8px',borderRadius:'4px',fontSize:'13px',color:'var(--text-secondary)'},children:JSON.stringify(entry.changes,null,2)})]})]},entry.id))})})]})}),showScheduledChangeForSlot!==null&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowScheduledChangeForSlot(null),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),style:{width:'95vw',maxWidth:'600px',height:'auto',maxHeight:'90vh',overflow:'auto'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u23F1\\uFE0F Scheduled Action for Slot\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>setShowScheduledChangeForSlot(null),children:\"\\u2715\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px'},children:scheduledChanges.filter(change=>change.entityType==='slots'&&change.itemId===showScheduledChangeForSlot).length===0?/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-secondary)',fontSize:'16px',marginBottom:'20px'},children:\"No scheduled actions for this slot\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const currentChanges=scheduledChanges.filter(change=>change.entityType==='slots'&&change.itemId===showScheduledChangeForSlot);if(currentChanges.length>0){// Afișează modal cu modificările existente pentru editare\nsetShowScheduledChangeForSlot(null);setScheduleChangeData(_objectSpread(_objectSpread({},slotMachines.find(slot=>slot.id===showScheduledChangeForSlot)),{},{existingChanges:currentChanges}));setShowScheduleChangeModal(true);}else{// Nu există modificări, deschide modal normal\nsetShowScheduledChangeForSlot(null);setScheduleChangeData(slotMachines.find(slot=>slot.id===showScheduledChangeForSlot));setShowScheduleChangeModal(true);}},style:{padding:'10px 20px',backgroundColor:'var(--accent-color)',color:'white',border:'none',borderRadius:'8px',cursor:'pointer',fontSize:'14px',fontWeight:'600'},children:\"Schedule New Change\"})]}):/*#__PURE__*/_jsxs(\"div\",{children:[scheduledChanges.filter(change=>change.entityType==='slots'&&change.itemId===showScheduledChangeForSlot).map(change=>{var _change$changes11,_change$changes11$sta,_change$changes12,_change$changes12$sta,_change$changes19,_change$changes19$mod,_change$model3,_change$changes20,_change$changes20$mod,_change$model4;return/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid var(--border-color)',borderRadius:'8px',padding:'16px',backgroundColor:'var(--bg-secondary)',marginBottom:12},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:8},children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'#2c3e50'},children:\"Scheduled for:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#2c3e50'},children:change.scheduledDateTime}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{style:{color:'#2c3e50'},children:\"Modified by:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#2c3e50'},children:(()=>{// Caută utilizatorul complet în lista de utilizatori\nconst user=Array.isArray(users)?users.find(u=>u.username===change.userName):null;if(user&&user.first_name&&user.last_name){return\"\".concat(user.first_name,\" \").concat(user.last_name);}else if(user&&user.username){return user.username;}else{return change.userName||'Unknown User';}})()})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'var(--bg-tertiary)',padding:'12px',borderRadius:'4px',fontSize:'13px',color:'var(--text-secondary)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'8px',fontWeight:'bold',color:'var(--text-primary)'},children:\"Changes:\"}),/*#__PURE__*/_jsx(\"div\",{style:{border:'1px solid var(--border-color)',borderRadius:'4px',overflow:'hidden',marginTop:'8px'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',fontSize:'12px'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:'var(--bg-secondary)',borderBottom:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px',textAlign:'left',borderRight:'1px solid var(--border-color)',fontWeight:'bold',color:'var(--text-primary)'},children:\"Field\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px',textAlign:'left',borderRight:'1px solid var(--border-color)',fontWeight:'bold',color:'var(--text-primary)'},children:\"Old Value\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px',textAlign:'left',fontWeight:'bold',color:'var(--text-primary)'},children:\"New Value\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',fontWeight:'bold',color:'var(--text-primary)'},children:\"Status\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',color:'var(--text-secondary)'},children:((_change$changes11=change.changes)===null||_change$changes11===void 0?void 0:(_change$changes11$sta=_change$changes11.status)===null||_change$changes11$sta===void 0?void 0:_change$changes11$sta.old)||change.oldValue||'-'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',color:'var(--text-secondary)'},children:((_change$changes12=change.changes)===null||_change$changes12===void 0?void 0:(_change$changes12$sta=_change$changes12.status)===null||_change$changes12$sta===void 0?void 0:_change$changes12$sta.new)||change.newValue||'-'})]}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',fontWeight:'bold',color:'var(--text-primary)'},children:\"Provider\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',color:'var(--text-secondary)'},children:((_change$changes13,_change$changes13$pro,_change$provider_id3)=>{const providerId=((_change$changes13=change.changes)===null||_change$changes13===void 0?void 0:(_change$changes13$pro=_change$changes13.provider_id)===null||_change$changes13$pro===void 0?void 0:_change$changes13$pro.old)||((_change$provider_id3=change.provider_id)===null||_change$provider_id3===void 0?void 0:_change$provider_id3.old);const oldProvider=providers.find(p=>p.id===providerId);return oldProvider?oldProvider.name:providerId||'-';})()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',color:'var(--text-secondary)'},children:((_change$changes14,_change$changes14$pro,_change$provider_id4)=>{const providerId=((_change$changes14=change.changes)===null||_change$changes14===void 0?void 0:(_change$changes14$pro=_change$changes14.provider_id)===null||_change$changes14$pro===void 0?void 0:_change$changes14$pro.new)||((_change$provider_id4=change.provider_id)===null||_change$provider_id4===void 0?void 0:_change$provider_id4.new);const newProvider=providers.find(p=>p.id===providerId);return newProvider?newProvider.name:providerId||'-';})()})]}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',fontWeight:'bold',color:'var(--text-primary)'},children:\"Game Mix\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',color:'var(--text-secondary)'},children:((_change$changes15,_change$changes15$gam,_change$game_mix_id3)=>{const gameMixId=((_change$changes15=change.changes)===null||_change$changes15===void 0?void 0:(_change$changes15$gam=_change$changes15.game_mix_id)===null||_change$changes15$gam===void 0?void 0:_change$changes15$gam.old)||((_change$game_mix_id3=change.game_mix_id)===null||_change$game_mix_id3===void 0?void 0:_change$game_mix_id3.old);const oldGameMix=gameMixes.find(g=>g.id===gameMixId);return oldGameMix?oldGameMix.name:gameMixId||'-';})()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',color:'var(--text-secondary)'},children:((_change$changes16,_change$changes16$gam,_change$game_mix_id4)=>{const gameMixId=((_change$changes16=change.changes)===null||_change$changes16===void 0?void 0:(_change$changes16$gam=_change$changes16.game_mix_id)===null||_change$changes16$gam===void 0?void 0:_change$changes16$gam.new)||((_change$game_mix_id4=change.game_mix_id)===null||_change$game_mix_id4===void 0?void 0:_change$game_mix_id4.new);const newGameMix=gameMixes.find(g=>g.id===gameMixId);return newGameMix?newGameMix.name:gameMixId||'-';})()})]}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',fontWeight:'bold',color:'var(--text-primary)'},children:\"Cabinet\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',color:'var(--text-secondary)'},children:((_change$changes17,_change$changes17$cab,_change$cabinet_id3)=>{const cabinetId=((_change$changes17=change.changes)===null||_change$changes17===void 0?void 0:(_change$changes17$cab=_change$changes17.cabinet_id)===null||_change$changes17$cab===void 0?void 0:_change$changes17$cab.old)||((_change$cabinet_id3=change.cabinet_id)===null||_change$cabinet_id3===void 0?void 0:_change$cabinet_id3.old);const oldCabinet=cabinets.find(c=>c.id===cabinetId);return oldCabinet?oldCabinet.name:cabinetId||'-';})()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',color:'var(--text-secondary)'},children:((_change$changes18,_change$changes18$cab,_change$cabinet_id4)=>{const cabinetId=((_change$changes18=change.changes)===null||_change$changes18===void 0?void 0:(_change$changes18$cab=_change$changes18.cabinet_id)===null||_change$changes18$cab===void 0?void 0:_change$changes18$cab.new)||((_change$cabinet_id4=change.cabinet_id)===null||_change$cabinet_id4===void 0?void 0:_change$cabinet_id4.new);const newCabinet=cabinets.find(c=>c.id===cabinetId);return newCabinet?newCabinet.name:cabinetId||'-';})()})]}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',fontWeight:'bold',color:'var(--text-primary)'},children:\"Model\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',color:'var(--text-secondary)'},children:((_change$changes19=change.changes)===null||_change$changes19===void 0?void 0:(_change$changes19$mod=_change$changes19.model)===null||_change$changes19$mod===void 0?void 0:_change$changes19$mod.old)||((_change$model3=change.model)===null||_change$model3===void 0?void 0:_change$model3.old)||'-'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',color:'var(--text-secondary)'},children:((_change$changes20=change.changes)===null||_change$changes20===void 0?void 0:(_change$changes20$mod=_change$changes20.model)===null||_change$changes20$mod===void 0?void 0:_change$changes20$mod.new)||((_change$model4=change.model)===null||_change$model4===void 0?void 0:_change$model4.new)||'-'})]}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',fontWeight:'bold',color:'var(--text-primary)'},children:\"Location\"}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',borderRight:'1px solid var(--border-color)',color:'var(--text-secondary)'},children:((_change$changes21,_change$changes21$loc,_change$location_id3)=>{const locationId=((_change$changes21=change.changes)===null||_change$changes21===void 0?void 0:(_change$changes21$loc=_change$changes21.location_id)===null||_change$changes21$loc===void 0?void 0:_change$changes21$loc.old)||((_change$location_id3=change.location_id)===null||_change$location_id3===void 0?void 0:_change$location_id3.old);const oldLocation=locations.find(l=>l.id===locationId);return oldLocation?oldLocation.name:locationId||'-';})()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',color:'var(--text-secondary)'},children:((_change$changes22,_change$changes22$loc,_change$location_id4)=>{const locationId=((_change$changes22=change.changes)===null||_change$changes22===void 0?void 0:(_change$changes22$loc=_change$changes22.location_id)===null||_change$changes22$loc===void 0?void 0:_change$changes22$loc.new)||((_change$location_id4=change.location_id)===null||_change$location_id4===void 0?void 0:_change$location_id4.new);const newLocation=locations.find(l=>l.id===locationId);return newLocation?newLocation.name:locationId||'-';})()})]})]})]})})]})]},change.id);}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginTop:'20px',display:'flex',gap:'10px',justifyContent:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const currentChanges=scheduledChanges.filter(change=>change.entityType==='slots'&&change.itemId===showScheduledChangeForSlot);if(currentChanges.length>0){handleEditScheduledDateTime(currentChanges[0]);}},style:{padding:'10px 20px',backgroundColor:'#17a2b8',color:'white',border:'none',borderRadius:'8px',cursor:'pointer',fontSize:'14px',fontWeight:'600'},children:\"Edit Date/Time\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const currentChanges=scheduledChanges.filter(change=>change.entityType==='slots'&&change.itemId===showScheduledChangeForSlot);if(currentChanges.length>0){// Afișează modal cu modificările existente pentru editare\nsetShowScheduledChangeForSlot(null);setScheduleChangeData(_objectSpread(_objectSpread({},slotMachines.find(slot=>slot.id===showScheduledChangeForSlot)),{},{existingChanges:currentChanges}));setShowScheduleChangeModal(true);}else{// Nu există modificări, deschide modal normal\nsetShowScheduledChangeForSlot(null);setScheduleChangeData(slotMachines.find(slot=>slot.id===showScheduledChangeForSlot));setShowScheduleChangeModal(true);}},style:{padding:'10px 20px',backgroundColor:'var(--accent-color)',color:'white',border:'none',borderRadius:'8px',cursor:'pointer',fontSize:'14px',fontWeight:'600'},children:\"Schedule Additional Change\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// Anulare modificări programate\nconst changes=scheduledChanges.filter(change=>change.entityType==='slots'&&change.itemId===showScheduledChangeForSlot);if(changes.length>0){// Afișează modal custom pentru confirmare\nsetShowCancelConfirmation(true);setCancelConfirmationData({slotId:showScheduledChangeForSlot,changesCount:changes.length});}},style:{padding:'10px 20px',backgroundColor:'#e74c3c',color:'white',border:'none',borderRadius:'8px',cursor:'pointer',fontSize:'14px',fontWeight:'600'},children:\"Cancel Changes\"})]})]})})]})}),showScheduleChangeModal&&scheduleChangeData&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowScheduleChangeModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),style:{width:'95vw',maxWidth:'600px',height:'auto',maxHeight:'90vh',overflow:'auto'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u23F1\\uFE0F Schedule Changes for Slot Machine\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>setShowScheduleChangeModal(false),children:\"\\u2715\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px'},children:/*#__PURE__*/_jsx(ScheduleChangeForm,{slot:scheduleChangeData,providers:providers,cabinets:cabinets,gameMixes:gameMixes,locations:locations,users:users,onSave:scheduledData=>{console.log('Scheduling change:',scheduledData);// Create a comprehensive change object with ALL fields (current and new values)\nconst changes={status:{old:scheduleChangeData.status,new:scheduledData.newStatus},provider_id:{old:scheduleChangeData.provider_id,new:scheduledData.provider_id||scheduleChangeData.provider_id},game_mix_id:{old:scheduleChangeData.game_mix_id,new:scheduledData.game_mix_id||scheduleChangeData.game_mix_id},cabinet_id:{old:scheduleChangeData.cabinet_id,new:scheduledData.cabinet_id||scheduleChangeData.cabinet_id},model:{old:scheduleChangeData.model,new:scheduledData.model||scheduleChangeData.model},location_id:{old:scheduleChangeData.location_id,new:scheduledData.location_id||scheduleChangeData.location_id}};// Create the scheduled change with all modifications\nconst change={id:Date.now()+Math.random(),entityType:'slots',itemId:scheduleChangeData.id,action:'comprehensive_update',oldValue:scheduleChangeData.status,newValue:scheduledData.newStatus,changes:changes,scheduledDateTime:scheduledData.scheduledDateTime,timestamp:new Date().toISOString(),userName:(user===null||user===void 0?void 0:user.username)||'Unknown User'};setScheduledChanges(prev=>[...prev,change]);const timeUntilExecution=new Date(scheduledData.scheduledDateTime).getTime()-Date.now();const minutes=Math.floor(timeUntilExecution/(1000*60));const seconds=Math.floor(timeUntilExecution%(1000*60)/1000);showCustomNotification(\"Change scheduled successfully. Will execute in \".concat(minutes,\":\").concat(seconds.toString().padStart(2,'0')),'success');setShowScheduleChangeModal(false);setScheduleChangeData(null);},onCancel:()=>{setShowScheduleChangeModal(false);setScheduleChangeData(null);}})})]})}),showCancelConfirmation&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowCancelConfirmation(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),style:{width:'400px',maxWidth:'90vw'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u26A0\\uFE0F Cancel Scheduled Changes\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>setShowCancelConfirmation(false),children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--text-primary)',fontSize:'16px',marginBottom:'20px'},children:\"Do you want to cancel the scheduled changes?\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'10px',justifyContent:'flex-end'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCancelConfirmation(false),style:{padding:'10px 20px',backgroundColor:'#6c757d',color:'white',border:'none',borderRadius:'8px',cursor:'pointer',fontSize:'14px',fontWeight:'600'},children:\"No\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelScheduledChanges,style:{padding:'10px 20px',backgroundColor:'#e74c3c',color:'white',border:'none',borderRadius:'8px',cursor:'pointer',fontSize:'14px',fontWeight:'600'},children:\"Yes, Cancel\"})]})]})]})}),confirmModalData.isOpen&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.5)',display:'flex',justifyContent:'center',alignItems:'center',zIndex:1000},children:/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'var(--bg-primary)',borderRadius:'8px',padding:'24px',maxWidth:'500px',width:'90%',boxShadow:'0 4px 20px rgba(0, 0, 0, 0.3)',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'24px',marginRight:'12px'},children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,color:'var(--text-primary)',fontSize:'18px',fontWeight:'bold'},children:confirmModalData.title})]}),/*#__PURE__*/_jsx(\"div\",{style:{color:'var(--text-secondary)',marginBottom:'24px',lineHeight:'1.5',whiteSpace:'pre-line'},children:confirmModalData.message}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'flex-end',gap:'12px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:confirmModalData.onCancel,style:{padding:'8px 16px',border:'1px solid var(--border-color)',borderRadius:'4px',backgroundColor:'transparent',color:'var(--text-primary)',cursor:'pointer',fontSize:'14px'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:confirmModalData.onConfirm,style:{padding:'8px 16px',border:'none',borderRadius:'4px',backgroundColor:'#dc3545',color:'white',cursor:'pointer',fontSize:'14px',fontWeight:'bold'},children:\"Continue\"})]})]})}),editDateTimeModal.isOpen&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.5)',display:'flex',justifyContent:'center',alignItems:'center',zIndex:1000},children:/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'var(--bg-primary)',borderRadius:'8px',padding:'24px',maxWidth:'400px',width:'90%',boxShadow:'0 4px 20px rgba(0, 0, 0, 0.3)',border:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'24px',marginRight:'12px'},children:\"\\u23F0\"}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,color:'var(--text-primary)',fontSize:'18px',fontWeight:'bold'},children:\"Edit Scheduled Date/Time\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'var(--text-secondary)',marginBottom:'24px',lineHeight:'1.5'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Currently scheduled for: \",/*#__PURE__*/_jsx(\"strong\",{children:(_editDateTimeModal$sc=editDateTimeModal.scheduledChange)===null||_editDateTimeModal$sc===void 0?void 0:_editDateTimeModal$sc.scheduledDateTime})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Select new date and time:\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'24px'},children:/*#__PURE__*/_jsx(\"input\",{type:\"datetime-local\",value:editDateTimeModal.newDateTime,onChange:e=>setEditDateTimeModal(prev=>_objectSpread(_objectSpread({},prev),{},{newDateTime:e.target.value})),style:{width:'100%',padding:'12px',border:'1px solid var(--border-color)',borderRadius:'4px',fontSize:'14px',backgroundColor:'var(--bg-secondary)',color:'var(--text-primary)'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'flex-end',gap:'12px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:editDateTimeModal.onCancel,style:{padding:'8px 16px',border:'1px solid var(--border-color)',borderRadius:'4px',backgroundColor:'transparent',color:'var(--text-primary)',cursor:'pointer',fontSize:'14px'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>editDateTimeModal.onSave(editDateTimeModal.newDateTime),style:{padding:'8px 16px',border:'none',borderRadius:'4px',backgroundColor:'#17a2b8',color:'white',cursor:'pointer',fontSize:'14px',fontWeight:'bold'},children:\"Save Changes\"})]})]})}),showReportDetailsModal&&selectedReportDetails&&/*#__PURE__*/_jsx(ReportDetailsModal,{report:selectedReportDetails,onClose:()=>{setShowReportDetailsModal(false);setSelectedReportDetails(null);}})]});};// Main App Component\nconst App=()=>{return/*#__PURE__*/_jsx(AuthProvider,{children:/*#__PURE__*/_jsx(AppContent,{})});};const AppContent=()=>{const{user,loading}=useAuth();if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading application...\"})]});}return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:user?/*#__PURE__*/_jsx(Dashboard,{}):/*#__PURE__*/_jsx(Login,{})});};export default App;// Adaug componenta GameMixAvatar sub AvatarDisplay\nfunction GameMixAvatar(_ref35){let{entityId,name}=_ref35;const{avatar,loading}=useAvatar('game_mixes',entityId);if(loading)return/*#__PURE__*/_jsx(\"div\",{style:{width:20,height:95}});if(avatar){return/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(avatar.mime_type,\";base64,\").concat(avatar.file_data),alt:\"Avatar\",style:{width:20,height:95,objectFit:'cover',borderRadius:4}});}// Fallback: background albastru cu text alb, font fix\nreturn/*#__PURE__*/_jsx(\"div\",{style:{width:20,height:95,background:'#1976d2',color:'#ffffff',fontWeight:'bold',display:'flex',alignItems:'center',justifyContent:'center',borderRadius:4,lineHeight:'1.1'},children:name});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}